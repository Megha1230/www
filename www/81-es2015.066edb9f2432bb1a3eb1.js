(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{"2Ihw":function(e,t,o){"use strict";o.d(t,"a",function(){return p});var n=o("ZyuK"),s=o("iOQE"),i=o("DFXC"),c=o("Q0Ba"),a=o("fXoL");let p=(()=>{class e extends s.a{constructor(e,t,o){super(e,t),this.omniPull=o,this.defaultSelectOptions={labelKey:"account_type_key",placeHolder:"select_req_account_type_key"},this.accountType=[]}ngOnInit(){this.commonProv.copyObject(this.defaultSelectOptions,this.options),this.getAccountTypes()}getAccountTypes(){this.omniPull.returnAccountTypes({accountCategory:this.options.accountCategory}).then(e=>{if(this.defaultSelectOptions.listOfOptions=[],e&&null!=e.gridModel&&e.gridModel.length>0){for(let t=0;t<e.gridModel.length;t++)this.accountType.push({itemValue:e.gridModel[t].typeCode,description:e.gridModel[t].briefDesc,selectedObj:e.gridModel[t]});this.defaultSelectOptions.listOfOptions=this.accountType}else this.logger.warn(e,"empty response")}).catch(e=>{})}onAccountTypeChange(e){this.loggerP.log("onAccountTypeChange"+e),this.onPsChange.emit(e.selectedObj)}}return e.\u0275fac=function(t){return new(t||e)(a.Rb(c.a),a.Rb(i.a),a.Rb(n.a))},e.\u0275cmp=a.Lb({type:e,selectors:[["ps-dropdown-account-types"]],inputs:{options:"options"},features:[a.Cb],decls:1,vars:2,consts:[[3,"id","options","onPsChange"]],template:function(e,t){1&e&&(a.Xb(0,"ps-select-dropdown",0),a.fc("onPsChange",function(e){return t.onAccountTypeChange(e)}),a.Wb()),2&e&&a.pc("id",t.id)("options",t.defaultSelectOptions)},directives:[s.a],styles:[""]}),e})()},QmEf:function(e,t,o){"use strict";o.r(t),o.d(t,"AccountOpeningPage",function(){return q});var n=o("mrSG"),s=o("3Pt+"),i=o("I9E9"),c=o.n(i),a=o("OVQh"),p=o("fOh1"),r=o("0CJq"),l=o("ZyuK"),u=o("f42Q"),h=o("DFXC"),m=o("zngb"),f=o("qEF5"),d=o("QZhd"),O=o("woXy"),y=o("Q0Ba"),g=o("V0Fi"),b=o("gKqT"),C=o("fXoL"),_=o("kRg/"),A=o("uKCV"),N=o("sAFK"),T=o("+f2X"),P=o("ofXK"),I=o("2Ihw"),v=o("KuXP"),S=o("GmwD"),k=o("ULj9"),B=o("ggmK"),E=o("VEWP"),x=o("/M2N"),D=o("iTqn");const w=["fromAccountRef"],R=["exchangeRef"],L=["currenciesRef"];function V(e,t){if(1&e&&C.Sb(0,"ps-input-display-only",15),2&e){const e=C.ic(2);C.pc("options",e.branchLabelOptions)}}function F(e,t){if(1&e){const e=C.Yb();C.Vb(0),C.Sb(1,"ps-input-display-only",16),C.Xb(2,"ps-lookup-own-accounts",17,18),C.fc("onAccountChange",function(t){return C.Fc(e),C.ic(2).onFromAccountChange(t)}),C.Wb(),C.Sb(4,"ps-complex-exchange",19,20),C.Ub()}if(2&e){const e=C.ic(2);C.Fb(1),C.pc("options",e.minOpeningBalOptions),C.Fb(1),C.pc("options",e.fromAccOptions),C.Fb(2),C.pc("options",e.complexExchangeOptions)}}function j(e,t){if(1&e&&C.Sb(0,"ps-select-toggle",21),2&e){const e=C.ic(2);C.pc("id","accprofitFMid")("options",e.toggleProfitOptions)}}function M(e,t){if(1&e&&C.Sb(0,"ps-lookup-own-accounts",22),2&e){const e=C.ic(2);C.pc("options",e.profitAccOptions)}}function K(e,t){if(1&e){const e=C.Yb();C.Xb(0,"ps-form-step",3),C.Xb(1,"ps-container-panel",4),C.Pc(2,V,1,1,"ps-input-display-only",5),C.Xb(3,"ps-dropdown-account-types",6),C.fc("onPsChange",function(t){return C.Fc(e),C.ic().onAccountTypeChanged(t)}),C.Wb(),C.Xb(4,"ps-select-toggle",7),C.fc("onPsChange",function(t){return C.Fc(e),C.ic().onAddOpeningBalanceChange(t)}),C.Wb(),C.Xb(5,"ps-dropdown-currencies",8,9),C.fc("onPsChange",function(t){return C.Fc(e),C.ic().onCurrencyChanged(t)}),C.Wb(),C.Pc(7,F,6,3,"ng-container",10),C.Pc(8,j,1,2,"ps-select-toggle",11),C.Pc(9,M,1,1,"ps-lookup-own-accounts",12),C.Wb(),C.Xb(10,"ps-container-panel",13),C.Xb(11,"ps-complex-select-branch",14),C.fc("onPsChange",function(t){return C.Fc(e),C.ic().onSelectBranch(t)}),C.Wb(),C.Wb(),C.Wb()}if(2&e){const e=C.ic();C.pc("id",e.stepperOptions.namesofSteps[0]),C.Fb(1),C.pc("options",e.panelOptions1Step1),C.Fb(1),C.pc("ngIf",e.enableCifBranch),C.Fb(1),C.pc("options",e.accountTypeOptions),C.Fb(1),C.pc("id","addOpeningBalance")("options",e.openingBalanceToggleOptions),C.Fb(1),C.pc("options",e.currencyOptions),C.Fb(2),C.pc("ngIf",e.addOpeningBal),C.Fb(1),C.pc("ngIf",e.showProfitToggle),C.Fb(1),C.pc("ngIf",e.showProfitAccount),C.Fb(1),C.pc("options",e.panelOptions2Step1),C.Fb(1),C.pc("options",e.selectBranchOptions)}}function G(e,t){if(1&e&&(C.Xb(0,"ps-form-step",23),C.Sb(1,"ps-map-atm-branches",24),C.Wb()),2&e){const e=C.ic();C.pc("id",e.stepperOptions.namesofSteps[1]),C.Fb(1),C.pc("options",e.mapAtmBranchesOptions)}}let q=(()=>{class e extends b.OmniBasePage{constructor(e,t,o,n,i,c){super(),this.commonProv=e,this.loggerP=t,this.eventEmitterService=o,this.omniPull=n,this.commonService=i,this.navService=c,this.formGroup=new s.f({}),this.defaultVO={},this.mapAtmBranchesOptions={group:this.formGroup,fcName:"mapAtmBranches",labelKey:"map_atm_branch_key",mapOptions:{labelKey:"map"},showSegments:!1,mapTypesInclude:"'B'",branchIds:"1,3,5",parameterToCheck:g.a.RequestBranch,requestVO:this.defaultVO},this.mask={groupSeparator:d.a.THOUSANDS_SEPARATOR,alias:"currency",autoGroup:!0,placeholder:"0",greedy:!1,digits:2,radixPoint:d.a.DECIMAL_SEPARATOR},this.stepperOptions={stepperName:"acc_open_stepper",isHorizontalStepper:!0,numberOfSteps:2,namesofSteps:["acc_open_step1","acc_open_step2"],group:this.formGroup,submitOptions:{extraParams:{},submitServiceUrl:p.a.serviceUrl.accountOpeningEndPoint,group:this.formGroup},requestObject:this.defaultVO},this.accountTypeOptions={allowedAccountType:m.a.AllowedGeneralAccountTypes,accountCategory:m.a.ACC_TYPE_D,group:this.formGroup,fcName:"accountTypes"},this.openingBalanceToggleOptions={labelKey:"add_opening_balance_key",placeHolder:"add_opening_balance_key",group:this.formGroup,fcName:"addOpeningBalance",psClass:"toggleColor"},this.minOpeningBalOptions={placeHolder:"minimum_opening_balance_key",labelKey:"minimum_opening_balance_key",group:this.formGroup,fcName:"minOpenBalance"},this.fromAccOptions={labelKey:"from_account_key",placeHolder:"select_from_account_key",component:a.a,group:this.formGroup,accountAllowedCurrencies:[],accountAllowedTypes:[],glTypes:"G",fcName:"fromAccount",accountType:"G",fromTo:"from",requestObject:this.defaultVO},this.complexExchangeOptions={editableMode:!1,showToCurrencyOptions:!0,fromAmountOptions:{currency:"",currenciesOptions:{placeHolder:"currency_key",labelKey:"exchange_currency_key",fcName:"fromCurrency",group:this.formGroup,revertToOldValue:!1},amountOptions:{labelKey:"amount_key",placeHolder:"enter_amount_key",fcName:"transactionAmount",group:this.formGroup,decimalPoints:2}},toAmountOptions:{currency:"",currenciesOptions:{placeHolder:"currency_key",labelKey:"currency_key",fcName:"toCurrency",group:this.formGroup},amountOptions:{labelKey:"exchange_amount_key",placeHolder:"enter_amount_key",fcName:"toAmount",group:this.formGroup,decimalPoints:2}},requestObject:this.defaultVO,group:this.formGroup},this.accountNameOptions={labelKey:"name_key",placeHolder:"name_key",group:this.formGroup,fcName:"accountName"},this.currencyOptions={labelKey:"currency_key",placeHolder:"select_currency_key",group:this.formGroup,fcName:"currency",revertToOldValue:!1},this.panelOptions1Step1={isExpandable:!0,labelKey:"account_details_key",iconName:"document",expanded:!0},this.panelOptions2Step1={isExpandable:!0,labelKey:"select_branch_key",iconName:"document",expanded:!0},this.branchLabelOptions={placeHolder:"user_branch_key",labelKey:"branch_key",group:this.formGroup,fcName:"branch_type"},this.selectBranchOptions={fcName:"mapAtmBranchesDropdown",group:this.formGroup,branchesOptions:{placeHolder:"acc_opening_branch_key",labelKey:"label_acc_opening_branch_key",group:this.formGroup,fcName:"default_branch"}},this.toggleProfitOptions={labelKey:"post_profit_to_same_account_key",placeHolder:"post_profit_to_same_account_key",group:this.formGroup,fcName:"renewWithSame",psClass:"toggleColor"},this.profitAccOptions={labelKey:"post_profit_to_key",placeHolder:"select_post_profit_to_key",component:a.a,group:this.formGroup,accountAllowedCurrencies:[],accountAllowedTypes:[],glTypes:"G",fcName:"profitAccount",accountType:"G",fromTo:"to",requestObject:this.defaultVO},this.selectedBranchObj={},this.addOpeningBal=!1,this.showProfitToggle=!1,this.showProfitAccount=!1,this.fetchParameter()}ngOnInit(){var e;super.init(),this.baseFormGroup=this.formGroup,this.cifInfo=this.commonProv.session.getValueOf(m.a.USERINFO);const t=null===(e=this.commonProv.getElementValidations(this.openingBalanceToggleOptions.fcName))||void 0===e?void 0:e.DEFAULT_VALUE;if(t)try{!0===JSON.parse(t).value&&(this.addOpeningBal=!0,this.commonProv.applyDynScreenDisplay(m.a.ACTION_TYPE_MANDATORY,[this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName],1),this.commonProv.applyDynScreenDisplay(m.a.ACTION_TYPE_VISIBLE,[this.minOpeningBalOptions.fcName],1))}catch(o){console.warn("Invalid DEFAULT_VALUE:",t,o)}}ionViewDidEnter(){super.ionViewDidEnter(),this.commonProv.applyDynScreenDisplay(m.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName],1),this.commonProv.applyDynScreenDisplay(m.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions.toAmountOptions.currenciesOptions.fcName],1),this.commonProv.applyDynScreenDisplay(m.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions.toAmountOptions.amountOptions.fcName],1),this.commonProv.applyDynScreenDisplay(m.a.ACTION_TYPE_MANDATORY,[this.openingBalanceToggleOptions.fcName],0)}onSelectBranch(e){void 0!==e.itemValue&&(this.formGroup.controls[this.selectBranchOptions.fcName].setValue(e),this.commonProv.setValInsideNestedObj(this.selectBranchOptions.fcName,e.selectedObj,this.defaultVO))}loadBranch(){try{this.omniPull.returnBranchesList({branchesIdList:this.cifInfo.cifBranch?this.cifInfo.cifBranch:""}).then(e=>{e&&null!=e.gridModel&&e.gridModel.length>0?this.formGroup.controls[this.branchLabelOptions.fcName].setValue(this.cifInfo.cifBranch?e.gridModel[0].longDesc:""):this.loggerP.warn(e,"empty response")}).catch(e=>{})}catch(e){}}get getBranch(){return this.cifInfo.customerInfoCO?this.cifInfo.customerInfoCO.branchCode:1}fetchParameter(){return Object(n.b)(this,void 0,void 0,function*(){yield this.omniPull.getParamValOf(g.a.RequestBranch,g.a.AllowedBranches).then(e=>{var t;if(-1!==e&&null==e.RequestBranch||e.RequestBranch===m.a.cifBranch){this.enableCifBranch=!0,this.commonService.branchSelectionAndMapControl(0,[{fcName:this.stepperOptions.namesofSteps[1]},{fcName:this.mapAtmBranchesOptions.fcName},{fcName:"account_opening_panel_2"}],!0),this.commonProv.applyDynScreenDisplay(m.a.ACTION_TYPE_VISIBLE,[this.branchLabelOptions.fcName],1),this.commonProv.setValInsideNestedObj("branchCode",(null===(t=this.cifInfo.customerInfoCO)||void 0===t?void 0:t.branchCode)||"",this.formGroup.controls.formData.value);const o=e.allowedBranches?e.allowedBranches.toString().split(","):e.AllAllowedBranches.split(",");e.RequestBranch===m.a.cifBranch&&-1===o.toString().indexOf(this.cifInfo.cifBranch.toString())?(f.a.presentFatalAlert("Cannot_open_General_Account_in_your_CIF_Branch._Please_contact_our_call_center_key"),this.navService.navigateBackward()):setTimeout(()=>{this.commonProv.setValInsideNestedObj(this.branchLabelOptions.fcName,this.cifInfo.cifBranch?this.cifInfo.customerInfoCO.branchBriefDesc:"",this.defaultVO)},300)}else this.enableCifBranch=!1,this.commonService.branchSelectionAndMapControl(1,[{fcName:this.stepperOptions.namesofSteps[1]},{fcName:this.mapAtmBranchesOptions.fcName,mandatory:1},{fcName:"account_opening_panel_2"}]),this.commonProv.applyDynScreenDisplay(m.a.ACTION_TYPE_VISIBLE,[this.branchLabelOptions.fcName],0)}).catch(e=>{})})}onAddOpeningBalanceChange(e){e&&void 0!==e&&(!0===e.newValue||"true"===e.newValue?(this.addOpeningBal=!0,this.commonProv.applyDynScreenDisplay(m.a.ACTION_TYPE_MANDATORY,[this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName],1)):(this.addOpeningBal=!1,this.commonProv.applyDynScreenDisplay(m.a.ACTION_TYPE_MANDATORY,[this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName],0)))}onFromAccountCombinationValidation(e){e&&e[m.a.VALIDATE_COMBINATION]&&this.defaultVO[this.currencyOptions.fcName]instanceof Object&&this.validateCurrencyCombination()}onFromAccountChange(e){this.onFromAccountCombinationValidation(e),this.complexExchangeOptions.fromAmountOptions.currency=e.currencyBriefNameEnglish,this.complexExchangeOptions.fromAmountOptions.currencyCode=e.currency,setTimeout(()=>{this.stepperOptions.requestObject[this.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName]=e.currency},1)}onCurrencyChanged(e){this.onCurrencyCombinationValidation(),this.complexExchangeOptions.toAmountOptions.currency=e.selectedObj.briefDescription,this.complexExchangeOptions.toAmountOptions.currencyCode=e.itemValue,this.stepperOptions.requestObject[this.complexExchangeOptions.toAmountOptions.currenciesOptions.fcName]=e.itemValue}onAccountTypeChanged(e){var t;if(e){e.minOpenBal&&this.commonProv.setValInsideNestedObj(this.minOpeningBalOptions.fcName,(null===(t=this.cifInfo.companySettingsCO)||void 0===t?void 0:t.briefDesc)+" "+c.a.format(e.minOpenBal,this.mask).toString(),this.defaultVO);const o=this.commonProv.getElementValidations(this.toggleProfitOptions.fcName),n=this.commonProv.getElementValidations(this.profitAccOptions.fcName);e.postProfitTo==g.a.POST_PROFIT_TO_DEPOSITE_ACCOUNT||e.postProfitTo==g.a.POST_PROFIT_TO_PROFIT_ACCOUNT?(this.showProfitToggle=!(!d.a.custMode&&!o.IS_VISIBLE),this.showProfitAccount=(d.a.custMode||n.IS_VISIBLE)&&e.postProfitTo==g.a.POST_PROFIT_TO_PROFIT_ACCOUNT,this.commonProv.applyDynScreenDisplay(m.a.ACTION_TYPE_READONLY,[this.toggleProfitOptions.fcName],1),this.commonProv.setValInsideNestedObj(this.toggleProfitOptions.fcName,e.postProfitTo==g.a.POST_PROFIT_TO_DEPOSITE_ACCOUNT,this.defaultVO)):this.showProfitToggle=this.showProfitAccount=!1,e.genLedgerId&&(this.currencyOptions.accountTypesGLIds=e.genLedgerId,this.currenciesRef.loadCurrencies())}}onCurrencyCombinationValidation(){this.defaultVO[this.fromAccOptions.fcName]instanceof Object&&this.validateCurrencyCombination()}validateCurrencyCombination(){this.omniPull.validateCurrencyCombination({fromCurrency:+this.defaultVO[this.fromAccOptions.fcName].currency,listOfAffectedFields:[this.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName,this.currencyOptions.fcName],screenVO:this.defaultVO,listOfAccounts:[this.fromAccountRef,this.exchangeRef],toCurrency:+this.defaultVO[this.currencyOptions.fcName].itemValue})}}return e.\u0275fac=function(t){return new(t||e)(C.Rb(y.a),C.Rb(h.a),C.Rb(u.a),C.Rb(l.a),C.Rb(r.a),C.Rb(O.a))},e.\u0275cmp=C.Lb({type:e,selectors:[["account-opening"]],viewQuery:function(e,t){if(1&e&&(C.Wc(w,1),C.Wc(R,1),C.Wc(L,1)),2&e){let e;C.Bc(e=C.gc())&&(t.fromAccountRef=e.first),C.Bc(e=C.gc())&&(t.exchangeRef=e.first),C.Bc(e=C.gc())&&(t.currenciesRef=e.first)}},features:[C.Cb],decls:3,vars:4,consts:[[3,"options","id"],["step1","",3,"id",4,"psStep"],["step2","",3,"id",4,"psStep"],["step1","",3,"id"],["id","account_opening_panel_1",3,"options"],["id","'accountCifBranch' + id",3,"options",4,"ngIf"],["id","'accountType' + id",3,"options","onPsChange"],[3,"id","options","onPsChange"],["id","'currency' + id",3,"options","onPsChange"],["currenciesRef",""],[4,"ngIf"],["class","ps-toggle-acc-open-2",3,"id","options",4,"ngIf"],["id","profitAccount",3,"options",4,"ngIf"],["id","account_opening_panel_2",3,"options"],[3,"options","onPsChange"],["id","'accountCifBranch' + id",3,"options"],["id","MinimumOpeningBalance",3,"options"],["id","'fromAccount'",3,"options","onAccountChange"],["fromAccountRef",""],["id","exchangeComponent",3,"options"],["exchangeRef",""],[1,"ps-toggle-acc-open-2",3,"id","options"],["id","profitAccount",3,"options"],["step2","",3,"id"],[1,"component-map-container",3,"options"]],template:function(e,t){1&e&&(C.Xb(0,"ps-template-stepper",0),C.Pc(1,K,12,12,"ps-form-step",1),C.Pc(2,G,2,2,"ps-form-step",2),C.Wb()),2&e&&(C.pc("options",t.stepperOptions)("id",t.stepperOptions.stepperName),C.Fb(1),C.pc("psStep","step1"),C.Fb(1),C.pc("psStep","step2"))},directives:[_.a,A.a,N.a,T.a,P.o,I.a,v.a,S.a,k.a,B.a,E.a,x.a,D.a],styles:[""]}),e})()},ULj9:function(e,t,o){"use strict";o.d(t,"a",function(){return d});var n=o("mrSG"),s=o("ZyuK"),i=o("zngb"),c=o("ZF3V"),a=o("DFXC"),p=o("Q0Ba"),r=o("V0Fi"),l=o("fXoL"),u=o("Isd1"),h=o("+n0y"),m=o("iOQE");let f=(()=>{class e extends m.a{constructor(e,t,o){super(e,t),this.omniPull=o,this.defaultSelectOptions={labelKey:"label_branch_key",placeHolder:"branch_key"},this.branches=[]}ngOnInit(){this.commonProv.copyObject(this.defaultSelectOptions,this.options)}ngOnChanges(){this.getBranches()}getBranches(){const e={countryId:this.options.selectedCountryCode?parseInt(this.options.selectedCountryCode):null,regionId:this.options.selectedRegionCode?parseInt(this.options.selectedRegionCode):null,cityId:this.options.selectedCityCode?parseInt(this.options.selectedCityCode):null,mapTypesInclude:"'B'"};this.branches=[],this.omniPull.returnMapAtmBranches(e).then(e=>{if(this.defaultSelectOptions.listOfOptions=[],e&&null!=e.gridModel&&e.gridModel.length>0){for(let o=0;o<e.gridModel.length;o++)this.branches.push({itemValue:e.gridModel[o].vsBranchCode,description:e.gridModel[o].briefDesc,selectedObj:e.gridModel[o]});this.defaultSelectOptions.listOfOptions=this.branches;const t=this.defaultSelectOptions.group.controls[this.defaultSelectOptions.fcName].value;t&&!this.defaultSelectOptions.listOfOptions.some(e=>e.itemValue===t)&&this.defaultSelectOptions.group.controls[this.defaultSelectOptions.fcName].setValue(null)}else this.defaultSelectOptions.listOfOptions=[],this.defaultSelectOptions.group.controls[this.defaultSelectOptions.fcName].setValue(null),this.logger.warn(e,"empty response")}).catch(e=>{})}onBranchChange(e){this.loggerP.log("onBranchChange"+e),this.onPsChange.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(l.Rb(p.a),l.Rb(a.a),l.Rb(s.a))},e.\u0275cmp=l.Lb({type:e,selectors:[["ps-dropdown-branches"]],inputs:{options:"options"},features:[l.Cb,l.Db],decls:1,vars:2,consts:[[3,"id","options","onPsChange"]],template:function(e,t){1&e&&(l.Xb(0,"ps-select-dropdown",0),l.fc("onPsChange",function(e){return t.onBranchChange(e)}),l.Wb()),2&e&&l.pc("id",t.id)("options",t.defaultSelectOptions)},directives:[m.a],styles:[""]}),e})(),d=(()=>{class e extends c.a{constructor(e,t,o){super(e,t),this.omniPull=o,this.defaultOptions={}}ngOnInit(){var e,t;return Object(n.b)(this,void 0,void 0,function*(){this.defaultOptions={countryRegionCityOptions:{countriesOptions:{labelKey:"country__key",placeHolder:"select_country_key",fcName:this.options.countryRegionCityOptions?this.options.countryRegionCityOptions.countriesOptions.fcName:"branch_country",group:this.options.group,iconOptions:{iconName:"clipboard"}},regionOptions:{labelKey:"region_key",placeHolder:"region_key",fcName:this.options.countryRegionCityOptions?this.options.countryRegionCityOptions.regionOptions.fcName:"branch_region",group:this.options.group},cityOptions:{labelKey:"city_key",placeHolder:"select_city_key",fcName:this.options.countryRegionCityOptions?this.options.countryRegionCityOptions.cityOptions.fcName:"branch_city",group:this.options.group}}},this.defaultOptions.branchesOptions={group:this.options.group,fcName:this.options.branchesOptions?this.options.branchesOptions.fcName:"default_branch",placeHolder:(null===(e=this.options.branchesOptions)||void 0===e?void 0:e.placeHolder)?this.options.branchesOptions.placeHolder:"branch_key",labelKey:(null===(t=this.options.branchesOptions)||void 0===t?void 0:t.labelKey)?this.options.branchesOptions.labelKey:"label_branch_key"},this.commonProv.copyObject(this.defaultOptions,this.options);let o=this.commonProv.getElementValidations(this.defaultOptions.branchesOptions.fcName);if(this.options.parameterToCheck){const e=yield this.omniPull.checkBranch(this.options.parameterToCheck);o=this.commonProv.getElementValidations(this.defaultOptions.branchesOptions.fcName),this.commonProv.applyDynScreenDisplay(i.a.ACTION_TYPE_MANDATORY,[this.defaultOptions.branchesOptions.fcName],e.enableCifBranch||this.defaultOptions.branchesOptions.fcName&&!o.IS_VISIBLE?0:o.IS_MANDATORY)}else this.commonProv.applyDynScreenDisplay(i.a.ACTION_TYPE_MANDATORY,[this.defaultOptions.branchesOptions.fcName],o.IS_MANDATORY)})}onSelectBranch(e){this.onPsChange.emit(e)}onChildDropdownSelected(e){if(e[r.a.SELECTED_DROPDOWN]){const t=e[r.a.SELECTED_DROPDOWN];t===r.a.COUNTRY_DROPDOWN?(this.defaultOptions.branchesOptions.selectedCountryCode=void 0!==e.selectedObj?e.selectedObj.countriesID:null!=e.newValue?e.newValue:null,this.defaultOptions.branchesOptions.selectedRegionCode=null,this.defaultOptions.branchesOptions.selectedCityCode=null):t===r.a.REGION_DROPDOWN?(this.defaultOptions.branchesOptions.selectedRegionCode=void 0!==e.selectedObj?e.selectedObj.countriesRegionID:null!=e.newValue?e.newValue:null,this.defaultOptions.branchesOptions.selectedCityCode=null):t===r.a.CITY_DROPDOWN&&(this.defaultOptions.branchesOptions.selectedCityCode=void 0!==e.selectedObj?e.selectedObj.citiesId:null!=e.newValue?e.newValue:null)}this.defaultOptions.branchesOptions=Object.assign({},this.defaultOptions.branchesOptions)}}return e.\u0275fac=function(t){return new(t||e)(l.Rb(p.a),l.Rb(a.a),l.Rb(s.a))},e.\u0275cmp=l.Lb({type:e,selectors:[["ps-complex-select-branch"]],inputs:{options:"options"},features:[l.Cb],decls:3,vars:4,consts:[[1,"ps-complex-swift-benef-creation"],[3,"id","options","onPsChange"]],template:function(e,t){1&e&&(l.Xb(0,"ps-container-complex",0),l.Xb(1,"ps-complex-country-regions-cities",1),l.fc("onPsChange",function(e){return t.onChildDropdownSelected(e)}),l.Wb(),l.Xb(2,"ps-dropdown-branches",1),l.fc("onPsChange",function(e){return t.onSelectBranch(e)}),l.Wb(),l.Wb()),2&e&&(l.Fb(1),l.pc("id",t.id)("options",t.defaultOptions.countryRegionCityOptions),l.Fb(1),l.pc("id",t.id)("options",t.defaultOptions.branchesOptions))},directives:[u.a,h.a,f],styles:[""]}),e})()},VEWP:function(e,t,o){"use strict";o.d(t,"a",function(){return O});var n=o("mrSG"),s=o("fXoL"),i=o("4lGw"),c=o("V0Fi"),a=o("ZyuK"),p=o("ZF3V"),r=o("EIUR"),l=o("DFXC"),u=o("zngb"),h=o("Q0Ba"),m=o("Isd1"),f=o("L0og");const d=["complexLookupComponentObj"];let O=(()=>{class e extends p.a{constructor(e,t,o,n){super(e,t),this.commonService=e,this.omniPull=o,this.accountsService=n,this.options={fromTo:"",requestObject:null},this.complexLookupOptions={requestObject:null,notFoundMessage:"no_valid_account_found_key",multiple:!!this.options.multiple&&this.options.multiple},this.onAccountChange=new s.o,this.onAccountDeleted=new s.o,this.labelValuesMap=new Map,this.psCurrency=new r.a,this.labelOptions={},this.allType=!1}ngOnInit(){this.loadAccounts(null),this.complexLookupOptions.labelKey=this.options.labelKey,this.complexLookupOptions.title="title_key",this.complexLookupOptions.subTitle="sub_title_key",this.complexLookupOptions.labelsValueMap=this.labelValuesMap,this.allType=!!this.options.allType&&this.options.allType,this.commonProv.copyObject(this.complexLookupOptions,this.options,!1),this.complexLookupOptions.requestObject=this.options.requestObject}ngOnChanges(e){this.complexLookupOptions.labelKey=this.options.labelKey,this.complexLookupOptions.placeHolder=this.options.placeHolder}loadAccounts(e){return Object(n.b)(this,void 0,void 0,function*(){if(null!=e&&(this.options=e),this.options.listOfAccounts=[],void 0===this.options.fromTo||""===this.options.fromTo)return void this.logger.error("lookup_from_to_missing_key");const t=this.commonService.session.getValueOf(u.a.USERINFO),o=this.prepareRequestData(t);this.returnAccountList(o)})}returnAccountList(e){return Object(n.b)(this,void 0,void 0,function*(){const t=this.commonProv.session.getValueOf(c.a.PERSONALIZATION_CO);this.complexLookupOptions.listOfOptions=void 0;const o=yield this.omniPull.returnAccounts(e).catch(e=>{this.complexLookupOptions.listOfOptions=[],this.logger.error("Error: While fetching accounts in PsComplexOwnAccountComponent :",e)});if(o&&o.gridModel.length>0){if(this.allType){e.accountType="F",e.permittedGls="F";const t=yield this.omniPull.returnAccounts(e).catch(e=>{this.logger.error("Error: While fetching accounts in PsComplexOwnAccountComponent :",e)});t&&t.gridModel.length>0&&(o.gridModel=[...o.gridModel,...t.gridModel])}if(this.options.listOfAccounts=o.gridModel,this.options.accountNumber&&""!==this.options.accountNumber&&(this.complexLookupOptions.listOfOptions=this.options.listOfAccounts.filter(e=>e.accountNumber!==this.options.accountNumber)),this.options.currency&&""!==this.options.currency&&(this.complexLookupOptions.listOfOptions=this.fetchAccountBasedOnCurrency(this.options.currency),this.options.accountNumber&&""!==this.options.accountNumber&&(this.complexLookupOptions.listOfOptions=this.options.listOfAccounts.filter(e=>e.accountNumber!==this.options.accountNumber))),null!=this.options.accountNumber&&""!==this.options.accountNumber||(this.complexLookupOptions.listOfOptions=this.options.listOfAccounts),this.complexLookupOptions.listOfOptions=this.populateCustomAccounts(this.complexLookupOptions.listOfOptions),this.complexLookupOptions.listOfOptions.map((e,t)=>e.rowIndex=t),this.allAccounts=Object.assign([],this.complexLookupOptions.listOfOptions),null==this.complexLookupOptions.selectedItems&&(this.complexLookupOptions.selectedItems=[]),this.complexLookupOptions.multiple&&this.handleMultipleSelection(),!this.options.requestObject[this.options.fcName]&&(this.options.defaultByPersonalizedAcc=null==this.options.defaultByPersonalizedAcc||this.options.defaultByPersonalizedAcc,"from"===this.options.fromTo&&this.options.defaultByPersonalizedAcc)){let e="QR"===this.options.purpose?null==t?void 0:t.defaultQrPaymentAccKey:null==t?void 0:t.defaultTransferAccKey;this.complexLookupOptions.listOfOptions.map(t=>{t.personalizeKey&&t.personalizeKey===e&&(this.common.setValInsideNestedObj(this.options.fcName,t.lookupKey,this.options.requestObject),this.common.setValInsideNestedObj(this.options.fcName+"_lookupKey",t.lookupKey,this.options.requestObject))})}}else this.listOfAccounts=[],this.complexLookupOptions.listOfOptions=[]})}populateCustomAccounts(e){const t=[];for(const o of e){const e={briefNameEnglish:o.briefNameEnglish,cifShortNameEnglish:o.cifShortNameEnglish,accountNumber:o.accountNumber,balance:this.psCurrency.transform(null==o.balance?"0.0":o.balance,o.currencyDecimalPoints)+" "+(o.currencyBriefName||o.currencyBriefNameEnglish),availableBalance:this.psCurrency.transform(null==o.availableBalance?"0.0":o.availableBalance,o.currencyDecimalPoints)+" "+(o.currencyBriefName||o.currencyBriefNameEnglish),currencyBriefName:o.currencyBriefName||o.currencyBriefNameEnglish,currencyBriefNameEnglish:o.currencyBriefNameEnglish,currency:o.currency,accountTypeDesc:o.accountTypeDesc,additionalRef:o.additionalRef,ibanAccNo:o.ibanAccNo,accGl:o.accGl,serialNo:o.serialNo,branch:o.branch,cif:o.cif,formattedAccount:this.accountsService.returnFormattedAccount(o).formattedAccount,personalizeKey:o.personalizeKey,nickName:o.nickName,briefName:o.briefName,lookupKey:o.additionalRef,branchDescription:o.branchDescription?o.branchDescription:"",generalLedgerBriefNameEng:o.generalLedgerBriefNameEng?o.generalLedgerBriefNameEng:"",previewProperty:"accountNumber",status:o.statusDescription,statusCode:o.status,accountFormat:this.accountsService.returnFormattedAccount(o).accountFormat};this.options.multiple&&(e.excludeType=o.excludeType),t.push(e)}return t}prepareRequestData(e){let t={};if(e&&e.omniUserVO&&(t={userCifNo:e.omniUserVO.CIF_NO,type:"A"}),null!=this.options.queryParams&&void 0!==this.options.queryParams&&""!==this.options.queryParams&&(t={commonParametersList:this.options.queryParams}),null!=this.options.accountType&&void 0!==this.options.accountType&&""!==this.options.accountType&&(t.accountType=this.options.accountType),null!=this.options.glTypes&&void 0!==this.options.glTypes&&""!==this.options.glTypes&&(t.permittedGls=this.options.glTypes),null!=this.options.fromTo&&""!==this.options.fromTo&&(t.fromTo=this.options.fromTo),null!=this.options.endUserId&&""!==this.options.endUserId&&(t.endUserId=this.options.endUserId),null!=this.options.fromCurrency?t.fromCurrency=this.options.fromCurrency:null!=this.options.toCurrency&&(t.toCurrency=this.options.toCurrency),null!=this.options.accountAllowedCurrencies&&void 0!==this.options.accountAllowedCurrencies)if("string"==typeof this.options.accountAllowedCurrencies)t.accountAllowedCurrencies=this.options.accountAllowedCurrencies;else{let e="";for(const t in this.options.accountAllowedCurrencies)e+=this.options.accountAllowedCurrencies[t]+",";e=e.slice(0,e.lastIndexOf(",")),t.accountAllowedCurrencies=e}if(null!=this.options.accountAllowedTypes&&void 0!==this.options.accountAllowedTypes)if("string"==typeof this.options.accountAllowedTypes)t.accountAllowedTypes=this.options.accountAllowedTypes;else{let e="";for(const t in this.options.accountAllowedTypes)e+=this.options.accountAllowedTypes[t]+",";e=e.slice(0,e.lastIndexOf(",")),t.accountAllowedTypes=e}return t}fetchAccountBasedOnCurrency(e){return this.options.listOfAccounts}onChange(e){this.logger.log(e)}populateOwnAccountMap(){let e={},t={},o={};e={key:"accountNumber",value:"--- --- --- ---",isEdit:!1},t={key:"currentBalance",value:"0.0",isEdit:!1},o={key:"availableBalance",value:"0.0",isEdit:!1},this.labelValuesMap.set("account_key",e),this.labelValuesMap.set("balance_key",t),this.labelValuesMap.set("available_balance_key",o)}onChangeItem(e){this.onAccountChange.emit(e)}onDeleteItem(e){e&&this.onAccountDeleted.emit(e)}handleMultipleSelection(){const e=this.options.setAllAccountsAsSelecetd?this.complexLookupOptions.listOfOptions:this.options.requestObject[this.options.fcName]?this.complexLookupOptions.listOfOptions.filter(e=>this.options.requestObject[this.options.fcName].some(t=>t.accountNumber==e.accountNumber)):[];this.complexLookupOptions.selectedItems=e.filter(e=>this.options.setAllAccountsAsSelecetd&&(!e.excludeType||!(e.excludeType.includes(c.a.GENERAL_ACCOUNT_EXCLUDE_TYPE)||e.excludeType.includes(c.a.TERM_ACCOUNT_EXCLUDE_TYPE)))||!this.options.setAllAccountsAsSelecetd).map(e=>Object.assign(Object.assign({item:e[e.previewProperty]},e),{itemLookup:e.lookupKey})),this.complexLookupOptions.selectedItems.length>0&&this.complexLookupComponentObj.setSelectedItems(this.complexLookupOptions.selectedItems)}removeAccount(e){e&&void 0!==this.allAccounts&&(this.complexLookupOptions.listOfOptions=this.allAccounts?this.allAccounts.filter(t=>e.accountNumber!=t.accountNumber):[])}reset(){this.complexLookupComponentObj.resetLookUp()}refreshAcounts(e){this.complexLookupOptions.listOfOptions=Object.assign([],this.allAccounts),this.removeAccount(e)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(h.a),s.Rb(l.a),s.Rb(a.a),s.Rb(i.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["ps-lookup-own-accounts"]],viewQuery:function(e,t){if(1&e&&s.Wc(d,1),2&e){let e;s.Bc(e=s.gc())&&(t.complexLookupComponentObj=e.first)}},inputs:{options:"options"},outputs:{onAccountChange:"onAccountChange",onAccountDeleted:"onAccountDeleted"},features:[s.Cb,s.Db],decls:3,vars:2,consts:[[1,"ps-complex-own-account"],[3,"id","options","changeItem","onDeleteItem"],["complexLookupComponentObj",""]],template:function(e,t){1&e&&(s.Xb(0,"ps-container-complex",0),s.Xb(1,"ps-complex-lookup",1,2),s.fc("changeItem",function(e){return t.onChangeItem(e)})("onDeleteItem",function(e){return t.onDeleteItem(e)}),s.Wb(),s.Wb()),2&e&&(s.Fb(1),s.pc("id",t.id)("options",t.complexLookupOptions))},directives:[m.a,f.a],styles:[""]}),e})()}}]);