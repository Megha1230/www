(window.webpackJsonp=window.webpackJsonp||[]).push([[99,339,340,341,342,343,344,345,346,347,348,349],{VNEx:function(e,i,t){"use strict";t.d(i,"a",function(){return p});var s=t("ZF3V"),a=t("Q0Ba"),o=t("fOh1"),n=t("fXoL"),u=t("ofXK"),r=t("BygU");function l(e,i){if(1&e){const e=n.Yb();n.Xb(0,"div",1),n.Xb(1,"ps-container-lookup-option",2),n.fc("clickedCard",function(i){return n.Fc(e),n.ic().updateCard(i)}),n.Wb(),n.Wb()}if(2&e){const e=n.ic();n.Fb(1),n.pc("id","ps-container-lookup-option_"+e.id)("options",e.securityListOptions)("itemCard",e.options.securityInformation)}}let p=(()=>{class e extends s.a{constructor(e){super(e,e.logger),this.securityLabelValuesMap=new Map,this.securityHeaderMap=new Map,this.populateHeaderValueMap()}ngOnInit(){super.init(),this.securityListOptions={bottomPadding:!0,labelsValueMap:this.securityLabelValuesMap,headerMap:this.securityHeaderMap,showTemplateCard:!1,isEditable:null==this.options.isEditable||this.options.isEditable,actionDetailsOptions:[{id:"renewal_Liquidation",label:"renewal_Liquidation_key",actionHyperlink:{group:this.options.group,iconOptions:{iconName:"renewal-liquidation",labelOptions:{labelKey:"renewal_Liquidation_key"}},route:"security-renewal",pageOptions:{operId:1462,iconName:"renewal-liquidation",title:"renewal_Liquidation_key"}}}]},this.securityListOptions.itemList=[this.options.securityInformation]}populateHeaderValueMap(){let e={},i={},t={},s={},a={},n={},u={},r={},l={},p={},c={};e={key:"portfolioCif",value:"--- --- --- ---"},i={key:"portfolioName",value:""},s={key:"balanceStr",value:"0"},a={key:"totalNumberOfSukukStr",value:"0"},n={key:"blockedQuantity",value:"0"},u={key:"maturityDate",value:""},t={key:"issueDate",value:""},r={key:"marketPrice",value:"0"},l={key:"profitRate",value:"0"},p={key:"title",value:"title",isEdit:!1,formGroupMap:{labelKey:"",placeHolder:"",fcName:"title"}},c={key:"subTitle",value:"subTitle",isEdit:!1,formGroupMap:{labelKey:"",placeHolder:"",fcName:"subTitle"}},this.securityLabelValuesMap.set("balance_key",s),this.securityLabelValuesMap.set(o.a.isAgent?"available_balance_key":"sukuk_balance_key",a),this.securityLabelValuesMap.set("blocked_balance_key",n),this.securityLabelValuesMap.set("maturity_date_key",u),this.securityLabelValuesMap.set("issue_date_key",t),this.securityLabelValuesMap.set("market_price_key",r),this.securityLabelValuesMap.set("profit_rate_key",l),this.securityHeaderMap.set("title",p),this.securityHeaderMap.set("subTitle",c)}updateCard(e){}}return e.\u0275fac=function(i){return new(i||e)(n.Rb(a.a))},e.\u0275cmp=n.Lb({type:e,selectors:[["ps-option-expired-security"]],inputs:{options:"options"},features:[n.Cb],decls:1,vars:1,consts:[["class","ps-options-security",4,"ngIf"],[1,"ps-options-security"],[3,"id","options","itemCard","clickedCard"]],template:function(e,i){1&e&&n.Pc(0,l,2,3,"div",0),2&e&&n.pc("ngIf",i.securityListOptions.itemList&&i.securityListOptions.itemList.length>0)},directives:[u.o,r.a],styles:[""]}),e})()},"cL+G":function(e,i,t){"use strict";t.r(i),t.d(i,"SecurityRenewalPage",function(){return V});var s=t("3Pt+"),a=t("fOh1"),o=t("0CJq"),n=t("ZyuK"),u=t("DFXC"),r=t("zngb"),l=t("qEF5"),p=t("woXy"),c=t("Q0Ba"),h=t("QZhd"),m=t("gKqT"),d=t("fXoL"),k=t("kRg/"),O=t("uKCV"),y=t("sAFK"),b=t("+f2X"),f=t("ofXK"),v=t("ggmK"),_=t("WAnK"),g=t("G/Qj"),N=t("VNEx");function w(e,i){1&e&&d.Sb(0,"ps-option-expired-security",11),2&e&&d.pc("options",i.$implicit)}function L(e,i){if(1&e&&d.Sb(0,"ps-input-numeric",12),2&e){const e=d.ic(2);d.pc("options",e.availableBalOptions)}}function R(e,i){if(1&e){const e=d.Yb();d.Xb(0,"ps-form-step",2),d.Xb(1,"ps-container-panel",3),d.Pc(2,w,1,1,"ps-option-expired-security",4),d.Sb(3,"ps-input-display-only",5),d.Pc(4,L,1,1,"ps-input-numeric",6),d.Xb(5,"ps-input-numeric",7),d.fc("onPsChange",function(i){return d.Fc(e),d.ic().onsukukLiquidationAmountChange(i)}),d.Wb(),d.Xb(6,"ps-input-numeric",8),d.fc("onPsChange",function(i){return d.Fc(e),d.ic().onsukukRenewalAmountChange(i)}),d.Wb(),d.Sb(7,"ps-input-numeric",9),d.Sb(8,"ps-complex-amount",10),d.Wb(),d.Wb()}if(2&e){const e=d.ic();d.pc("id",e.stepperOptions.namesofSteps[0]),d.Fb(1),d.pc("options",e.panelOptions1Step1),d.Fb(1),d.pc("ngForOf",e.securityOptions),d.Fb(1),d.pc("options",e.newIsdaraNumberOptions),d.Fb(1),d.pc("ngIf",e.showAvailableBal),d.Fb(1),d.pc("options",e.sukukLiquidationOptions),d.Fb(1),d.pc("options",e.sukukRenewalOptions),d.Fb(1),d.pc("options",e.remainingOptions),d.Fb(1),d.pc("options",e.valueOfLiquidationOptions)}}let V=(()=>{class e extends m.OmniBasePage{constructor(e,i,t,o,n){super(),this.commonProv=e,this.navService=i,this.loggerP=t,this.omniCommonService=o,this.omniPull=n,this.formGroup=new s.f({}),this.securityRenewalVO={},this.securityOptions=[],this.previousSukukRenewal=0,this.previousSukukLiquidation=0,this.stepperOptions={stepperName:"sec_ren_stepper",isHorizontalStepper:!0,numberOfSteps:1,namesofSteps:["sec_renewal_step1"],group:this.formGroup,submitOptions:{extraParams:{},submitServiceUrl:a.a.serviceUrl.securityRenewal,group:this.formGroup},requestObject:this.securityRenewalVO},this.panelOptions1Step1={isExpandable:!0,labelKey:"request_key",iconName:"document",expanded:!0},this.sukukOptions={placeHolder:"renewal_liquidation_of_sukuk_key",labelKey:"renewal_liquidation_of_sukuk_key",group:this.formGroup,fcName:"sukukType"},this.todayDateOptions={placeHolder:"trx_date_key",labelKey:"trx_date_key",type:"text",psClass:"ps-disabled",group:this.formGroup,fcName:"todayDate"},this.portfolioCifOptions={placeHolder:"portfolio_key",labelKey:"portfolio_key",group:this.formGroup,fcName:"portfolioCif"},this.sukukBalanceOptions={placeHolder:"sukuk_balance_key",labelKey:"sukuk_balance_key",group:this.formGroup,fcName:"balance"},this.sukukRenewalOptions={fcName:"quantity",group:this.formGroup,labelKey:"sukuk_renewal_key",placeHolder:"enter_your_amount_key"},this.sukukLiquidationOptions={fcName:"sukukLiquidation",group:this.formGroup,labelKey:"sukuk_liquidation_key",placeHolder:"enter_your_amount_key"},this.remainingOptions={fcName:"remaining",group:this.formGroup,labelKey:"remaining_key",placeHolder:"amount_key"},this.availableBalOptions={fcName:"availableBal",group:this.formGroup,labelKey:a.a.isAgent?"available_balance_key":"sukuk_balance_key",placeHolder:"amount_key"},this.newIsdaraNumberOptions={labelKey:"new_isdara_number_key",placeHolder:"new_isdara_number_key",fcName:"newIsdaraNumber",group:this.formGroup,showEmpty:!0},this.valueOfLiquidationOptions={currenciesOptions:{labelKey:"currency_key",placeHolder:"currency_key",group:this.formGroup,fcName:"valueOfLiquidCurrency"},amountOptions:{labelKey:"value_of_liquidated_shares_key",placeHolder:"amount_key",fcName:"valueOfLiquidation",group:this.formGroup,type:"amount",decimalPoints:3}},this.showAvailableBal=!0}ngOnInit(){super.init(),this.baseFormGroup=this.formGroup,h.a.showInitialCardValues=6,this.commonProv.session.getValueOf(r.a.USERINFO),this.navResult=this.navService.getAllParams()?this.navService.getAllParams():null,this.navResult&&(this.securityOptions=[],this.securityOptions.push({isEditable:!1,securityInformation:this.navResult}),this.securityRenewalVO=this.navResult,this.security=this.navResult,this.blockedAmount=this.navResult.blockedQuantity?this.navResult.blockedQuantity:0,this.commonProv.copyObject(this.stepperOptions.submitOptions.extraParams,{securityCode1:this.navResult.securityCode1,securityCode2:this.navResult.securityCode2,portfolioSeq:this.navResult.portfolioSeq},!1,!0));const e=new Map;a.a.isAgent||e.set(this.securityRenewalVO[this.sukukLiquidationOptions.fcName],{disabled:!0}),this.commonProv.setDefaultValidators(e,this.sukukLiquidationOptions.group)}ngAfterViewInit(){this.securityRenewalVO[this.sukukLiquidationOptions.fcName]="",this.formGroup.controls[this.sukukRenewalOptions.fcName].setValue(this.navResult.totalNumberOfSukuk-this.blockedAmount),this.formGroup.controls[this.availableBalOptions.fcName].setValue(this.navResult.totalNumberOfSukuk),this.sukuCurrency()}sukuCurrency(){try{this.omniPull.returnSukukCurrency({sukukSearch:{securityCode1:this.navResult.securityCode1,securityCode2:this.navResult.securityCode2},linkToSecurityDetails:"Y"}).then(e=>{if(e&&null!=e.gridModel&&e.gridModel.length>0){const i=e.gridModel[0].tradingCurrencyCode;this.selecetdSukukPrice=e.gridModel[0].sukukPrice,this.calculatedSukukPrice=Number(e.gridModel[0].calculatedSukukPrice),e.gridModel[0].newIsdaraNumber&&this.formGroup.controls[this.newIsdaraNumberOptions.fcName].setValue(e.gridModel[0].newIsdaraNumber),this.formGroup.controls[this.valueOfLiquidationOptions.currenciesOptions.fcName].setValue(i),this.valueOfLiquidationOptions.amountOptions.group.controls[this.valueOfLiquidationOptions.amountOptions.fcName].setValue(this.calculatedSukukPrice*this.securityRenewalVO[this.sukukLiquidationOptions.fcName]),this.commonProv.applyDynScreenDisplay(r.a.ACTION_TYPE_READONLY,[this.availableBalOptions.fcName],1),this.commonProv.applyDynScreenDisplay(r.a.ACTION_TYPE_READONLY,[this.valueOfLiquidationOptions.currenciesOptions.fcName],1),this.commonProv.applyDynScreenDisplay(r.a.ACTION_TYPE_READONLY,[this.valueOfLiquidationOptions.amountOptions.fcName],1),this.commonProv.applyDynScreenDisplay(r.a.ACTION_TYPE_READONLY,[this.remainingOptions.fcName],1),a.a.isAgent||this.commonProv.applyDynScreenDisplay(r.a.ACTION_TYPE_READONLY,[this.availableBalOptions.fcName],1)}else this.commonProv.logger.warn(e,"empty response")}).catch(e=>{})}catch(e){}}onsukukRenewalAmountChange(e){if(this.loggerP.log("onsukukRenewalAmountChange",e.newValue),this.securityRenewalVO[this.sukukRenewalOptions.fcName]=e.newValue,0!=Number(this.availableBalOptions.group.controls[this.availableBalOptions.fcName].value)&&(this.securityRenewalVO[this.sukukLiquidationOptions.fcName]=Math.abs(Number(this.availableBalOptions.group.controls[this.availableBalOptions.fcName].value)-this.blockedAmount-e.newValue)),this.security.totalNumberOfSukuk-this.blockedAmount<Number(this.securityRenewalVO[this.sukukRenewalOptions.fcName])+Number(this.securityRenewalVO[this.sukukLiquidationOptions.fcName]))return l.a.presentInfoAlert(this.commonProv.translate("sum_of_sukuk_liquidation_and_sukuk_renewal_should_be_less_than_sukuk_balance_key")),void this.formGroup.controls[this.sukukRenewalOptions.fcName].setValue(this.previousSukukRenewal);this.previousSukukRenewal=this.securityRenewalVO[this.sukukRenewalOptions.fcName],this.formGroup.controls[this.sukukLiquidationOptions.fcName].setValue(this.securityRenewalVO[this.sukukLiquidationOptions.fcName]);const i=this.security.totalNumberOfSukuk-(Number(this.securityRenewalVO[this.sukukLiquidationOptions.fcName])+Number(e.newValue));this.remainingOptions.group.controls[this.remainingOptions.fcName].setValue(-1===Math.sign(i)?"0":i)}onsukukLiquidationAmountChange(e){if(this.loggerP.log("onsukukLiquidationAmountChange",e.newValue),this.securityRenewalVO[this.sukukLiquidationOptions.fcName]=e.newValue,this.securityRenewalVO[this.sukukRenewalOptions.fcName]=Math.abs(Number(this.availableBalOptions.group.controls[this.availableBalOptions.fcName].value)-this.blockedAmount-e.newValue),this.security.totalNumberOfSukuk-this.blockedAmount<Number(this.securityRenewalVO[this.sukukRenewalOptions.fcName])+Number(this.securityRenewalVO[this.sukukLiquidationOptions.fcName]))return l.a.presentInfoAlert(this.commonProv.translate("sum_of_sukuk_liquidation_and_sukuk_renewal_should_be_less_than_sukuk_balance_key")),void this.formGroup.controls[this.sukukLiquidationOptions.fcName].setValue(this.previousSukukLiquidation);this.previousSukukLiquidation=this.securityRenewalVO[this.sukukLiquidationOptions.fcName],this.formGroup.controls[this.sukukRenewalOptions.fcName].setValue(this.securityRenewalVO[this.sukukRenewalOptions.fcName]);const i=this.security.totalNumberOfSukuk-(Number(this.availableBalOptions.group.controls[this.availableBalOptions.fcName].value)-this.blockedAmount);this.remainingOptions.group.controls[this.remainingOptions.fcName].setValue(i),this.valueOfLiquidationOptions.amountOptions.group.controls[this.valueOfLiquidationOptions.amountOptions.fcName].setValue(this.calculatedSukukPrice*this.securityRenewalVO[this.sukukLiquidationOptions.fcName])}ionViewWillLeave(){h.a.showInitialCardValues=3}}return e.\u0275fac=function(i){return new(i||e)(d.Rb(c.a),d.Rb(p.a),d.Rb(u.a),d.Rb(o.a),d.Rb(n.a))},e.\u0275cmp=d.Lb({type:e,selectors:[["app-security-renewal"]],features:[d.Cb],decls:2,vars:3,consts:[[3,"options","id"],["step1","",3,"id",4,"psStep"],["step1","",3,"id"],["id","sec_renewal_panel",3,"options"],["id","ps-option-security-list","click","onclick",3,"options",4,"ngFor","ngForOf"],["id","'newIsdaraNumber' + id",3,"options"],["id","'availableBal' + id",3,"options",4,"ngIf"],["id","'sukukLiquidation' + id",3,"options","onPsChange"],["id","'sukukRenewal' + id",3,"options","onPsChange"],["id","'remaining' + id",3,"options"],["id","'valueOfLiquidation' + id",3,"options"],["id","ps-option-security-list","click","onclick",3,"options"],["id","'availableBal' + id",3,"options"]],template:function(e,i){1&e&&(d.Xb(0,"ps-template-stepper",0),d.Pc(1,R,9,9,"ps-form-step",1),d.Wb()),2&e&&(d.pc("options",i.stepperOptions)("id",i.stepperOptions.stepperName),d.Fb(1),d.pc("psStep","step1"))},directives:[k.a,O.a,y.a,b.a,f.n,v.a,f.o,_.a,g.a,N.a],styles:[""]}),e})()},gKqT:function(e,i,t){"use strict";t.r(i),t.d(i,"OmniBasePage",function(){return c});var s=t("oS+F"),a=t("zngb"),o=t("QZhd"),n=t("woXy"),u=t("qEF5"),r=t("Q0Ba"),l=t("lE2x"),p=t("fXoL");let c=(()=>{class e{constructor(){this.isPageDisabled=!1,this.commonProv=u.a.injectionHandler(r.a),this.navigationServices=u.a.injectionHandler(n.a)}init(){this.currentOperID=o.a.oper_ID,this.customizationMap=this.commonProv.returnOperCustomization();const e=this.navigationServices.getAllParams(),i={};e&&!0===e.readOnlypage?(i.IS_READONLY=1,this.customizationMap&&this.customizationMap.set(a.a.FORM_READONLY,i)):this.customizationMap&&(i.IS_READONLY=0,this.customizationMap.set(a.a.FORM_READONLY,i)),this.screenTranslationOperIds=l.a.MAIN_CONFIG.SCREEN_TRANSLATION_OPER?l.a.MAIN_CONFIG.SCREEN_TRANSLATION_OPER:[],this.screenTranslationOperIds.length>0&&this.screenTranslationOperIds.includes(this.currentOperID)&&this.getScreenTranslations(this.currentOperID)}ngOnInit(){this.init()}ionViewDidEnter(){this.viewDidEnter()}ionViewWillLeave(){this.viewWillLeave()}ionViewWillEnter(){this.viewWillEnter()}viewWillEnter(){}disableForm(e){if(void 0!==e&&this.customizationMap){const i=this.customizationMap.get(a.a.FORM_READONLY);i&&1===i.IS_READONLY&&"DISABLED"!=e.status&&(e.disable(),Object.keys(e.controls).forEach(e=>{this.commonProv.applyDynScreenDisplay(a.a.ACTION_TYPE_READONLY,[e],1)}))}}viewDidEnter(){this.commonProv.checkViewBS.next({value:!0,page:this,didEnter:!0}),this.commonProv.setCheckViewByOper(this.currentOperID?this.currentOperID:o.a.oper_ID),this.commonProv.emitCheckViewByOper(this.currentOperID?this.currentOperID:o.a.oper_ID,{value:!0,page:this,didEnter:!0}),this.commonProv.dismissLoading(),this.disableForm(this.baseFormGroup),s.a.getAllSessionFcVars(this.baseFormGroup),this.commonProv.setFormGroupByOper(this.baseFormGroup)}viewWillLeave(){this.commonProv.checkViewBS.next({value:!0,page:this,willLeave:!0}),this.commonProv.setCheckViewByOper(this.currentOperID?this.currentOperID:o.a.oper_ID),this.commonProv.emitCheckViewByOper(this.currentOperID?this.currentOperID:o.a.oper_ID,{value:!0,page:this,willLeave:!0})}ngAfterViewChecked(){this.isPageDisabled||setTimeout(()=>{this.disableForm(this.baseFormGroup),this.isPageDisabled=!0},300)}getScreenTranslations(e){const i=e||2222,t=o.a.activeLanguge?o.a.activeLanguge:"EN";i&&t&&this.commonProv.language.getOperTranslation(t,i)}}return e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=p.Lb({type:e,selectors:[["app-omni-base"]],hostVars:2,hostBindings:function(e,i){2&e&&p.Hb(i.psClass)},decls:0,vars:0,template:function(e,i){},styles:[""]}),e})()}}]);