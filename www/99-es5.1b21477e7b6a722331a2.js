!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,n(a.key),a)}}function i(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function n(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function a(e,t,i){return t=l(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,o()?Reflect.construct(t,i||[],l(e).constructor):t.apply(e,i))}function o(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(o=function(){return!!e})()}function s(e,t,i,n){var a=u(l(1&n?e.prototype:e),t,i);return 2&n&&"function"==typeof a?function(e){return a.apply(i,e)}:a}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var n=r(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(arguments.length<3?e:i):a.value}}).apply(null,arguments)}function r(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}(window.webpackJsonp=window.webpackJsonp||[]).push([[99,339,340,341,342,343,344,345,346,347,348,349],{VNEx:function(t,n,o){"use strict";o.d(n,"a",function(){return y});var u=o("ZF3V"),r=o("Q0Ba"),l=o("fOh1"),p=o("fXoL"),m=o("ofXK"),f=o("BygU");function k(e,t){if(1&e){var i=p.Yb();p.Xb(0,"div",1),p.Xb(1,"ps-container-lookup-option",2),p.fc("clickedCard",function(e){return p.Fc(i),p.ic().updateCard(e)}),p.Wb(),p.Wb()}if(2&e){var n=p.ic();p.Fb(1),p.pc("id","ps-container-lookup-option_"+n.id)("options",n.securityListOptions)("itemCard",n.options.securityInformation)}}var y=function(){var t=function(t){function n(t){var i;return e(this,n),(i=a(this,n,[t,t.logger])).securityLabelValuesMap=new Map,i.securityHeaderMap=new Map,i.populateHeaderValueMap(),i}return c(n,t),i(n,[{key:"ngOnInit",value:function(){s(n,"init",this,3)([]),this.securityListOptions={bottomPadding:!0,labelsValueMap:this.securityLabelValuesMap,headerMap:this.securityHeaderMap,showTemplateCard:!1,isEditable:null==this.options.isEditable||this.options.isEditable,actionDetailsOptions:[{id:"renewal_Liquidation",label:"renewal_Liquidation_key",actionHyperlink:{group:this.options.group,iconOptions:{iconName:"renewal-liquidation",labelOptions:{labelKey:"renewal_Liquidation_key"}},route:"security-renewal",pageOptions:{operId:1462,iconName:"renewal-liquidation",title:"renewal_Liquidation_key"}}}]},this.securityListOptions.itemList=[this.options.securityInformation]}},{key:"populateHeaderValueMap",value:function(){var e,t,i,n,a,o,s,u,r;t={key:"balanceStr",value:"0"},i={key:"totalNumberOfSukukStr",value:"0"},n={key:"blockedQuantity",value:"0"},a={key:"maturityDate",value:""},e={key:"issueDate",value:""},o={key:"marketPrice",value:"0"},s={key:"profitRate",value:"0"},u={key:"title",value:"title",isEdit:!1,formGroupMap:{labelKey:"",placeHolder:"",fcName:"title"}},r={key:"subTitle",value:"subTitle",isEdit:!1,formGroupMap:{labelKey:"",placeHolder:"",fcName:"subTitle"}},this.securityLabelValuesMap.set("balance_key",t),this.securityLabelValuesMap.set(l.a.isAgent?"available_balance_key":"sukuk_balance_key",i),this.securityLabelValuesMap.set("blocked_balance_key",n),this.securityLabelValuesMap.set("maturity_date_key",a),this.securityLabelValuesMap.set("issue_date_key",e),this.securityLabelValuesMap.set("market_price_key",o),this.securityLabelValuesMap.set("profit_rate_key",s),this.securityHeaderMap.set("title",u),this.securityHeaderMap.set("subTitle",r)}},{key:"updateCard",value:function(e){}}])}(u.a);return t.\u0275fac=function(e){return new(e||t)(p.Rb(r.a))},t.\u0275cmp=p.Lb({type:t,selectors:[["ps-option-expired-security"]],inputs:{options:"options"},features:[p.Cb],decls:1,vars:1,consts:[["class","ps-options-security",4,"ngIf"],[1,"ps-options-security"],[3,"id","options","itemCard","clickedCard"]],template:function(e,t){1&e&&p.Pc(0,k,2,3,"div",0),2&e&&p.pc("ngIf",t.securityListOptions.itemList&&t.securityListOptions.itemList.length>0)},directives:[m.o,f.a],styles:[""]}),t}()},"cL+G":function(t,n,o){"use strict";o.r(n),o.d(n,"SecurityRenewalPage",function(){return q});var u=o("3Pt+"),r=o("fOh1"),l=o("0CJq"),p=o("ZyuK"),m=o("DFXC"),f=o("zngb"),k=o("qEF5"),y=o("woXy"),d=o("Q0Ba"),h=o("QZhd"),O=o("gKqT"),b=o("fXoL"),v=o("kRg/"),_=o("uKCV"),g=o("sAFK"),w=o("+f2X"),N=o("ofXK"),R=o("ggmK"),L=o("WAnK"),P=o("G/Qj"),V=o("VNEx");function S(e,t){1&e&&b.Sb(0,"ps-option-expired-security",11),2&e&&b.pc("options",t.$implicit)}function C(e,t){if(1&e&&b.Sb(0,"ps-input-numeric",12),2&e){var i=b.ic(2);b.pc("options",i.availableBalOptions)}}function I(e,t){if(1&e){var i=b.Yb();b.Xb(0,"ps-form-step",2),b.Xb(1,"ps-container-panel",3),b.Pc(2,S,1,1,"ps-option-expired-security",4),b.Sb(3,"ps-input-display-only",5),b.Pc(4,C,1,1,"ps-input-numeric",6),b.Xb(5,"ps-input-numeric",7),b.fc("onPsChange",function(e){return b.Fc(i),b.ic().onsukukLiquidationAmountChange(e)}),b.Wb(),b.Xb(6,"ps-input-numeric",8),b.fc("onPsChange",function(e){return b.Fc(i),b.ic().onsukukRenewalAmountChange(e)}),b.Wb(),b.Sb(7,"ps-input-numeric",9),b.Sb(8,"ps-complex-amount",10),b.Wb(),b.Wb()}if(2&e){var n=b.ic();b.pc("id",n.stepperOptions.namesofSteps[0]),b.Fb(1),b.pc("options",n.panelOptions1Step1),b.Fb(1),b.pc("ngForOf",n.securityOptions),b.Fb(1),b.pc("options",n.newIsdaraNumberOptions),b.Fb(1),b.pc("ngIf",n.showAvailableBal),b.Fb(1),b.pc("options",n.sukukLiquidationOptions),b.Fb(1),b.pc("options",n.sukukRenewalOptions),b.Fb(1),b.pc("options",n.remainingOptions),b.Fb(1),b.pc("options",n.valueOfLiquidationOptions)}}var q=function(){var t=function(t){function n(t,i,o,s,l){var c;return e(this,n),(c=a(this,n)).commonProv=t,c.navService=i,c.loggerP=o,c.omniCommonService=s,c.omniPull=l,c.formGroup=new u.f({}),c.securityRenewalVO={},c.securityOptions=[],c.previousSukukRenewal=0,c.previousSukukLiquidation=0,c.stepperOptions={stepperName:"sec_ren_stepper",isHorizontalStepper:!0,numberOfSteps:1,namesofSteps:["sec_renewal_step1"],group:c.formGroup,submitOptions:{extraParams:{},submitServiceUrl:r.a.serviceUrl.securityRenewal,group:c.formGroup},requestObject:c.securityRenewalVO},c.panelOptions1Step1={isExpandable:!0,labelKey:"request_key",iconName:"document",expanded:!0},c.sukukOptions={placeHolder:"renewal_liquidation_of_sukuk_key",labelKey:"renewal_liquidation_of_sukuk_key",group:c.formGroup,fcName:"sukukType"},c.todayDateOptions={placeHolder:"trx_date_key",labelKey:"trx_date_key",type:"text",psClass:"ps-disabled",group:c.formGroup,fcName:"todayDate"},c.portfolioCifOptions={placeHolder:"portfolio_key",labelKey:"portfolio_key",group:c.formGroup,fcName:"portfolioCif"},c.sukukBalanceOptions={placeHolder:"sukuk_balance_key",labelKey:"sukuk_balance_key",group:c.formGroup,fcName:"balance"},c.sukukRenewalOptions={fcName:"quantity",group:c.formGroup,labelKey:"sukuk_renewal_key",placeHolder:"enter_your_amount_key"},c.sukukLiquidationOptions={fcName:"sukukLiquidation",group:c.formGroup,labelKey:"sukuk_liquidation_key",placeHolder:"enter_your_amount_key"},c.remainingOptions={fcName:"remaining",group:c.formGroup,labelKey:"remaining_key",placeHolder:"amount_key"},c.availableBalOptions={fcName:"availableBal",group:c.formGroup,labelKey:r.a.isAgent?"available_balance_key":"sukuk_balance_key",placeHolder:"amount_key"},c.newIsdaraNumberOptions={labelKey:"new_isdara_number_key",placeHolder:"new_isdara_number_key",fcName:"newIsdaraNumber",group:c.formGroup,showEmpty:!0},c.valueOfLiquidationOptions={currenciesOptions:{labelKey:"currency_key",placeHolder:"currency_key",group:c.formGroup,fcName:"valueOfLiquidCurrency"},amountOptions:{labelKey:"value_of_liquidated_shares_key",placeHolder:"amount_key",fcName:"valueOfLiquidation",group:c.formGroup,type:"amount",decimalPoints:3}},c.showAvailableBal=!0,c}return c(n,t),i(n,[{key:"ngOnInit",value:function(){s(n,"init",this,3)([]),this.baseFormGroup=this.formGroup,h.a.showInitialCardValues=6,this.commonProv.session.getValueOf(f.a.USERINFO),this.navResult=this.navService.getAllParams()?this.navService.getAllParams():null,this.navResult&&(this.securityOptions=[],this.securityOptions.push({isEditable:!1,securityInformation:this.navResult}),this.securityRenewalVO=this.navResult,this.security=this.navResult,this.blockedAmount=this.navResult.blockedQuantity?this.navResult.blockedQuantity:0,this.commonProv.copyObject(this.stepperOptions.submitOptions.extraParams,{securityCode1:this.navResult.securityCode1,securityCode2:this.navResult.securityCode2,portfolioSeq:this.navResult.portfolioSeq},!1,!0));var e=new Map;r.a.isAgent||e.set(this.securityRenewalVO[this.sukukLiquidationOptions.fcName],{disabled:!0}),this.commonProv.setDefaultValidators(e,this.sukukLiquidationOptions.group)}},{key:"ngAfterViewInit",value:function(){this.securityRenewalVO[this.sukukLiquidationOptions.fcName]="",this.formGroup.controls[this.sukukRenewalOptions.fcName].setValue(this.navResult.totalNumberOfSukuk-this.blockedAmount),this.formGroup.controls[this.availableBalOptions.fcName].setValue(this.navResult.totalNumberOfSukuk),this.sukuCurrency()}},{key:"sukuCurrency",value:function(){var e=this;try{this.omniPull.returnSukukCurrency({sukukSearch:{securityCode1:this.navResult.securityCode1,securityCode2:this.navResult.securityCode2},linkToSecurityDetails:"Y"}).then(function(t){if(t&&null!=t.gridModel&&t.gridModel.length>0){var i=t.gridModel[0].tradingCurrencyCode;e.selecetdSukukPrice=t.gridModel[0].sukukPrice,e.calculatedSukukPrice=Number(t.gridModel[0].calculatedSukukPrice),t.gridModel[0].newIsdaraNumber&&e.formGroup.controls[e.newIsdaraNumberOptions.fcName].setValue(t.gridModel[0].newIsdaraNumber),e.formGroup.controls[e.valueOfLiquidationOptions.currenciesOptions.fcName].setValue(i),e.valueOfLiquidationOptions.amountOptions.group.controls[e.valueOfLiquidationOptions.amountOptions.fcName].setValue(e.calculatedSukukPrice*e.securityRenewalVO[e.sukukLiquidationOptions.fcName]),e.commonProv.applyDynScreenDisplay(f.a.ACTION_TYPE_READONLY,[e.availableBalOptions.fcName],1),e.commonProv.applyDynScreenDisplay(f.a.ACTION_TYPE_READONLY,[e.valueOfLiquidationOptions.currenciesOptions.fcName],1),e.commonProv.applyDynScreenDisplay(f.a.ACTION_TYPE_READONLY,[e.valueOfLiquidationOptions.amountOptions.fcName],1),e.commonProv.applyDynScreenDisplay(f.a.ACTION_TYPE_READONLY,[e.remainingOptions.fcName],1),r.a.isAgent||e.commonProv.applyDynScreenDisplay(f.a.ACTION_TYPE_READONLY,[e.availableBalOptions.fcName],1)}else e.commonProv.logger.warn(t,"empty response")}).catch(function(e){})}catch(t){}}},{key:"onsukukRenewalAmountChange",value:function(e){if(this.loggerP.log("onsukukRenewalAmountChange",e.newValue),this.securityRenewalVO[this.sukukRenewalOptions.fcName]=e.newValue,0!=Number(this.availableBalOptions.group.controls[this.availableBalOptions.fcName].value)&&(this.securityRenewalVO[this.sukukLiquidationOptions.fcName]=Math.abs(Number(this.availableBalOptions.group.controls[this.availableBalOptions.fcName].value)-this.blockedAmount-e.newValue)),this.security.totalNumberOfSukuk-this.blockedAmount<Number(this.securityRenewalVO[this.sukukRenewalOptions.fcName])+Number(this.securityRenewalVO[this.sukukLiquidationOptions.fcName]))return k.a.presentInfoAlert(this.commonProv.translate("sum_of_sukuk_liquidation_and_sukuk_renewal_should_be_less_than_sukuk_balance_key")),void this.formGroup.controls[this.sukukRenewalOptions.fcName].setValue(this.previousSukukRenewal);this.previousSukukRenewal=this.securityRenewalVO[this.sukukRenewalOptions.fcName],this.formGroup.controls[this.sukukLiquidationOptions.fcName].setValue(this.securityRenewalVO[this.sukukLiquidationOptions.fcName]);var t=this.security.totalNumberOfSukuk-(Number(this.securityRenewalVO[this.sukukLiquidationOptions.fcName])+Number(e.newValue));this.remainingOptions.group.controls[this.remainingOptions.fcName].setValue(-1===Math.sign(t)?"0":t)}},{key:"onsukukLiquidationAmountChange",value:function(e){if(this.loggerP.log("onsukukLiquidationAmountChange",e.newValue),this.securityRenewalVO[this.sukukLiquidationOptions.fcName]=e.newValue,this.securityRenewalVO[this.sukukRenewalOptions.fcName]=Math.abs(Number(this.availableBalOptions.group.controls[this.availableBalOptions.fcName].value)-this.blockedAmount-e.newValue),this.security.totalNumberOfSukuk-this.blockedAmount<Number(this.securityRenewalVO[this.sukukRenewalOptions.fcName])+Number(this.securityRenewalVO[this.sukukLiquidationOptions.fcName]))return k.a.presentInfoAlert(this.commonProv.translate("sum_of_sukuk_liquidation_and_sukuk_renewal_should_be_less_than_sukuk_balance_key")),void this.formGroup.controls[this.sukukLiquidationOptions.fcName].setValue(this.previousSukukLiquidation);this.previousSukukLiquidation=this.securityRenewalVO[this.sukukLiquidationOptions.fcName],this.formGroup.controls[this.sukukRenewalOptions.fcName].setValue(this.securityRenewalVO[this.sukukRenewalOptions.fcName]);var t=this.security.totalNumberOfSukuk-(Number(this.availableBalOptions.group.controls[this.availableBalOptions.fcName].value)-this.blockedAmount);this.remainingOptions.group.controls[this.remainingOptions.fcName].setValue(t),this.valueOfLiquidationOptions.amountOptions.group.controls[this.valueOfLiquidationOptions.amountOptions.fcName].setValue(this.calculatedSukukPrice*this.securityRenewalVO[this.sukukLiquidationOptions.fcName])}},{key:"ionViewWillLeave",value:function(){h.a.showInitialCardValues=3}}])}(O.OmniBasePage);return t.\u0275fac=function(e){return new(e||t)(b.Rb(d.a),b.Rb(y.a),b.Rb(m.a),b.Rb(l.a),b.Rb(p.a))},t.\u0275cmp=b.Lb({type:t,selectors:[["app-security-renewal"]],features:[b.Cb],decls:2,vars:3,consts:[[3,"options","id"],["step1","",3,"id",4,"psStep"],["step1","",3,"id"],["id","sec_renewal_panel",3,"options"],["id","ps-option-security-list","click","onclick",3,"options",4,"ngFor","ngForOf"],["id","'newIsdaraNumber' + id",3,"options"],["id","'availableBal' + id",3,"options",4,"ngIf"],["id","'sukukLiquidation' + id",3,"options","onPsChange"],["id","'sukukRenewal' + id",3,"options","onPsChange"],["id","'remaining' + id",3,"options"],["id","'valueOfLiquidation' + id",3,"options"],["id","ps-option-security-list","click","onclick",3,"options"],["id","'availableBal' + id",3,"options"]],template:function(e,t){1&e&&(b.Xb(0,"ps-template-stepper",0),b.Pc(1,I,9,9,"ps-form-step",1),b.Wb()),2&e&&(b.pc("options",t.stepperOptions)("id",t.stepperOptions.stepperName),b.Fb(1),b.pc("psStep","step1"))},directives:[v.a,_.a,g.a,w.a,N.n,R.a,N.o,L.a,P.a,V.a],styles:[""]}),t}()},gKqT:function(t,n,a){"use strict";a.r(n),a.d(n,"OmniBasePage",function(){return f});var o=a("oS+F"),s=a("zngb"),u=a("QZhd"),r=a("woXy"),l=a("qEF5"),c=a("Q0Ba"),p=a("lE2x"),m=a("fXoL"),f=function(){var t=function(){return i(function t(){e(this,t),this.isPageDisabled=!1,this.commonProv=l.a.injectionHandler(c.a),this.navigationServices=l.a.injectionHandler(r.a)},[{key:"init",value:function(){this.currentOperID=u.a.oper_ID,this.customizationMap=this.commonProv.returnOperCustomization();var e=this.navigationServices.getAllParams(),t={};e&&!0===e.readOnlypage?(t.IS_READONLY=1,this.customizationMap&&this.customizationMap.set(s.a.FORM_READONLY,t)):this.customizationMap&&(t.IS_READONLY=0,this.customizationMap.set(s.a.FORM_READONLY,t)),this.screenTranslationOperIds=p.a.MAIN_CONFIG.SCREEN_TRANSLATION_OPER?p.a.MAIN_CONFIG.SCREEN_TRANSLATION_OPER:[],this.screenTranslationOperIds.length>0&&this.screenTranslationOperIds.includes(this.currentOperID)&&this.getScreenTranslations(this.currentOperID)}},{key:"ngOnInit",value:function(){this.init()}},{key:"ionViewDidEnter",value:function(){this.viewDidEnter()}},{key:"ionViewWillLeave",value:function(){this.viewWillLeave()}},{key:"ionViewWillEnter",value:function(){this.viewWillEnter()}},{key:"viewWillEnter",value:function(){}},{key:"disableForm",value:function(e){var t=this;if(void 0!==e&&this.customizationMap){var i=this.customizationMap.get(s.a.FORM_READONLY);i&&1===i.IS_READONLY&&"DISABLED"!=e.status&&(e.disable(),Object.keys(e.controls).forEach(function(e){t.commonProv.applyDynScreenDisplay(s.a.ACTION_TYPE_READONLY,[e],1)}))}}},{key:"viewDidEnter",value:function(){this.commonProv.checkViewBS.next({value:!0,page:this,didEnter:!0}),this.commonProv.setCheckViewByOper(this.currentOperID?this.currentOperID:u.a.oper_ID),this.commonProv.emitCheckViewByOper(this.currentOperID?this.currentOperID:u.a.oper_ID,{value:!0,page:this,didEnter:!0}),this.commonProv.dismissLoading(),this.disableForm(this.baseFormGroup),o.a.getAllSessionFcVars(this.baseFormGroup),this.commonProv.setFormGroupByOper(this.baseFormGroup)}},{key:"viewWillLeave",value:function(){this.commonProv.checkViewBS.next({value:!0,page:this,willLeave:!0}),this.commonProv.setCheckViewByOper(this.currentOperID?this.currentOperID:u.a.oper_ID),this.commonProv.emitCheckViewByOper(this.currentOperID?this.currentOperID:u.a.oper_ID,{value:!0,page:this,willLeave:!0})}},{key:"ngAfterViewChecked",value:function(){var e=this;this.isPageDisabled||setTimeout(function(){e.disableForm(e.baseFormGroup),e.isPageDisabled=!0},300)}},{key:"getScreenTranslations",value:function(e){var t=e||2222,i=u.a.activeLanguge?u.a.activeLanguge:"EN";t&&i&&this.commonProv.language.getOperTranslation(i,t)}}])}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Lb({type:t,selectors:[["app-omni-base"]],hostVars:2,hostBindings:function(e,t){2&e&&m.Hb(t.psClass)},decls:0,vars:0,template:function(e,t){},styles:[""]}),t}()}}])}();