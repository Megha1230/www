!function(){function e(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||t(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){if(e){if("string"==typeof e)return n(e,t);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},c=n.iterator||"@@iterator",s=n.toStringTag||"@@toStringTag";function r(n,o,c,s){var r=o&&o.prototype instanceof p?o:p,l=Object.create(r.prototype);return i(l,"_invoke",function(n,o,i){var c,s,r,p=0,l=i||[],u=!1,f={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return c=t,s=0,r=e,f.n=n,a}};function h(n,o){for(s=n,r=o,t=0;!u&&p&&!i&&t<l.length;t++){var i,c=l[t],h=f.p,m=c[2];n>3?(i=m===o)&&(r=c[(s=c[4])?5:(s=3,3)],c[4]=c[5]=e):c[0]<=h&&((i=n<2&&h<c[1])?(s=0,f.v=o,f.n=c[1]):h<m&&(i=n<3||c[0]>o||o>m)&&(c[4]=n,c[5]=o,f.n=m,s=0))}if(i||n>1)return a;throw u=!0,o}return function(i,l,m){if(p>1)throw TypeError("Generator is already running");for(u&&1===l&&h(l,m),s=l,r=m;(t=s<2?e:r)||!u;){c||(s?s<3?(s>1&&(f.n=-1),h(s,r)):f.n=r:f.v=r);try{if(p=2,c){if(s||(i="next"),t=c[i]){if(!(t=t.call(c,r)))throw TypeError("iterator result is not an object");if(!t.done)return t;r=t.value,s<2&&(s=0)}else 1===s&&(t=c.return)&&t.call(c),s<2&&(r=TypeError("The iterator does not provide a '"+i+"' method"),s=1);c=e}else if((t=(u=f.n<0)?r:n.call(o,f))!==a)break}catch(t){c=e,s=1,r=t}finally{p=1}}return{value:t,done:u}}}(n,c,s),!0),l}var a={};function p(){}function l(){}function u(){}t=Object.getPrototypeOf;var f=[][c]?t(t([][c]())):(i(t={},c,function(){return this}),t),h=u.prototype=p.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,i(e,s,"GeneratorFunction")),e.prototype=Object.create(h),e}return l.prototype=u,i(h,"constructor",u),i(u,"constructor",l),l.displayName="GeneratorFunction",i(u,s,"GeneratorFunction"),i(h),i(h,s,"Generator"),i(h,c,function(){return this}),i(h,"toString",function(){return"[object Generator]"}),(o=function(){return{w:r,m:m}})()}function i(e,t,n,o){var c=Object.defineProperty;try{c({},"",{})}catch(e){c=0}(i=function(e,t,n,o){function s(t,n){i(e,t,function(e){return this._invoke(t,n,e)})}t?c?c(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(s("next",0),s("throw",1),s("return",2))})(e,t,n,o)}function c(e,t,n,o){var i=s(m(1&o?e.prototype:e),t,n);return 2&o&&"function"==typeof i?function(e){return i.apply(n,e)}:i}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=r(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(null,arguments)}function r(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,u(o.key),o)}}function l(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function f(e,t,n){return t=m(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,h()?Reflect.construct(t,n||[],m(e).constructor):t.apply(e,n))}function h(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(h=function(){return!!e})()}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}function O(e,t){return(O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{"2Ihw":function(e,t,n){"use strict";n.d(t,"a",function(){return p});var o=n("ZyuK"),i=n("iOQE"),c=n("DFXC"),s=n("Q0Ba"),r=n("fXoL"),p=function(){var e=function(e){function t(e,n,o){var i;return a(this,t),(i=f(this,t,[e,n])).omniPull=o,i.defaultSelectOptions={labelKey:"account_type_key",placeHolder:"select_req_account_type_key"},i.accountType=[],i}return d(t,e),l(t,[{key:"ngOnInit",value:function(){this.commonProv.copyObject(this.defaultSelectOptions,this.options),this.getAccountTypes()}},{key:"getAccountTypes",value:function(){var e=this;this.omniPull.returnAccountTypes({accountCategory:this.options.accountCategory}).then(function(t){if(e.defaultSelectOptions.listOfOptions=[],t&&null!=t.gridModel&&t.gridModel.length>0){for(var n=0;n<t.gridModel.length;n++)e.accountType.push({itemValue:t.gridModel[n].typeCode,description:t.gridModel[n].briefDesc,selectedObj:t.gridModel[n]});e.defaultSelectOptions.listOfOptions=e.accountType}else e.logger.warn(t,"empty response")}).catch(function(e){})}},{key:"onAccountTypeChange",value:function(e){this.loggerP.log("onAccountTypeChange"+e),this.onPsChange.emit(e.selectedObj)}}])}(i.a);return e.\u0275fac=function(t){return new(t||e)(r.Rb(s.a),r.Rb(c.a),r.Rb(o.a))},e.\u0275cmp=r.Lb({type:e,selectors:[["ps-dropdown-account-types"]],inputs:{options:"options"},features:[r.Cb],decls:1,vars:2,consts:[[3,"id","options","onPsChange"]],template:function(e,t){1&e&&(r.Xb(0,"ps-select-dropdown",0),r.fc("onPsChange",function(e){return t.onAccountTypeChange(e)}),r.Wb()),2&e&&r.pc("id",t.id)("options",t.defaultSelectOptions)},directives:[i.a],styles:[""]}),e}()},QmEf:function(e,t,n){"use strict";n.r(t),n.d(t,"AccountOpeningPage",function(){return Q});var i=n("mrSG"),s=n("3Pt+"),r=n("I9E9"),p=n.n(r),u=n("OVQh"),h=n("fOh1"),m=n("0CJq"),O=n("ZyuK"),y=n("f42Q"),b=n("DFXC"),g=n("zngb"),v=n("qEF5"),_=n("QZhd"),A=n("woXy"),C=n("Q0Ba"),N=n("V0Fi"),T=n("gKqT"),P=n("fXoL"),k=n("kRg/"),I=n("uKCV"),S=n("sAFK"),w=n("+f2X"),E=n("ofXK"),B=n("2Ihw"),x=n("KuXP"),D=n("GmwD"),R=n("ULj9"),L=n("ggmK"),V=n("VEWP"),j=n("/M2N"),F=n("iTqn"),M=["fromAccountRef"],G=["exchangeRef"],K=["currenciesRef"];function q(e,t){if(1&e&&P.Sb(0,"ps-input-display-only",15),2&e){var n=P.ic(2);P.pc("options",n.branchLabelOptions)}}function Y(e,t){if(1&e){var n=P.Yb();P.Vb(0),P.Sb(1,"ps-input-display-only",16),P.Xb(2,"ps-lookup-own-accounts",17,18),P.fc("onAccountChange",function(e){return P.Fc(n),P.ic(2).onFromAccountChange(e)}),P.Wb(),P.Sb(4,"ps-complex-exchange",19,20),P.Ub()}if(2&e){var o=P.ic(2);P.Fb(1),P.pc("options",o.minOpeningBalOptions),P.Fb(1),P.pc("options",o.fromAccOptions),P.Fb(2),P.pc("options",o.complexExchangeOptions)}}function W(e,t){if(1&e&&P.Sb(0,"ps-select-toggle",21),2&e){var n=P.ic(2);P.pc("id","accprofitFMid")("options",n.toggleProfitOptions)}}function X(e,t){if(1&e&&P.Sb(0,"ps-lookup-own-accounts",22),2&e){var n=P.ic(2);P.pc("options",n.profitAccOptions)}}function U(e,t){if(1&e){var n=P.Yb();P.Xb(0,"ps-form-step",3),P.Xb(1,"ps-container-panel",4),P.Pc(2,q,1,1,"ps-input-display-only",5),P.Xb(3,"ps-dropdown-account-types",6),P.fc("onPsChange",function(e){return P.Fc(n),P.ic().onAccountTypeChanged(e)}),P.Wb(),P.Xb(4,"ps-select-toggle",7),P.fc("onPsChange",function(e){return P.Fc(n),P.ic().onAddOpeningBalanceChange(e)}),P.Wb(),P.Xb(5,"ps-dropdown-currencies",8,9),P.fc("onPsChange",function(e){return P.Fc(n),P.ic().onCurrencyChanged(e)}),P.Wb(),P.Pc(7,Y,6,3,"ng-container",10),P.Pc(8,W,1,2,"ps-select-toggle",11),P.Pc(9,X,1,1,"ps-lookup-own-accounts",12),P.Wb(),P.Xb(10,"ps-container-panel",13),P.Xb(11,"ps-complex-select-branch",14),P.fc("onPsChange",function(e){return P.Fc(n),P.ic().onSelectBranch(e)}),P.Wb(),P.Wb(),P.Wb()}if(2&e){var o=P.ic();P.pc("id",o.stepperOptions.namesofSteps[0]),P.Fb(1),P.pc("options",o.panelOptions1Step1),P.Fb(1),P.pc("ngIf",o.enableCifBranch),P.Fb(1),P.pc("options",o.accountTypeOptions),P.Fb(1),P.pc("id","addOpeningBalance")("options",o.openingBalanceToggleOptions),P.Fb(1),P.pc("options",o.currencyOptions),P.Fb(2),P.pc("ngIf",o.addOpeningBal),P.Fb(1),P.pc("ngIf",o.showProfitToggle),P.Fb(1),P.pc("ngIf",o.showProfitAccount),P.Fb(1),P.pc("options",o.panelOptions2Step1),P.Fb(1),P.pc("options",o.selectBranchOptions)}}function H(e,t){if(1&e&&(P.Xb(0,"ps-form-step",23),P.Sb(1,"ps-map-atm-branches",24),P.Wb()),2&e){var n=P.ic();P.pc("id",n.stepperOptions.namesofSteps[1]),P.Fb(1),P.pc("options",n.mapAtmBranchesOptions)}}var Q=function(){var e=function(e){function t(e,n,o,i,c,r){var p;return a(this,t),(p=f(this,t)).commonProv=e,p.loggerP=n,p.eventEmitterService=o,p.omniPull=i,p.commonService=c,p.navService=r,p.formGroup=new s.f({}),p.defaultVO={},p.mapAtmBranchesOptions={group:p.formGroup,fcName:"mapAtmBranches",labelKey:"map_atm_branch_key",mapOptions:{labelKey:"map"},showSegments:!1,mapTypesInclude:"'B'",branchIds:"1,3,5",parameterToCheck:N.a.RequestBranch,requestVO:p.defaultVO},p.mask={groupSeparator:_.a.THOUSANDS_SEPARATOR,alias:"currency",autoGroup:!0,placeholder:"0",greedy:!1,digits:2,radixPoint:_.a.DECIMAL_SEPARATOR},p.stepperOptions={stepperName:"acc_open_stepper",isHorizontalStepper:!0,numberOfSteps:2,namesofSteps:["acc_open_step1","acc_open_step2"],group:p.formGroup,submitOptions:{extraParams:{},submitServiceUrl:h.a.serviceUrl.accountOpeningEndPoint,group:p.formGroup},requestObject:p.defaultVO},p.accountTypeOptions={allowedAccountType:g.a.AllowedGeneralAccountTypes,accountCategory:g.a.ACC_TYPE_D,group:p.formGroup,fcName:"accountTypes"},p.openingBalanceToggleOptions={labelKey:"add_opening_balance_key",placeHolder:"add_opening_balance_key",group:p.formGroup,fcName:"addOpeningBalance",psClass:"toggleColor"},p.minOpeningBalOptions={placeHolder:"minimum_opening_balance_key",labelKey:"minimum_opening_balance_key",group:p.formGroup,fcName:"minOpenBalance"},p.fromAccOptions={labelKey:"from_account_key",placeHolder:"select_from_account_key",component:u.a,group:p.formGroup,accountAllowedCurrencies:[],accountAllowedTypes:[],glTypes:"G",fcName:"fromAccount",accountType:"G",fromTo:"from",requestObject:p.defaultVO},p.complexExchangeOptions={editableMode:!1,showToCurrencyOptions:!0,fromAmountOptions:{currency:"",currenciesOptions:{placeHolder:"currency_key",labelKey:"exchange_currency_key",fcName:"fromCurrency",group:p.formGroup,revertToOldValue:!1},amountOptions:{labelKey:"amount_key",placeHolder:"enter_amount_key",fcName:"transactionAmount",group:p.formGroup,decimalPoints:2}},toAmountOptions:{currency:"",currenciesOptions:{placeHolder:"currency_key",labelKey:"currency_key",fcName:"toCurrency",group:p.formGroup},amountOptions:{labelKey:"exchange_amount_key",placeHolder:"enter_amount_key",fcName:"toAmount",group:p.formGroup,decimalPoints:2}},requestObject:p.defaultVO,group:p.formGroup},p.accountNameOptions={labelKey:"name_key",placeHolder:"name_key",group:p.formGroup,fcName:"accountName"},p.currencyOptions={labelKey:"currency_key",placeHolder:"select_currency_key",group:p.formGroup,fcName:"currency",revertToOldValue:!1},p.panelOptions1Step1={isExpandable:!0,labelKey:"account_details_key",iconName:"document",expanded:!0},p.panelOptions2Step1={isExpandable:!0,labelKey:"select_branch_key",iconName:"document",expanded:!0},p.branchLabelOptions={placeHolder:"user_branch_key",labelKey:"branch_key",group:p.formGroup,fcName:"branch_type"},p.selectBranchOptions={fcName:"mapAtmBranchesDropdown",group:p.formGroup,branchesOptions:{placeHolder:"acc_opening_branch_key",labelKey:"label_acc_opening_branch_key",group:p.formGroup,fcName:"default_branch"}},p.toggleProfitOptions={labelKey:"post_profit_to_same_account_key",placeHolder:"post_profit_to_same_account_key",group:p.formGroup,fcName:"renewWithSame",psClass:"toggleColor"},p.profitAccOptions={labelKey:"post_profit_to_key",placeHolder:"select_post_profit_to_key",component:u.a,group:p.formGroup,accountAllowedCurrencies:[],accountAllowedTypes:[],glTypes:"G",fcName:"profitAccount",accountType:"G",fromTo:"to",requestObject:p.defaultVO},p.selectedBranchObj={},p.addOpeningBal=!1,p.showProfitToggle=!1,p.showProfitAccount=!1,p.fetchParameter(),p}return d(t,e),l(t,[{key:"ngOnInit",value:function(){var e;c(t,"init",this,3)([]),this.baseFormGroup=this.formGroup,this.cifInfo=this.commonProv.session.getValueOf(g.a.USERINFO);var n=null===(e=this.commonProv.getElementValidations(this.openingBalanceToggleOptions.fcName))||void 0===e?void 0:e.DEFAULT_VALUE;if(n)try{!0===JSON.parse(n).value&&(this.addOpeningBal=!0,this.commonProv.applyDynScreenDisplay(g.a.ACTION_TYPE_MANDATORY,[this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName],1),this.commonProv.applyDynScreenDisplay(g.a.ACTION_TYPE_VISIBLE,[this.minOpeningBalOptions.fcName],1))}catch(o){console.warn("Invalid DEFAULT_VALUE:",n,o)}}},{key:"ionViewDidEnter",value:function(){c(t,"ionViewDidEnter",this,3)([]),this.commonProv.applyDynScreenDisplay(g.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName],1),this.commonProv.applyDynScreenDisplay(g.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions.toAmountOptions.currenciesOptions.fcName],1),this.commonProv.applyDynScreenDisplay(g.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions.toAmountOptions.amountOptions.fcName],1),this.commonProv.applyDynScreenDisplay(g.a.ACTION_TYPE_MANDATORY,[this.openingBalanceToggleOptions.fcName],0)}},{key:"onSelectBranch",value:function(e){void 0!==e.itemValue&&(this.formGroup.controls[this.selectBranchOptions.fcName].setValue(e),this.commonProv.setValInsideNestedObj(this.selectBranchOptions.fcName,e.selectedObj,this.defaultVO))}},{key:"loadBranch",value:function(){var e=this;try{this.omniPull.returnBranchesList({branchesIdList:this.cifInfo.cifBranch?this.cifInfo.cifBranch:""}).then(function(t){t&&null!=t.gridModel&&t.gridModel.length>0?e.formGroup.controls[e.branchLabelOptions.fcName].setValue(e.cifInfo.cifBranch?t.gridModel[0].longDesc:""):e.loggerP.warn(t,"empty response")}).catch(function(e){})}catch(t){}}},{key:"getBranch",get:function(){return this.cifInfo.customerInfoCO?this.cifInfo.customerInfoCO.branchCode:1}},{key:"fetchParameter",value:function(){return Object(i.b)(this,void 0,void 0,o().m(function e(){var t=this;return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.omniPull.getParamValOf(N.a.RequestBranch,N.a.AllowedBranches).then(function(e){var n;if(-1!==e&&null==e.RequestBranch||e.RequestBranch===g.a.cifBranch){t.enableCifBranch=!0,t.commonService.branchSelectionAndMapControl(0,[{fcName:t.stepperOptions.namesofSteps[1]},{fcName:t.mapAtmBranchesOptions.fcName},{fcName:"account_opening_panel_2"}],!0),t.commonProv.applyDynScreenDisplay(g.a.ACTION_TYPE_VISIBLE,[t.branchLabelOptions.fcName],1),t.commonProv.setValInsideNestedObj("branchCode",(null===(n=t.cifInfo.customerInfoCO)||void 0===n?void 0:n.branchCode)||"",t.formGroup.controls.formData.value);var o=e.allowedBranches?e.allowedBranches.toString().split(","):e.AllAllowedBranches.split(",");e.RequestBranch===g.a.cifBranch&&-1===o.toString().indexOf(t.cifInfo.cifBranch.toString())?(v.a.presentFatalAlert("Cannot_open_General_Account_in_your_CIF_Branch._Please_contact_our_call_center_key"),t.navService.navigateBackward()):setTimeout(function(){t.commonProv.setValInsideNestedObj(t.branchLabelOptions.fcName,t.cifInfo.cifBranch?t.cifInfo.customerInfoCO.branchBriefDesc:"",t.defaultVO)},300)}else t.enableCifBranch=!1,t.commonService.branchSelectionAndMapControl(1,[{fcName:t.stepperOptions.namesofSteps[1]},{fcName:t.mapAtmBranchesOptions.fcName,mandatory:1},{fcName:"account_opening_panel_2"}]),t.commonProv.applyDynScreenDisplay(g.a.ACTION_TYPE_VISIBLE,[t.branchLabelOptions.fcName],0)}).catch(function(e){});case 1:return e.a(2)}},e,this)}))}},{key:"onAddOpeningBalanceChange",value:function(e){e&&void 0!==e&&(!0===e.newValue||"true"===e.newValue?(this.addOpeningBal=!0,this.commonProv.applyDynScreenDisplay(g.a.ACTION_TYPE_MANDATORY,[this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName],1)):(this.addOpeningBal=!1,this.commonProv.applyDynScreenDisplay(g.a.ACTION_TYPE_MANDATORY,[this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName],0)))}},{key:"onFromAccountCombinationValidation",value:function(e){e&&e[g.a.VALIDATE_COMBINATION]&&this.defaultVO[this.currencyOptions.fcName]instanceof Object&&this.validateCurrencyCombination()}},{key:"onFromAccountChange",value:function(e){var t=this;this.onFromAccountCombinationValidation(e),this.complexExchangeOptions.fromAmountOptions.currency=e.currencyBriefNameEnglish,this.complexExchangeOptions.fromAmountOptions.currencyCode=e.currency,setTimeout(function(){t.stepperOptions.requestObject[t.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName]=e.currency},1)}},{key:"onCurrencyChanged",value:function(e){this.onCurrencyCombinationValidation(),this.complexExchangeOptions.toAmountOptions.currency=e.selectedObj.briefDescription,this.complexExchangeOptions.toAmountOptions.currencyCode=e.itemValue,this.stepperOptions.requestObject[this.complexExchangeOptions.toAmountOptions.currenciesOptions.fcName]=e.itemValue}},{key:"onAccountTypeChanged",value:function(e){var t;if(e){e.minOpenBal&&this.commonProv.setValInsideNestedObj(this.minOpeningBalOptions.fcName,(null===(t=this.cifInfo.companySettingsCO)||void 0===t?void 0:t.briefDesc)+" "+p.a.format(e.minOpenBal,this.mask).toString(),this.defaultVO);var n=this.commonProv.getElementValidations(this.toggleProfitOptions.fcName),o=this.commonProv.getElementValidations(this.profitAccOptions.fcName);e.postProfitTo==N.a.POST_PROFIT_TO_DEPOSITE_ACCOUNT||e.postProfitTo==N.a.POST_PROFIT_TO_PROFIT_ACCOUNT?(this.showProfitToggle=!(!_.a.custMode&&!n.IS_VISIBLE),this.showProfitAccount=(_.a.custMode||o.IS_VISIBLE)&&e.postProfitTo==N.a.POST_PROFIT_TO_PROFIT_ACCOUNT,this.commonProv.applyDynScreenDisplay(g.a.ACTION_TYPE_READONLY,[this.toggleProfitOptions.fcName],1),this.commonProv.setValInsideNestedObj(this.toggleProfitOptions.fcName,e.postProfitTo==N.a.POST_PROFIT_TO_DEPOSITE_ACCOUNT,this.defaultVO)):this.showProfitToggle=this.showProfitAccount=!1,e.genLedgerId&&(this.currencyOptions.accountTypesGLIds=e.genLedgerId,this.currenciesRef.loadCurrencies())}}},{key:"onCurrencyCombinationValidation",value:function(){this.defaultVO[this.fromAccOptions.fcName]instanceof Object&&this.validateCurrencyCombination()}},{key:"validateCurrencyCombination",value:function(){this.omniPull.validateCurrencyCombination({fromCurrency:+this.defaultVO[this.fromAccOptions.fcName].currency,listOfAffectedFields:[this.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName,this.currencyOptions.fcName],screenVO:this.defaultVO,listOfAccounts:[this.fromAccountRef,this.exchangeRef],toCurrency:+this.defaultVO[this.currencyOptions.fcName].itemValue})}}])}(T.OmniBasePage);return e.\u0275fac=function(t){return new(t||e)(P.Rb(C.a),P.Rb(b.a),P.Rb(y.a),P.Rb(O.a),P.Rb(m.a),P.Rb(A.a))},e.\u0275cmp=P.Lb({type:e,selectors:[["account-opening"]],viewQuery:function(e,t){var n;(1&e&&(P.Wc(M,1),P.Wc(G,1),P.Wc(K,1)),2&e)&&(P.Bc(n=P.gc())&&(t.fromAccountRef=n.first),P.Bc(n=P.gc())&&(t.exchangeRef=n.first),P.Bc(n=P.gc())&&(t.currenciesRef=n.first))},features:[P.Cb],decls:3,vars:4,consts:[[3,"options","id"],["step1","",3,"id",4,"psStep"],["step2","",3,"id",4,"psStep"],["step1","",3,"id"],["id","account_opening_panel_1",3,"options"],["id","'accountCifBranch' + id",3,"options",4,"ngIf"],["id","'accountType' + id",3,"options","onPsChange"],[3,"id","options","onPsChange"],["id","'currency' + id",3,"options","onPsChange"],["currenciesRef",""],[4,"ngIf"],["class","ps-toggle-acc-open-2",3,"id","options",4,"ngIf"],["id","profitAccount",3,"options",4,"ngIf"],["id","account_opening_panel_2",3,"options"],[3,"options","onPsChange"],["id","'accountCifBranch' + id",3,"options"],["id","MinimumOpeningBalance",3,"options"],["id","'fromAccount'",3,"options","onAccountChange"],["fromAccountRef",""],["id","exchangeComponent",3,"options"],["exchangeRef",""],[1,"ps-toggle-acc-open-2",3,"id","options"],["id","profitAccount",3,"options"],["step2","",3,"id"],[1,"component-map-container",3,"options"]],template:function(e,t){1&e&&(P.Xb(0,"ps-template-stepper",0),P.Pc(1,U,12,12,"ps-form-step",1),P.Pc(2,H,2,2,"ps-form-step",2),P.Wb()),2&e&&(P.pc("options",t.stepperOptions)("id",t.stepperOptions.stepperName),P.Fb(1),P.pc("psStep","step1"),P.Fb(1),P.pc("psStep","step2"))},directives:[k.a,I.a,S.a,w.a,E.o,B.a,x.a,D.a,R.a,L.a,V.a,j.a,F.a],styles:[""]}),e}()},ULj9:function(e,t,n){"use strict";n.d(t,"a",function(){return A});var i,c,s=n("mrSG"),r=n("ZyuK"),p=n("zngb"),u=n("ZF3V"),h=n("DFXC"),m=n("Q0Ba"),O=n("V0Fi"),y=n("fXoL"),b=n("Isd1"),g=n("+n0y"),v=n("iOQE"),_=((c=function(e){function t(e,n,o){var i;return a(this,t),(i=f(this,t,[e,n])).omniPull=o,i.defaultSelectOptions={labelKey:"label_branch_key",placeHolder:"branch_key"},i.branches=[],i}return d(t,e),l(t,[{key:"ngOnInit",value:function(){this.commonProv.copyObject(this.defaultSelectOptions,this.options)}},{key:"ngOnChanges",value:function(){this.getBranches()}},{key:"getBranches",value:function(){var e=this,t={countryId:this.options.selectedCountryCode?parseInt(this.options.selectedCountryCode):null,regionId:this.options.selectedRegionCode?parseInt(this.options.selectedRegionCode):null,cityId:this.options.selectedCityCode?parseInt(this.options.selectedCityCode):null,mapTypesInclude:"'B'"};this.branches=[],this.omniPull.returnMapAtmBranches(t).then(function(t){if(e.defaultSelectOptions.listOfOptions=[],t&&null!=t.gridModel&&t.gridModel.length>0){for(var n=0;n<t.gridModel.length;n++)e.branches.push({itemValue:t.gridModel[n].vsBranchCode,description:t.gridModel[n].briefDesc,selectedObj:t.gridModel[n]});e.defaultSelectOptions.listOfOptions=e.branches;var o=e.defaultSelectOptions.group.controls[e.defaultSelectOptions.fcName].value;o&&!e.defaultSelectOptions.listOfOptions.some(function(e){return e.itemValue===o})&&e.defaultSelectOptions.group.controls[e.defaultSelectOptions.fcName].setValue(null)}else e.defaultSelectOptions.listOfOptions=[],e.defaultSelectOptions.group.controls[e.defaultSelectOptions.fcName].setValue(null),e.logger.warn(t,"empty response")}).catch(function(e){})}},{key:"onBranchChange",value:function(e){this.loggerP.log("onBranchChange"+e),this.onPsChange.emit(e)}}])}(v.a)).\u0275fac=function(e){return new(e||c)(y.Rb(m.a),y.Rb(h.a),y.Rb(r.a))},c.\u0275cmp=y.Lb({type:c,selectors:[["ps-dropdown-branches"]],inputs:{options:"options"},features:[y.Cb,y.Db],decls:1,vars:2,consts:[[3,"id","options","onPsChange"]],template:function(e,t){1&e&&(y.Xb(0,"ps-select-dropdown",0),y.fc("onPsChange",function(e){return t.onBranchChange(e)}),y.Wb()),2&e&&y.pc("id",t.id)("options",t.defaultSelectOptions)},directives:[v.a],styles:[""]}),c),A=((i=function(e){function t(e,n,o){var i;return a(this,t),(i=f(this,t,[e,n])).omniPull=o,i.defaultOptions={},i}return d(t,e),l(t,[{key:"ngOnInit",value:function(){var e,t;return Object(s.b)(this,void 0,void 0,o().m(function n(){var i,c;return o().w(function(n){for(;;)switch(n.n){case 0:if(this.defaultOptions={countryRegionCityOptions:{countriesOptions:{labelKey:"country__key",placeHolder:"select_country_key",fcName:this.options.countryRegionCityOptions?this.options.countryRegionCityOptions.countriesOptions.fcName:"branch_country",group:this.options.group,iconOptions:{iconName:"clipboard"}},regionOptions:{labelKey:"region_key",placeHolder:"region_key",fcName:this.options.countryRegionCityOptions?this.options.countryRegionCityOptions.regionOptions.fcName:"branch_region",group:this.options.group},cityOptions:{labelKey:"city_key",placeHolder:"select_city_key",fcName:this.options.countryRegionCityOptions?this.options.countryRegionCityOptions.cityOptions.fcName:"branch_city",group:this.options.group}}},this.defaultOptions.branchesOptions={group:this.options.group,fcName:this.options.branchesOptions?this.options.branchesOptions.fcName:"default_branch",placeHolder:(null===(e=this.options.branchesOptions)||void 0===e?void 0:e.placeHolder)?this.options.branchesOptions.placeHolder:"branch_key",labelKey:(null===(t=this.options.branchesOptions)||void 0===t?void 0:t.labelKey)?this.options.branchesOptions.labelKey:"label_branch_key"},this.commonProv.copyObject(this.defaultOptions,this.options),i=this.commonProv.getElementValidations(this.defaultOptions.branchesOptions.fcName),!this.options.parameterToCheck){n.n=2;break}return n.n=1,this.omniPull.checkBranch(this.options.parameterToCheck);case 1:c=n.v,i=this.commonProv.getElementValidations(this.defaultOptions.branchesOptions.fcName),this.commonProv.applyDynScreenDisplay(p.a.ACTION_TYPE_MANDATORY,[this.defaultOptions.branchesOptions.fcName],c.enableCifBranch||this.defaultOptions.branchesOptions.fcName&&!i.IS_VISIBLE?0:i.IS_MANDATORY),n.n=3;break;case 2:this.commonProv.applyDynScreenDisplay(p.a.ACTION_TYPE_MANDATORY,[this.defaultOptions.branchesOptions.fcName],i.IS_MANDATORY);case 3:return n.a(2)}},n,this)}))}},{key:"onSelectBranch",value:function(e){this.onPsChange.emit(e)}},{key:"onChildDropdownSelected",value:function(e){if(e[O.a.SELECTED_DROPDOWN]){var t=e[O.a.SELECTED_DROPDOWN];t===O.a.COUNTRY_DROPDOWN?(this.defaultOptions.branchesOptions.selectedCountryCode=void 0!==e.selectedObj?e.selectedObj.countriesID:null!=e.newValue?e.newValue:null,this.defaultOptions.branchesOptions.selectedRegionCode=null,this.defaultOptions.branchesOptions.selectedCityCode=null):t===O.a.REGION_DROPDOWN?(this.defaultOptions.branchesOptions.selectedRegionCode=void 0!==e.selectedObj?e.selectedObj.countriesRegionID:null!=e.newValue?e.newValue:null,this.defaultOptions.branchesOptions.selectedCityCode=null):t===O.a.CITY_DROPDOWN&&(this.defaultOptions.branchesOptions.selectedCityCode=void 0!==e.selectedObj?e.selectedObj.citiesId:null!=e.newValue?e.newValue:null)}this.defaultOptions.branchesOptions=Object.assign({},this.defaultOptions.branchesOptions)}}])}(u.a)).\u0275fac=function(e){return new(e||i)(y.Rb(m.a),y.Rb(h.a),y.Rb(r.a))},i.\u0275cmp=y.Lb({type:i,selectors:[["ps-complex-select-branch"]],inputs:{options:"options"},features:[y.Cb],decls:3,vars:4,consts:[[1,"ps-complex-swift-benef-creation"],[3,"id","options","onPsChange"]],template:function(e,t){1&e&&(y.Xb(0,"ps-container-complex",0),y.Xb(1,"ps-complex-country-regions-cities",1),y.fc("onPsChange",function(e){return t.onChildDropdownSelected(e)}),y.Wb(),y.Xb(2,"ps-dropdown-branches",1),y.fc("onPsChange",function(e){return t.onSelectBranch(e)}),y.Wb(),y.Wb()),2&e&&(y.Fb(1),y.pc("id",t.id)("options",t.defaultOptions.countryRegionCityOptions),y.Fb(1),y.pc("id",t.id)("options",t.defaultOptions.branchesOptions))},directives:[b.a,g.a,_],styles:[""]}),i)},VEWP:function(n,i,c){"use strict";c.d(i,"a",function(){return C});var s=c("mrSG"),r=c("fXoL"),p=c("4lGw"),u=c("V0Fi"),h=c("ZyuK"),m=c("ZF3V"),O=c("EIUR"),y=c("DFXC"),b=c("zngb"),g=c("Q0Ba"),v=c("Isd1"),_=c("L0og"),A=["complexLookupComponentObj"],C=function(){var n=function(n){function i(e,t,n,o){var c;return a(this,i),(c=f(this,i,[e,t])).commonService=e,c.omniPull=n,c.accountsService=o,c.options={fromTo:"",requestObject:null},c.complexLookupOptions={requestObject:null,notFoundMessage:"no_valid_account_found_key",multiple:!!c.options.multiple&&c.options.multiple},c.onAccountChange=new r.o,c.onAccountDeleted=new r.o,c.labelValuesMap=new Map,c.psCurrency=new O.a,c.labelOptions={},c.allType=!1,c}return d(i,n),l(i,[{key:"ngOnInit",value:function(){this.loadAccounts(null),this.complexLookupOptions.labelKey=this.options.labelKey,this.complexLookupOptions.title="title_key",this.complexLookupOptions.subTitle="sub_title_key",this.complexLookupOptions.labelsValueMap=this.labelValuesMap,this.allType=!!this.options.allType&&this.options.allType,this.commonProv.copyObject(this.complexLookupOptions,this.options,!1),this.complexLookupOptions.requestObject=this.options.requestObject}},{key:"ngOnChanges",value:function(e){this.complexLookupOptions.labelKey=this.options.labelKey,this.complexLookupOptions.placeHolder=this.options.placeHolder}},{key:"loadAccounts",value:function(e){return Object(s.b)(this,void 0,void 0,o().m(function t(){var n,i;return o().w(function(t){for(;;)switch(t.n){case 0:if(null!=e&&(this.options=e),this.options.listOfAccounts=[],void 0!==this.options.fromTo&&""!==this.options.fromTo){t.n=1;break}return t.a(2,void this.logger.error("lookup_from_to_missing_key"));case 1:n=this.commonService.session.getValueOf(b.a.USERINFO),i=this.prepareRequestData(n),this.returnAccountList(i);case 2:return t.a(2)}},t,this)}))}},{key:"returnAccountList",value:function(t){return Object(s.b)(this,void 0,void 0,o().m(function n(){var i,c,s,r,a=this;return o().w(function(n){for(;;)switch(n.n){case 0:return i=this.commonProv.session.getValueOf(u.a.PERSONALIZATION_CO),this.complexLookupOptions.listOfOptions=void 0,n.n=1,this.omniPull.returnAccounts(t).catch(function(e){a.complexLookupOptions.listOfOptions=[],a.logger.error("Error: While fetching accounts in PsComplexOwnAccountComponent :",e)});case 1:if(!((c=n.v)&&c.gridModel.length>0)){n.n=4;break}if(!this.allType){n.n=3;break}return t.accountType="F",t.permittedGls="F",n.n=2,this.omniPull.returnAccounts(t).catch(function(e){a.logger.error("Error: While fetching accounts in PsComplexOwnAccountComponent :",e)});case 2:(s=n.v)&&s.gridModel.length>0&&(c.gridModel=[].concat(e(c.gridModel),e(s.gridModel)));case 3:this.options.listOfAccounts=c.gridModel,this.options.accountNumber&&""!==this.options.accountNumber&&(this.complexLookupOptions.listOfOptions=this.options.listOfAccounts.filter(function(e){return e.accountNumber!==a.options.accountNumber})),this.options.currency&&""!==this.options.currency&&(this.complexLookupOptions.listOfOptions=this.fetchAccountBasedOnCurrency(this.options.currency),this.options.accountNumber&&""!==this.options.accountNumber&&(this.complexLookupOptions.listOfOptions=this.options.listOfAccounts.filter(function(e){return e.accountNumber!==a.options.accountNumber}))),null!=this.options.accountNumber&&""!==this.options.accountNumber||(this.complexLookupOptions.listOfOptions=this.options.listOfAccounts),this.complexLookupOptions.listOfOptions=this.populateCustomAccounts(this.complexLookupOptions.listOfOptions),this.complexLookupOptions.listOfOptions.map(function(e,t){return e.rowIndex=t}),this.allAccounts=Object.assign([],this.complexLookupOptions.listOfOptions),null==this.complexLookupOptions.selectedItems&&(this.complexLookupOptions.selectedItems=[]),this.complexLookupOptions.multiple&&this.handleMultipleSelection(),!this.options.requestObject[this.options.fcName]&&(this.options.defaultByPersonalizedAcc=null==this.options.defaultByPersonalizedAcc||this.options.defaultByPersonalizedAcc,"from"===this.options.fromTo&&this.options.defaultByPersonalizedAcc)&&(r="QR"===this.options.purpose?null==i?void 0:i.defaultQrPaymentAccKey:null==i?void 0:i.defaultTransferAccKey,this.complexLookupOptions.listOfOptions.map(function(e){e.personalizeKey&&e.personalizeKey===r&&(a.common.setValInsideNestedObj(a.options.fcName,e.lookupKey,a.options.requestObject),a.common.setValInsideNestedObj(a.options.fcName+"_lookupKey",e.lookupKey,a.options.requestObject))})),n.n=5;break;case 4:this.listOfAccounts=[],this.complexLookupOptions.listOfOptions=[];case 5:return n.a(2)}},n,this)}))}},{key:"populateCustomAccounts",value:function(e){var n,o=[],i=function(e,n){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=t(e))||n&&e&&"number"==typeof e.length){o&&(e=o);var i=0,c=function(){};return{s:c,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:c}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return r=e.done,e},e:function(e){a=!0,s=e},f:function(){try{r||null==o.return||o.return()}finally{if(a)throw s}}}}(e);try{for(i.s();!(n=i.n()).done;){var c=n.value,s={briefNameEnglish:c.briefNameEnglish,cifShortNameEnglish:c.cifShortNameEnglish,accountNumber:c.accountNumber,balance:this.psCurrency.transform(null==c.balance?"0.0":c.balance,c.currencyDecimalPoints)+" "+(c.currencyBriefName||c.currencyBriefNameEnglish),availableBalance:this.psCurrency.transform(null==c.availableBalance?"0.0":c.availableBalance,c.currencyDecimalPoints)+" "+(c.currencyBriefName||c.currencyBriefNameEnglish),currencyBriefName:c.currencyBriefName||c.currencyBriefNameEnglish,currencyBriefNameEnglish:c.currencyBriefNameEnglish,currency:c.currency,accountTypeDesc:c.accountTypeDesc,additionalRef:c.additionalRef,ibanAccNo:c.ibanAccNo,accGl:c.accGl,serialNo:c.serialNo,branch:c.branch,cif:c.cif,formattedAccount:this.accountsService.returnFormattedAccount(c).formattedAccount,personalizeKey:c.personalizeKey,nickName:c.nickName,briefName:c.briefName,lookupKey:c.additionalRef,branchDescription:c.branchDescription?c.branchDescription:"",generalLedgerBriefNameEng:c.generalLedgerBriefNameEng?c.generalLedgerBriefNameEng:"",previewProperty:"accountNumber",status:c.statusDescription,statusCode:c.status,accountFormat:this.accountsService.returnFormattedAccount(c).accountFormat};this.options.multiple&&(s.excludeType=c.excludeType),o.push(s)}}catch(r){i.e(r)}finally{i.f()}return o}},{key:"prepareRequestData",value:function(e){var t={};if(e&&e.omniUserVO&&(t={userCifNo:e.omniUserVO.CIF_NO,type:"A"}),null!=this.options.queryParams&&void 0!==this.options.queryParams&&""!==this.options.queryParams&&(t={commonParametersList:this.options.queryParams}),null!=this.options.accountType&&void 0!==this.options.accountType&&""!==this.options.accountType&&(t.accountType=this.options.accountType),null!=this.options.glTypes&&void 0!==this.options.glTypes&&""!==this.options.glTypes&&(t.permittedGls=this.options.glTypes),null!=this.options.fromTo&&""!==this.options.fromTo&&(t.fromTo=this.options.fromTo),null!=this.options.endUserId&&""!==this.options.endUserId&&(t.endUserId=this.options.endUserId),null!=this.options.fromCurrency?t.fromCurrency=this.options.fromCurrency:null!=this.options.toCurrency&&(t.toCurrency=this.options.toCurrency),null!=this.options.accountAllowedCurrencies&&void 0!==this.options.accountAllowedCurrencies)if("string"==typeof this.options.accountAllowedCurrencies)t.accountAllowedCurrencies=this.options.accountAllowedCurrencies;else{var n="";for(var o in this.options.accountAllowedCurrencies)n+=this.options.accountAllowedCurrencies[o]+",";n=n.slice(0,n.lastIndexOf(",")),t.accountAllowedCurrencies=n}if(null!=this.options.accountAllowedTypes&&void 0!==this.options.accountAllowedTypes)if("string"==typeof this.options.accountAllowedTypes)t.accountAllowedTypes=this.options.accountAllowedTypes;else{var i="";for(var c in this.options.accountAllowedTypes)i+=this.options.accountAllowedTypes[c]+",";i=i.slice(0,i.lastIndexOf(",")),t.accountAllowedTypes=i}return t}},{key:"fetchAccountBasedOnCurrency",value:function(e){return this.options.listOfAccounts}},{key:"onChange",value:function(e){this.logger.log(e)}},{key:"populateOwnAccountMap",value:function(){var e,t,n;e={key:"accountNumber",value:"--- --- --- ---",isEdit:!1},t={key:"currentBalance",value:"0.0",isEdit:!1},n={key:"availableBalance",value:"0.0",isEdit:!1},this.labelValuesMap.set("account_key",e),this.labelValuesMap.set("balance_key",t),this.labelValuesMap.set("available_balance_key",n)}},{key:"onChangeItem",value:function(e){this.onAccountChange.emit(e)}},{key:"onDeleteItem",value:function(e){e&&this.onAccountDeleted.emit(e)}},{key:"handleMultipleSelection",value:function(){var e=this,t=this.options.setAllAccountsAsSelecetd?this.complexLookupOptions.listOfOptions:this.options.requestObject[this.options.fcName]?this.complexLookupOptions.listOfOptions.filter(function(t){return e.options.requestObject[e.options.fcName].some(function(e){return e.accountNumber==t.accountNumber})}):[];this.complexLookupOptions.selectedItems=t.filter(function(t){return e.options.setAllAccountsAsSelecetd&&(!t.excludeType||!(t.excludeType.includes(u.a.GENERAL_ACCOUNT_EXCLUDE_TYPE)||t.excludeType.includes(u.a.TERM_ACCOUNT_EXCLUDE_TYPE)))||!e.options.setAllAccountsAsSelecetd}).map(function(e){return Object.assign(Object.assign({item:e[e.previewProperty]},e),{itemLookup:e.lookupKey})}),this.complexLookupOptions.selectedItems.length>0&&this.complexLookupComponentObj.setSelectedItems(this.complexLookupOptions.selectedItems)}},{key:"removeAccount",value:function(e){e&&void 0!==this.allAccounts&&(this.complexLookupOptions.listOfOptions=this.allAccounts?this.allAccounts.filter(function(t){return e.accountNumber!=t.accountNumber}):[])}},{key:"reset",value:function(){this.complexLookupComponentObj.resetLookUp()}},{key:"refreshAcounts",value:function(e){this.complexLookupOptions.listOfOptions=Object.assign([],this.allAccounts),this.removeAccount(e)}}])}(m.a);return n.\u0275fac=function(e){return new(e||n)(r.Rb(g.a),r.Rb(y.a),r.Rb(h.a),r.Rb(p.a))},n.\u0275cmp=r.Lb({type:n,selectors:[["ps-lookup-own-accounts"]],viewQuery:function(e,t){var n;(1&e&&r.Wc(A,1),2&e)&&(r.Bc(n=r.gc())&&(t.complexLookupComponentObj=n.first))},inputs:{options:"options"},outputs:{onAccountChange:"onAccountChange",onAccountDeleted:"onAccountDeleted"},features:[r.Cb,r.Db],decls:3,vars:2,consts:[[1,"ps-complex-own-account"],[3,"id","options","changeItem","onDeleteItem"],["complexLookupComponentObj",""]],template:function(e,t){1&e&&(r.Xb(0,"ps-container-complex",0),r.Xb(1,"ps-complex-lookup",1,2),r.fc("changeItem",function(e){return t.onChangeItem(e)})("onDeleteItem",function(e){return t.onDeleteItem(e)}),r.Wb(),r.Wb()),2&e&&(r.Fb(1),r.pc("id",t.id)("options",t.complexLookupOptions))},directives:[v.a,_.a],styles:[""]}),n}()}}])}();