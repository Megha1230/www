(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{"+BRL":function(e,t,o){"use strict";o.d(t,"a",function(){return a});var s=o("DFXC"),i=o("Q0Ba"),n=o("BYmO"),p=o("fXoL");let a=(()=>{class e extends n.a{constructor(e,t){super(e,t),this.options={},this.defaultOptions={}}ngOnInit(){this.commonProv.copyObject(this.defaultOptions,this.options,!1)}onInputChanged(e){this.onPsChange.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(p.Rb(i.a),p.Rb(s.a))},e.\u0275cmp=p.Lb({type:e,selectors:[["ps-input-free-text"]],inputs:{options:"options"},features:[p.Cb],decls:1,vars:2,consts:[[3,"id","options","onPsChange"]],template:function(e,t){1&e&&(p.Xb(0,"ps-keyin-input",0),p.fc("onPsChange",function(e){return t.onInputChanged(e)}),p.Wb()),2&e&&p.pc("id",t.id)("options",t.defaultOptions)},directives:[n.a],styles:[""]}),e})()},BcCD:function(e,t,o){"use strict";o.d(t,"a",function(){return u});var s=o("zngb"),i=o("JpVU"),n=o("DFXC"),p=o("qEF5"),a=o("Q0Ba"),l=o("ZyuK"),c=o("r40+"),r=o("fXoL");let u=(()=>{class e extends i.a{constructor(e,t,o){super(e,t,o),this.commonProv=e,this.dateOptions={},this.omniPull=p.a.injectionHandler(l.a)}ngOnInit(){this.commonProv.copyObject(this.dateOptions,this.options,!1);const e=this.omniPull.omniCommon.session.getValueOf(s.a.preLoginResponse).parameters;this.dateOptions.displayFormat=e.DefaultDateFormat?e.DefaultDateFormat.parameterVal:"DD/MM/YYYY",this.dateOptions.pickerFormat=this.dateOptions.displayFormat}ngOnChanges(){this.options&&this.options.min&&(this.dateOptions.min=this.options.min),this.options&&this.options.max&&(this.dateOptions.max=this.options.max)}dateChanged(e){this.onPsChange.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Rb(a.a),r.Rb(n.a),r.Rb(c.a))},e.\u0275cmp=r.Lb({type:e,selectors:[["ps-date-day-month-year"]],inputs:{options:"options"},features:[r.Cb,r.Db],decls:1,vars:2,consts:[[1,"ps-day-month-year",3,"options","id","onPsChange","onPsInit"]],template:function(e,t){1&e&&(r.Xb(0,"ps-keyin-date",0),r.fc("onPsChange",function(e){return t.dateChanged(e)})("onPsInit",function(e){return t.onInit(e)}),r.Wb()),2&e&&r.pc("options",t.dateOptions)("id",t.id)},directives:[i.a],styles:[""]}),e})()},RzDK:function(e,t,o){"use strict";o.r(t),o.d(t,"BillPaymentPage",function(){return q});var s=o("mrSG"),i=o("3Pt+"),n=o("/M2N"),p=o("ltde"),a=o("WAnK"),l=o("woXy"),c=o("OVQh"),r=o("BcCD"),u=o("fOh1"),m=o("ZyuK"),h=o("BYmO"),d=o("zngb"),b=o("gKqT"),O=o("qEF5"),f=o("fXoL"),y=o("kRg/"),g=o("uKCV"),P=o("sAFK"),w=o("Sx1r"),v=o("KVmc"),x=o("+f2X"),C=o("VEWP"),N=o("+c6a"),A=o("CKXk"),L=o("ZF3V"),k=o("DFXC"),_=o("Q0Ba"),E=o("Isd1"),V=o("L0og");const I=["complexLookupComponentObj"];let F=(()=>{class e extends L.a{constructor(e,t,o,s){super(e,t),this.commonService=e,this.omniPull=o,this.navService=s,this.formGroup=new i.f({}),this.options={requestObject:null},this.complexLookupOptions={requestObject:null,notFoundMessage:"no_fav_payee_found_key"},this.onFavPayeeChange=new f.o,this.labelValuesMap=new Map,this.headerMap=new Map,this.favPayeeOptions=[],this.showList=!1,this.pupulateFavPayeeMap()}ngOnInit(){super.init(),this.loadFavPayee(),this.complexLookupOptions.title="title_key",this.complexLookupOptions.subTitle="sub_title_key",this.complexLookupOptions.labelsValueMap=this.labelValuesMap,this.commonProv.copyObject(this.complexLookupOptions,this.options,!1),this.complexLookupOptions.requestObject=this.options.requestObject,this.complexLookupOptions.component=this.options&&this.options.component?this.options.component:p.a}loadFavPayee(){this.returnFavPayee()}returnFavPayee(e,t){return Object(s.b)(this,void 0,void 0,function*(){const o={commonParametersList:this.options.queryParams},s=yield this.omniPull.returnFavPayee(o).catch(e=>{this.complexLookupOptions.listOfOptions=[],this.logger.error("Error: While Favourite Payee list in PsLookupFavPayeeComponent :",e)});if(s&&s.gridModel.length>0){let o=this.populateFavPayee(s);this.complexLookupOptions.listOfOptions=e&&t?o.filter(o=>o.biller===t.itemValue.toString()&&o.category===e.itemValue.toString()):o,this.logger.log("mappedData",o),this.logger.log("listOfOptions",this.complexLookupOptions.listOfOptions)}else this.complexLookupOptions.listOfOptions=[];this.showList=!0})}populateFavPayee(e){const t=[];if(e&&e.gridModel&&e.gridModel.length>0){for(const o of e.gridModel)o&&o.submitFieldValueMap&&t.push({biller:o.submitFieldValueMap.biller?o.submitFieldValueMap.biller:"--",billerAccount:o.submitFieldValueMap.billerAccount?o.submitFieldValueMap.billerAccount:"--",category:o.submitFieldValueMap.category?o.submitFieldValueMap.category:"--",companyCif:o.submitFieldValueMap.companyCif?o.submitFieldValueMap.companyCif:"--",nickName:o.submitFieldValueMap.nickName?o.submitFieldValueMap.nickName:"--",lookupKey:o.submitFieldValueMap.billerAccount,purpose:o.submitFieldValueMap.purpose?o.submitFieldValueMap.purpose:"--",previewProperty:"nickName",dataSaveId:o.dataSaveId,billerDescriptionConcat:o.submitFieldValueMap.billerDescriptionConcat?o.submitFieldValueMap.billerDescriptionConcat:"--",categoryDescriptionConcat:o.submitFieldValueMap.categoryDescriptionConcat?o.submitFieldValueMap.categoryDescriptionConcat:"--"});return t}}loadList(e,t){this.returnFavPayee(e,t)}onChangeItem(e){this.logger.log("FAV PAYEE #####",e),this.onFavPayeeChange.emit(e)}pupulateFavPayeeMap(){let e={},t={},o={},s={};e={key:"billerDescriptionConcat",value:"",isEdit:!1},t={key:"categoryDescriptionConcat",value:"",isEdit:!1},o={key:"billerAccount",value:"",isEdit:!1},s={key:"title",value:"nickName",isEdit:!1},this.labelValuesMap.set("biller_key",e),this.labelValuesMap.set("category_key",t),this.labelValuesMap.set("reference_key",o),this.headerMap.set("title",s)}reset(){this.complexLookupComponentObj.resetLookUp()}}return e.\u0275fac=function(t){return new(t||e)(f.Rb(_.a),f.Rb(k.a),f.Rb(m.a),f.Rb(l.a))},e.\u0275cmp=f.Lb({type:e,selectors:[["ps-lookup-fav-payee"]],viewQuery:function(e,t){if(1&e&&f.Wc(I,1),2&e){let e;f.Bc(e=f.gc())&&(t.complexLookupComponentObj=e.first)}},inputs:{options:"options"},outputs:{onFavPayeeChange:"onFavPayeeChange"},features:[f.Cb],decls:3,vars:2,consts:[[1,"ps-complex-fav-payee"],[3,"id","options","changeItem"],["complexLookupComponentObj",""]],template:function(e,t){1&e&&(f.Xb(0,"ps-container-complex",0),f.Xb(1,"ps-complex-lookup",1,2),f.fc("changeItem",function(e){return t.onChangeItem(e)}),f.Wb(),f.Wb()),2&e&&(f.Fb(1),f.pc("id",t.id)("options",t.complexLookupOptions))},directives:[E.a,V.a],encapsulation:2}),e})();var D=o("+BRL"),S=o("ofXK"),M=o("ibDU");const T=["favLookupComponentObj"];function B(e,t){if(1&e){const e=f.Yb();f.Xb(0,"ps-form-step",4),f.Xb(1,"ps-complex-widget-dropdowns",5),f.fc("onSecondValueChange",function(t){return f.Fc(e),f.ic().widgetCompleted(t)}),f.Wb(),f.Wb()}if(2&e){const e=f.ic();f.pc("id",e.stepperOptions.namesofSteps[0]),f.Fb(1),f.pc("options",e.widgetDropdownsOptions)}}function R(e,t){if(1&e){const e=f.Yb();f.Xb(0,"ps-form-step",6),f.Xb(1,"div",7),f.Sb(2,"ps-label",8),f.Wb(),f.Xb(3,"ps-container-panel",9),f.Xb(4,"ps-lookup-own-accounts",10),f.fc("onAccountChange",function(t){return f.Fc(e),f.ic().onAccountChange(t)}),f.Wb(),f.Xb(5,"ps-complex-segment",11),f.fc("complexSegmentButtonClicked",function(t){return f.Fc(e),f.ic().onClickSegment(t)}),f.Xb(6,"ps-content-segment",12),f.Xb(7,"ps-lookup-fav-payee",13,14),f.fc("onFavPayeeChange",function(t){return f.Fc(e),f.ic().onFavPayeeChange(t)}),f.Wb(),f.Wb(),f.Xb(9,"ps-content-segment",15),f.Xb(10,"ps-input-free-text",16),f.fc("onPsChange",function(t){return f.Fc(e),f.ic().onBillerAccNumberChanged(t)}),f.Wb(),f.Wb(),f.Wb(),f.Sb(11,"ps-complex-exchange",8),f.Sb(12,"ps-input-free-text",17),f.Wb(),f.Wb()}if(2&e){const e=f.ic();f.pc("id",e.stepperOptions.namesofSteps[1]),f.Fb(2),f.pc("options",e.headerLabelOptions),f.Fb(1),f.pc("options",e.billpaymentDetailsPanelOptions),f.Fb(1),f.pc("options",e.paymentAccountListOptions),f.Fb(1),f.pc("options",e.complexSegmentOptions),f.Fb(1),f.pc("id",e.complexSegmentOptions.segmentContainerOptions.namesofSegments[0]),f.Fb(1),f.pc("options",e.favPayeeLookupOptions),f.Fb(2),f.pc("id",e.complexSegmentOptions.segmentContainerOptions.namesofSegments[1]),f.Fb(1),f.pc("options",e.billerAccNumberOptions),f.Fb(1),f.pc("options",e.complexExchangeOptions2),f.Fb(1),f.pc("options",e.purposeOptions)}}const K=function(e){return{labelKey:e}};function j(e,t){if(1&e&&(f.Xb(0,"p",25),f.Sb(1,"ps-label",8),f.Wb()),2&e){const e=f.ic(3);f.Fb(1),f.pc("options",f.sc(1,K,e.validationMsg(!0)))}}function G(e,t){if(1&e){const e=f.Yb();f.Vb(0),f.Xb(1,"ps-ag-grid",23),f.fc("onRowSelectionChange",function(t){return f.Fc(e),f.ic(2).onRowSelectionChange(t)}),f.Wb(),f.Pc(2,j,2,3,"p",24),f.Ub()}if(2&e){const e=f.ic(2);f.Fb(1),f.pc("options",e.gridOptions),f.Fb(1),f.pc("ngIf",e.showErrorMsg)}}function U(e,t){if(1&e&&(f.Xb(0,"ps-form-step",18),f.Xb(1,"ps-container-panel",19),f.Pc(2,G,3,2,"ng-container",20),f.Sb(3,"ps-input-free-text",8),f.Sb(4,"ps-input-free-text",8),f.Sb(5,"ps-label",21),f.Sb(6,"ps-complex-exchange",22),f.Wb(),f.Wb()),2&e){const e=f.ic();f.pc("id",e.stepperOptions.namesofSteps[2]),f.Fb(1),f.pc("options",e.billpaymentGridPanelOptions),f.Fb(1),f.pc("ngIf",e.showGrid),f.Fb(1),f.pc("options",e.labelChargesOptions),f.Fb(1),f.pc("options",e.labelTAmountOptions),f.Fb(1),f.pc("options",e.amountInfoHintOptions),f.Fb(1),f.pc("options",e.complexExchangeOptions)}}let q=(()=>{class e extends b.OmniBasePage{constructor(e,t){super(),this.navService=e,this.omniPull=t,this.formGroup=new i.f({}),this.billPaymentVO={},this.selectedBillsRows=[],this.showErrorMsg=!1,this.invalidBills=[],this.isStep2ComplexComponentEnabled=!1,this.isNewRequest=!1,this.isFromFavManagement=!1,this.stepperOptions={stepperName:"bill_payment_stepper",isHorizontalStepper:!0,numberOfSteps:3,namesofSteps:["bill_payment_step1","bill_payment_step2","bill_payment_step3"],group:this.formGroup,submitOptions:{extraParams:{},submitServiceUrl:u.a.serviceUrl.integratedBillPaymentEndPoint,group:this.formGroup,preCallFunction:{func(e){return new Promise((t,o)=>{t(this.executionClass.handleSubmitRequest(e))})},params:[this],executionClass:this}},requestObject:this.billPaymentVO},this.billpaymentDetailsPanelOptions={isExpandable:!0,labelKey:"bill_payment_details_key",iconName:"document",expanded:!0},this.widgetDropdownsOptions={group:this.formGroup,requestObject:this.billPaymentVO,dropdowns:[{group:this.formGroup,fcName:"category",labelKey:"category_key",asyncURL:u.a.serviceUrl.billTypeListEndPoint,mapResponseProperties:{itemValue:"ctsBillTypeId",description:"refFieldType",iconName:"refFieldType"},enablePagination:!1,listOfOptions:[],requestObject:this.billPaymentVO},{group:this.formGroup,fcName:"biller",labelKey:"biller_key",asyncURL:u.a.serviceUrl.billersListEndPoint,mapResponseProperties:{itemValue:"billerCode",description:"cifBillerName",iconName:"providerImage"},enablePagination:!1,listOfOptions:[],requestObject:this.billPaymentVO}]},this.headerLabelOptions={translate:!1},this.billerAccNumberOptions={placeHolder:"enter_reference_number_key",labelKey:"reference_number_key",group:this.formGroup,fcName:"billerAccount"},this.toOtherKey="to_other_key",this.toFavoriteKey="to_fav_payee_key",this.complexSegmentOptions={group:this.formGroup,segmentOptions:{group:this.formGroup,fcName:"segmentBillPay",segmentList:[{selected:!0,itemValue:this.toFavoriteKey,description:this.commonProv.translate(this.toFavoriteKey)},{selected:!0,itemValue:this.toOtherKey,description:this.commonProv.translate(this.toOtherKey)}]},segmentContainerOptions:{numberOfSegments:2,namesofSegments:["fav_payee_segment","other_segment"]}},this.paymentAccountListOptions={labelKey:"from_account_key",placeHolder:"select_from_account_key",component:c.a,currency:"USD",group:this.formGroup,accountAllowedCurrencies:[],accountAllowedTypes:[],glTypes:"G",fcName:"fromAccount",accountType:"G",fromTo:"from",requestObject:this.billPaymentVO},this.complexExchangeOptions2={editableMode:!1,showToCurrencyOptions:!1,fromAmountOptions:{currency:"",currenciesOptions:{placeHolder:"currency_key",labelKey:"currency_key",fcName:"fromAccountCurrency2",group:this.formGroup},amountOptions:{labelKey:"bill_amount_key",placeHolder:"bill_amount_key",fcName:"transactionAmount2",group:this.formGroup,decimalPoints:2}},toAmountOptions:{currency:"",currenciesOptions:{placeHolder:"currency_key",labelKey:"currency_key",fcName:"currency2",group:this.formGroup},amountOptions:{labelKey:"exchanged_amount_key",placeHolder:"enter_exchanged_amount_key",fcName:"toAmount2",group:this.formGroup,decimalPoints:2}},requestObject:this.billPaymentVO,group:this.formGroup},this.complexExchangeOptions={editableMode:!1,showToCurrencyOptions:!0,fromAmountOptions:{currency:"",currenciesOptions:{placeHolder:"currency_key",labelKey:"currency_key",fcName:"fromAccountCurrency",group:this.formGroup},amountOptions:{labelKey:"bill_amount_key",placeHolder:"bill_amount_key",fcName:"transactionAmount",group:this.formGroup,decimalPoints:2}},toAmountOptions:{currency:"",currenciesOptions:{placeHolder:"currency_key",labelKey:"currency_key",fcName:"currency",group:this.formGroup},amountOptions:{labelKey:"exchanged_amount_key",placeHolder:"enter_exchanged_amount_key",fcName:"toAmount",group:this.formGroup,decimalPoints:2}},requestObject:this.billPaymentVO,group:this.formGroup},this.purposeOptions={labelKey:"purpose_key",placeHolder:"enter_purpose_key",fcName:"purpose",group:this.formGroup},this.favPayeeLookupOptions={fcName:"favPayee",group:this.formGroup,labelKey:"favorite_key",placeHolder:"select_favorite_key",requestObject:this.billPaymentVO,component:p.a},this.gridOptions={group:this.formGroup,labelKey:"due_bills_key",fcName:"multiSelectGrid",gridOptions:{url:"rest/omniCorePull/returnBillsList",urlParams:{},defaultColDef:{flex:1,minWidth:180,sortable:!1,resizable:!0},rowSelection:"multiple",applyPagination:!1,paginationPageSize:-1,cacheBlockSize:1,cacheOverflowSize:10,maxConcurrentDatasourceRequests:2,infiniteInitialRowCount:500,maxBlocksInCache:200},enableEdit:!0,disableAddNew:!0,enableDelete:!1,enableSort:!1,enableFilter:!1,checkboxSelection:!0,columnComponents:[{columnNameKey:"bill_date_key",propertyName:"BILL_DATE",component:r.a,componentOptions:{},componentType:"date",editable:!1},{columnNameKey:"bill_number_key",propertyName:"BILL_NUMBER",component:h.a,componentOptions:{},componentType:"input",editable:!1},{columnNameKey:"product_key",propertyName:"PRODUCT",component:h.a,componentOptions:{},componentType:"input",editable:!1},{columnNameKey:"charges_key",propertyName:"CHARGES",component:a.a,componentOptions:{},componentType:"number",editable:!1},{columnNameKey:"bill_amount_key",propertyName:"BILL_AMOUNT",component:a.a,componentOptions:{},componentType:"number",editable:!0,onPsChange:e=>{console.log("GTest: amount value",e),this.onRowSelectionChange(e)}}]},this.labelChargesOptions={placeHolder:"charges_key",labelKey:"charges_key",group:this.formGroup,fcName:"charges"},this.labelTAmountOptions={labelKey:"total_bill_amount_key",placeHolder:"total_bill_amount_key",group:this.formGroup,fcName:"totalAmount"},this.billpaymentGridPanelOptions={isExpandable:!0,labelKey:"due_bills_key",iconName:"document",expanded:!0},this.showFav=!0,this.showGrid=!1,this.nextButtonClick=0,this.amountInfoHintOptions={labelKey:"amount_info_key",position:"fixed"}}ngOnInit(){var e,t,o;super.init(),this.baseFormGroup=this.formGroup;const s=this.navService.getParamKey("navigationIndex");void 0!==s&&(this.stepperOptions.navigationStep=s),1!==(null===(e=this.commonProv.getElementValidations("bill_payment_step3"))||void 0===e?void 0:e.IS_VISIBLE)&&(this.stepperOptions.submitOptions.submitServiceUrl=u.a.serviceUrl.billPaymentEndPoint),1===(null===(t=this.commonProv.getElementValidations(this.complexExchangeOptions2.fromAmountOptions.amountOptions.fcName))||void 0===t?void 0:t.IS_VISIBLE)&&1===(null===(o=this.commonProv.getElementValidations(this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName))||void 0===o?void 0:o.IS_VISIBLE)&&(this.isStep2ComplexComponentEnabled=!0)}ionViewDidEnter(){super.ionViewDidEnter(),this.commonProv.applyDynScreenDisplay(d.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName,this.complexExchangeOptions.toAmountOptions.currenciesOptions.fcName,this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName,this.complexExchangeOptions.toAmountOptions.amountOptions.fcName,this.labelChargesOptions.fcName,this.labelTAmountOptions.fcName],1),this.isStep2ComplexComponentEnabled&&(this.commonProv.applyDynScreenDisplay(d.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName],1),this.commonProv.applyDynScreenDisplay(d.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions2.toAmountOptions.currenciesOptions.fcName],1),this.commonProv.applyDynScreenDisplay(d.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions2.toAmountOptions.amountOptions.fcName],1),Object.keys(this.billPaymentVO).length>0&&(u.a.isMaker||u.a.isChecker)&&this.updateStep2AmountAndCurrency())}onAccountChange(e){e&&(this.selectedFromAccount=e,this.isStep2ComplexComponentEnabled?(this.commonProv.setValInsideNestedObj(this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName,e.currency.toString(),this.billPaymentVO),this.complexExchangeOptions2.fromAmountOptions.currencyCode=Number(e.currency),this.complexExchangeOptions2.toAmountOptions.currencyCode=Number(e.currency),this.commonProv.applyDynScreenDisplay(d.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName],1)):(this.prepareGridQueryParamsAndValidations(),this.billPaymentVO[this.complexExchangeOptions.toAmountOptions.amountOptions.fcName]="",this.billPaymentVO[this.complexExchangeOptions.toAmountOptions.currenciesOptions.fcName]=e.currency.toString(),this.complexExchangeOptions.toAmountOptions.currencyCode=Number(e.currency)))}showExchangeRate(){var e;null===(e=this.exchangeChild)||void 0===e||e.showToCurrency()}widgetCompleted(e){this.headerLabelOptions.labelKey=e[d.a.HEADER_LABEL],this.favPayeeLookupOptions.queryParams={biller:e[this.widgetDropdownsOptions.dropdowns[1].fcName]},this.stepperOptions.stepperInstance.next.onNextClicked(e)}ngAfterViewInit(){const e=this.commonProv.session.getValueOf(d.a.preLoginResponse);this.isFromFavManagement=!(!this.billPaymentVO.dataSaveId||!this.billPaymentVO[this.favPayeeLookupOptions.fcName]),this.isNewRequest=!(null==this.billPaymentVO||!O.a.isEmptyObject(this.billPaymentVO)),e.companySettingsCO&&(this.baseCurrency=e.companySettingsCO.briefDesc,this.currencyCode=e.companySettingsCO.baseCurrency,this.commonProv.setValInsideNestedObj(this.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName,this.currencyCode.toString(),this.billPaymentVO),this.complexExchangeOptions.fromAmountOptions.currencyCode=Number(this.currencyCode),this.commonProv.applyDynScreenDisplay(d.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName],1),this.commonProv.applyDynScreenDisplay(d.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName],1))}onClickSegment(e){var t;this.showFav=!this.showFav,e===this.toFavoriteKey&&this.billPaymentVO[this.billerAccNumberOptions.fcName]?this.commonProv.setValInsideNestedObj(this.billerAccNumberOptions.fcName,null,this.billPaymentVO):this.billPaymentVO[this.favPayeeLookupOptions.fcName]&&(null===(t=this.favLookupComponentObj)||void 0===t||t.reset()),this.commonProv.applyDynScreenDisplay(d.a.ACTION_TYPE_MANDATORY,[this.favPayeeLookupOptions.fcName,this.favPayeeLookupOptions.fcName+"_lookupKey"],e===this.toFavoriteKey?1:0)}onRowSelectionChange(e){var t;return Object(s.b)(this,void 0,void 0,function*(){this.billCharges=0,this.billTotalAmount=0;const o=this.selectedBillsRows.filter(t=>{var o;if(t.rowIndex===((null===(o=e.rowNode)||void 0===o?void 0:o.data.rowIndex)||e.rowIndex))return t.BILL_AMOUNT=e.newValue||t.BILL_AMOUNT,t.selected=e.selected,this.validateBillAmount(t),t});if(0===o.length&&(e.selected||(null===(t=e.rowNode)||void 0===t?void 0:t.selected)))this.selectedBillsRows.push(e),this.validateBillAmount(e);else{const t=this.selectedBillsRows.findIndex(t=>t.rowIndex==e.rowIndex);-1!=t&&this.selectedBillsRows.splice(t,1)}if(e.newValue&&0!=e.newValue){const t={commonParametersList:{fromAccount:this.selectedFromAccount,trxAmount:e.newValue}};this.commonProv.presentLoading();const s=yield this.omniPull.returnChargesDetails(t).catch(e=>{this.commonProv.logger.error("something went wrong",e),this.commonProv.dismissLoading()});s&&(this.commonProv.applyDynScreenDisplay(d.a.ACTION_TYPE_VALUE,["CHARGES-"+e.rowIndex],s.totalCharge),this.selectedBillsRows.filter(e=>{var t;return e.BILL_NUMBER==(null===(t=o[0])||void 0===t?void 0:t.BILL_NUMBER)})[0]&&(this.selectedBillsRows.filter(e=>{var t;return e.BILL_NUMBER==(null===(t=o[0])||void 0===t?void 0:t.BILL_NUMBER)})[0].CHARGES=s.totalCharge||0)),this.commonProv.dismissLoading()}this.selectedBillsRows.forEach(e=>{e.selected&&e.BILL_AMOUNT>0&&(this.billCharges+=Number(this.commonProv.valFromNestedObj("CHARGES",e)),this.billTotalAmount+=Number(this.commonProv.valFromNestedObj("BILL_AMOUNT",e)))}),u.a.isChecker||this.setChargesAmount(this.billCharges,this.billTotalAmount)})}setChargesAmount(e,t){const o=void 0!==t?t+e:0;this.commonProv.setValInsideNestedObj(this.labelChargesOptions.fcName,e,this.billPaymentVO),this.commonProv.setValInsideNestedObj(this.labelTAmountOptions.fcName,t,this.billPaymentVO),this.commonProv.setValInsideNestedObj(this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName,o,this.billPaymentVO)}showGridValidation(e){this.nextButtonClick=this.nextButtonClick+1,this.checkGridControlsValidity(this.formGroup.controls[this.gridOptions.fcName])?this.validationMsg(!1):this.validationMsg(this.nextButtonClick>2&&e._selectedIndex>=2),2===e._selectedIndex&&(this.isStep2ComplexComponentEnabled||setTimeout(()=>{this.showExchangeRate()},500))}custGridValidator(){return e=>this.checkGridControlsValidity(e)?(this.validationMsg(!1),null):(this.validationMsg(null!=e.value&&!e.value.some(e=>""===e.BILL_NUMBER)),{"equal or less than 0":!0})}checkGridControlsValidity(e){return!(0==this.selectedBillsRows.length||this.selectedBillsRows.some(e=>0==e.BILL_AMOUNT)||1==this.selectedBillsRows.length&&this.selectedBillsRows.some(e=>0==e.selected))}validationMsg(e){return this.showErrorMsg=e,this.invalidBills.length>0?this.commonProv.translate("kindly_to_enter_a_valid_amount_for_bills_key")+": "+this.invalidBills.filter(e=>void 0!==e).join(","):0==this.selectedBillsRows.length||1==this.selectedBillsRows.length&&this.selectedBillsRows.some(e=>0==e.selected)?this.commonProv.translate("value_is_missing_key"):""}handleSubmitRequest(){this.billPaymentVO&&!O.a.isEmptyObject(this.billPaymentVO)&&u.a.isMaker&&this.isFromFavManagement&&this.billPaymentVO.dataSaveId===this.billPaymentVO[this.favPayeeLookupOptions.fcName].dataSaveId&&delete this.billPaymentVO.dataSaveId,this.isStep2ComplexComponentEnabled?(this.billPaymentVO.submitType=1,this.billPaymentVO[this.complexExchangeOptions2.fromAmountOptions.amountOptions.fcName]&&(this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName]=this.billPaymentVO[this.complexExchangeOptions2.fromAmountOptions.amountOptions.fcName],delete this.billPaymentVO[this.complexExchangeOptions2.fromAmountOptions.amountOptions.fcName]),null!=this.billPaymentVO[this.complexExchangeOptions2.toAmountOptions.amountOptions.fcName]&&this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName]&&(this.billPaymentVO[this.complexExchangeOptions.toAmountOptions.amountOptions.fcName]=this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName],delete this.billPaymentVO[this.complexExchangeOptions2.toAmountOptions.amountOptions.fcName]),this.billPaymentVO[this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName]&&(this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName]=this.billPaymentVO[this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName],this.billPaymentVO[this.complexExchangeOptions.toAmountOptions.currenciesOptions.fcName]=this.billPaymentVO[this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName],delete this.billPaymentVO[this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName]),this.billPaymentVO[this.complexExchangeOptions2.toAmountOptions.currenciesOptions.fcName]&&delete this.billPaymentVO[this.complexExchangeOptions2.toAmountOptions.currenciesOptions.fcName]):(delete this.billPaymentVO.gridValue,this.billPaymentVO.submitType=3)}validateBillAmount(e){e.selected&&(e.BILL_AMOUNT>0?this.invalidBills.forEach((t,o)=>{t===e.BILL_NUMBER&&this.invalidBills.splice(o,1)}):!this.invalidBills.some(t=>t===e.BILL_NUMBER)&&this.invalidBills.push(e.BILL_NUMBER))}onFavPayeeChange(e){e&&this.assignSelectedToAccount(e)}onBillerAccNumberChanged(e){e&&this.assignSelectedToAccount({billerAccount:e.newValue})}assignSelectedToAccount(e){this.selectedToAccount=e,this.prepareGridQueryParamsAndValidations()}prepareGridQueryParamsAndValidations(){this.showGrid=!1,this.selectedFromAccount&&this.selectedToAccount&&(this.gridOptions.gridOptions.urlParams={submitType:2,commonParametersList:{fromAccount:this.selectedFromAccount,toAccount:this.selectedToAccount,billerId:this.formGroup.controls[this.widgetDropdownsOptions.dropdowns[1].fcName].value,toFav:this.showFav}},this.commonProv.presentLoading(),setTimeout(()=>{this.showGrid=!0,this.commonProv.addDefaultValidator(this.formGroup,this.gridOptions.fcName,this.commonProv.prepareValidation(!1,null,null,null,null,null,null,null,[this.custGridValidator()])),this.commonProv.dismissLoading()},1e3))}updateStep2AmountAndCurrency(){if(!this.isFromFavManagement&&!this.isNewRequest&&(null!=this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName]&&null!=this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName]&&this.commonProv.setValInsideNestedObj(this.complexExchangeOptions2.fromAmountOptions.amountOptions.fcName,this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName],this.billPaymentVO),null!=this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName]&&null!=this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName])){const e=this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName];this.commonProv.setValInsideNestedObj(this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName,e,this.billPaymentVO),this.commonProv.setValInsideNestedObj(this.complexExchangeOptions2.toAmountOptions.currenciesOptions.fcName,e,this.billPaymentVO)}}}return e.\u0275fac=function(t){return new(t||e)(f.Rb(l.a),f.Rb(m.a))},e.\u0275cmp=f.Lb({type:e,selectors:[["bill-payment"]],viewQuery:function(e,t){if(1&e&&(f.Wc(n.a,1),f.Wc(T,1)),2&e){let e;f.Bc(e=f.gc())&&(t.exchangeChild=e.first),f.Bc(e=f.gc())&&(t.favLookupComponentObj=e.first)}},features:[f.Cb],decls:4,vars:5,consts:[[3,"options","id","onNextPreviousStepper"],["step1","",3,"id",4,"psStep"],["step2","",3,"id",4,"psStep"],["step3","",3,"id",4,"psStep"],["step1","",3,"id"],["id","category_biller_widgets",3,"options","onSecondValueChange"],["step2","",3,"id"],[1,"category_biller_header"],[3,"options"],["id","bill_payment_details_panel",3,"options"],["id","payment_account_list",3,"options","onAccountChange"],["id","billPaymentSegment",1,"biller-type-select-segment",3,"options","complexSegmentButtonClicked"],["segment1","",3,"id"],[3,"options","onFavPayeeChange"],["favLookupComponentObj",""],["segment2","",3,"id"],["id","biller_account_number",3,"options","onPsChange"],["id","payment_purpose",3,"options"],["step3","",3,"id"],["id","bill_payment_grid_panel",3,"options"],[4,"ngIf"],[1,"amount-info",3,"options"],["id","exchange",3,"options"],[1,"onboarding_toggles",3,"options","onRowSelectionChange"],["class","validation-message requested-product",4,"ngIf"],[1,"validation-message","requested-product"]],template:function(e,t){1&e&&(f.Xb(0,"ps-template-stepper",0),f.fc("onNextPreviousStepper",function(e){return t.showGridValidation(e)}),f.Pc(1,B,2,2,"ps-form-step",1),f.Pc(2,R,13,11,"ps-form-step",2),f.Pc(3,U,7,7,"ps-form-step",3),f.Wb()),2&e&&(f.pc("options",t.stepperOptions)("id",t.stepperOptions.stepperName),f.Fb(1),f.pc("psStep","step1"),f.Fb(1),f.pc("psStep","step2"),f.Fb(1),f.pc("psStep","step3"))},directives:[y.a,g.a,P.a,w.a,v.a,x.a,C.a,N.a,A.a,F,D.a,n.a,S.o,M.a],encapsulation:2}),e})()},Sx1r:function(e,t,o){"use strict";o.d(t,"a",function(){return w});var s=o("mrSG"),i=o("fXoL"),n=o("ZF3V"),p=o("DFXC"),a=o("zngb"),l=o("Q0Ba"),c=o("TEn/"),r=o("Isd1"),u=o("ofXK"),m=o("KVmc"),h=o("ilDp"),d=o("qNfM"),b=o("BqtM");function O(e,t){if(1&e){const e=i.Yb();i.Xb(0,"div",8),i.Xb(1,"ps-action-icon",9),i.fc("onClick",function(){return i.Fc(e),i.ic(2).onBackIconClicked()}),i.Wb(),i.Wb()}if(2&e){const e=i.ic(2);i.Fb(1),i.pc("options",e.backIconOptions)}}const f=function(e,t){return[e,t]};function y(e,t){if(1&e){const e=i.Yb();i.Vb(0),i.Xb(1,"ps-select-dropdown-widget",10),i.fc("onPsChange",function(t){return i.Fc(e),i.ic(2).onItemSelected(t)}),i.Wb(),i.Ub()}if(2&e){const e=t.$implicit,o=t.index;i.Fb(1),i.pc("options",e)("ngClass",i.tc(2,f,e&&e.psClass?e.psClass:"","level-"+o))}}function g(e,t){if(1&e&&(i.Vb(0),i.Xb(1,"div",3),i.Pc(2,O,2,1,"div",4),i.Xb(3,"div",5),i.Sb(4,"ps-label",6),i.Wb(),i.Wb(),i.Pc(5,y,2,5,"ng-container",7),i.Ub()),2&e){const e=i.ic();i.Fb(2),i.pc("ngIf",e.showIcon),i.Fb(2),i.pc("options",e.headerLabelOptions),i.Fb(1),i.pc("ngForOf",e.options.dropdowns)}}function P(e,t){if(1&e&&(i.Xb(0,"p",11),i.Rc(1),i.jc(2,"translate"),i.Wb()),2&e){const e=i.ic();i.Fb(1),i.Sc(i.kc(2,1,e.selectionErrorMessage))}}let w=(()=>{class e extends n.a{constructor(e,t,o){super(e,t),this.commonProv=e,this.loggerP=t,this.modalController=o,this.onSecondValueChange=new i.o,this.numberOfDropdowns=0,this.currentDropdownPosition=0,this.selectedItemsList=[],this.selectReportsError=!1,this.selectionErrorMessage="no_selected_reports_key",this.headerLabelOptions={},this.backIconOptions={iconName:"arrow-back"},this.backClicked=!1,this.showIcon=!1,this.isPreviouslySelected=!1}ngOnInit(){this.options.dropdowns&&this.options.dropdowns.length>0&&(this.numberOfDropdowns=this.options.dropdowns.length,this.options.dropdowns[0].renderDropdown=!0,this.currentDropdownPosition=1,this.headerLabelOptions.labelKey=this.options.dropdowns[0].labelKey)}onItemSelected(e){if(this.options.requestObject&&this.options.requestObject[this.options.dropdowns[this.currentDropdownPosition-1].fcName]&&e.itemValue===this.options.requestObject[this.options.dropdowns[this.currentDropdownPosition-1].fcName].itemValue&&this.options.dropdowns[this.currentDropdownPosition]&&this.options.dropdowns[this.currentDropdownPosition].listOfOptions&&this.options.dropdowns[this.currentDropdownPosition].listOfOptions.length>0)this.options.dropdowns.length>this.currentDropdownPosition&&(this.options.dropdowns[this.currentDropdownPosition-1].psClass="hide-dropdown",this.options.dropdowns[this.currentDropdownPosition].psClass="show-dropdown",this.currentDropdownPosition++,this.showIcon=!0);else if(this.options.dropdowns.length>1||1==this.options.dropdowns.length&&this.options.dropdowns[0].asyncURL)this.isPreviouslySelected=!(!this.options.requestObject[this.options.dropdowns[this.currentDropdownPosition-1].fcName]||!this.options.requestObject[a.a.HEADER_LABEL]),this.commonProv.setValInsideNestedObj(this.options.dropdowns[this.currentDropdownPosition-1].fcName,e,this.options.requestObject),this.options.dropdowns.length>this.currentDropdownPosition?(this.backClicked&&(this.commonProv.setValInsideNestedObj(this.options.dropdowns[this.currentDropdownPosition].fcName,null,this.options.requestObject),this.options.dropdowns[this.currentDropdownPosition].renderDropdown=!1,this.options.dropdowns[this.currentDropdownPosition]={group:this.options.dropdowns[this.currentDropdownPosition].group,fcName:this.options.dropdowns[this.currentDropdownPosition].fcName,labelKey:this.options.dropdowns[this.currentDropdownPosition].labelKey,asyncURL:this.options.dropdowns[this.currentDropdownPosition].asyncURL,mapResponseProperties:this.options.dropdowns[this.currentDropdownPosition].mapResponseProperties,enablePagination:this.options.dropdowns[this.currentDropdownPosition].enablePagination,listOfOptions:[],componentInstance:this.options.dropdowns[this.currentDropdownPosition].componentInstance},this.headerLabelOptions.labelKey=this.options.dropdowns[this.currentDropdownPosition-1].labelKey),this.options.dropdowns[this.currentDropdownPosition].serviceRequestObj?this.options.dropdowns[this.currentDropdownPosition].serviceRequestObj.commonParametersList=e.selectedObj:this.options.dropdowns[this.currentDropdownPosition].serviceRequestObj={commonParametersList:e.selectedObj},this.options.dropdowns[this.currentDropdownPosition].renderDropdown=!0,this.options.dropdowns[this.currentDropdownPosition-1].psClass="hide-dropdown",-1!==this.headerLabelOptions.labelKey.indexOf("-")?(this.headerLabelOptions.labelKey=this.headerLabelOptions.labelKey.slice(0,this.headerLabelOptions.labelKey.lastIndexOf("-")+1),this.headerLabelOptions.labelKey.replace(this.commonProv.translate(this.options.dropdowns[this.currentDropdownPosition-1].fcName),e.description),this.headerLabelOptions.labelKey.endsWith("-")&&(this.headerLabelOptions.labelKey=this.headerLabelOptions.labelKey.slice(0,-1)),this.headerLabelOptions.labelKey+=" - "+this.options.dropdowns[this.currentDropdownPosition].fcName):(this.headerLabelOptions.labelKey=e.description,this.headerLabelOptions.labelKey+=" - "+this.options.dropdowns[this.currentDropdownPosition].fcName),this.showIcon=!0,this.currentDropdownPosition++,this.options.group.controls[this.options.dropdowns[this.currentDropdownPosition-1].fcName].reset(),this.options.dropdowns[this.currentDropdownPosition-1].componentInstance.callService()):this.options.dropdowns.length===this.currentDropdownPosition&&(this.headerLabelOptions.labelKey=this.headerLabelOptions.labelKey.slice(0,this.isPreviouslySelected?this.headerLabelOptions.labelKey.indexOf("-")+1:this.headerLabelOptions.labelKey.lastIndexOf("-")+1),this.headerLabelOptions.labelKey+=e.description,this.options.requestObject[a.a.HEADER_LABEL]=this.headerLabelOptions.labelKey,this.common.presentLoading(),setTimeout(()=>{this.onSecondValueChange.emit(this.options.requestObject),this.common.dismissLoading()},500),this.showDescriptionModal(e));else if(1==this.options.dropdowns.length&&!this.options.dropdowns[0].asyncURL){let t=!1;this.selectReportsError=!1;const o=this.options.dropdowns[0].fcName;this.selectedItemsList.forEach((o,s)=>{o.itemValue==e.itemValue&&(t=!0,o.selected=!1,this.selectedItemsList.splice(s,1))}),t||this.selectedItemsList.push(e),0==this.selectedItemsList.length&&(this.selectReportsError=!0,this.options.group.controls[o].setValue([]),this.options.group.get(o).setValue([])),this.selectedItemsList.forEach(e=>{e.selected=!0}),this.options.group.controls[o].setValue(this.selectedItemsList),this.options.group.get(o).setValue(this.selectedItemsList),this.commonProv.setValInsideNestedObj(this.options.dropdowns[0].fcName,this.selectedItemsList,this.options.requestObject)}}showDescriptionModal(e){return Object(s.b)(this,void 0,void 0,function*(){if(this.options.detailsObject){const t=this.options.detailsObject.detailsModalId,o=yield this.modalController.create({component:this.options.detailsObject.detailsModal,componentProps:{data:Object.assign({},e.selectedObj),actions:this.options.detailsObject.detailsActionsList},cssClass:this.options.detailsObject.detailsModalClass,animated:!1,id:t});yield o.present()}})}onBackIconClicked(){this.backClicked=!0,this.options.group.controls[this.options.dropdowns[this.currentDropdownPosition-1].fcName].invalid&&this.options.group.controls[this.options.dropdowns[this.currentDropdownPosition-1].fcName].reset(),this.options.dropdowns[this.currentDropdownPosition-1].psClass="hide-dropdown",this.options.dropdowns[this.currentDropdownPosition-2].psClass="show-dropdown",this.currentDropdownPosition--,1===this.currentDropdownPosition&&(this.showIcon=!1)}resetSelections(){const e=this.options.dropdowns[0].fcName;this.selectedItemsList.forEach(e=>{e.selected=!1}),this.selectedItemsList=[],this.options.group.controls[e].setValue([]),this.options.group.get(e).setValue(this.selectedItemsList),this.commonProv.setValInsideNestedObj(this.options.dropdowns[0].fcName,this.selectedItemsList,this.options.requestObject),this.selectReportsError=!0}}return e.\u0275fac=function(t){return new(t||e)(i.Rb(l.a),i.Rb(p.a),i.Rb(c.N))},e.\u0275cmp=i.Lb({type:e,selectors:[["ps-complex-widget-dropdowns"]],inputs:{options:"options"},outputs:{onSecondValueChange:"onSecondValueChange"},features:[i.Cb],decls:3,vars:2,consts:[[1,"ps-complex-widget-dropdowns"],[4,"ngIf"],["class","select-documents-validation-message",4,"ngIf"],[1,"ps-complex-widget-dropdowns_header"],["class","ps-complex-widget-dropdowns_header-back",4,"ngIf"],[1,"ps-complex-widget-dropdowns_header-label"],[3,"options"],[4,"ngFor","ngForOf"],[1,"ps-complex-widget-dropdowns_header-back"],[3,"options","onClick"],[3,"options","ngClass","onPsChange"],[1,"select-documents-validation-message"]],template:function(e,t){1&e&&(i.Xb(0,"ps-container-complex",0),i.Pc(1,g,6,3,"ng-container",1),i.Pc(2,P,3,3,"p",2),i.Wb()),2&e&&(i.Fb(1),i.pc("ngIf",(null==t.options?null:t.options.dropdowns.length)>0),i.Fb(1),i.pc("ngIf",t.selectReportsError))},directives:[r.a,u.o,m.a,u.n,h.a,d.a,u.m],pipes:[b.a],encapsulation:2}),e})()},VEWP:function(e,t,o){"use strict";o.d(t,"a",function(){return O});var s=o("mrSG"),i=o("fXoL"),n=o("4lGw"),p=o("V0Fi"),a=o("ZyuK"),l=o("ZF3V"),c=o("EIUR"),r=o("DFXC"),u=o("zngb"),m=o("Q0Ba"),h=o("Isd1"),d=o("L0og");const b=["complexLookupComponentObj"];let O=(()=>{class e extends l.a{constructor(e,t,o,s){super(e,t),this.commonService=e,this.omniPull=o,this.accountsService=s,this.options={fromTo:"",requestObject:null},this.complexLookupOptions={requestObject:null,notFoundMessage:"no_valid_account_found_key",multiple:!!this.options.multiple&&this.options.multiple},this.onAccountChange=new i.o,this.onAccountDeleted=new i.o,this.labelValuesMap=new Map,this.psCurrency=new c.a,this.labelOptions={},this.allType=!1}ngOnInit(){this.loadAccounts(null),this.complexLookupOptions.labelKey=this.options.labelKey,this.complexLookupOptions.title="title_key",this.complexLookupOptions.subTitle="sub_title_key",this.complexLookupOptions.labelsValueMap=this.labelValuesMap,this.allType=!!this.options.allType&&this.options.allType,this.commonProv.copyObject(this.complexLookupOptions,this.options,!1),this.complexLookupOptions.requestObject=this.options.requestObject}ngOnChanges(e){this.complexLookupOptions.labelKey=this.options.labelKey,this.complexLookupOptions.placeHolder=this.options.placeHolder}loadAccounts(e){return Object(s.b)(this,void 0,void 0,function*(){if(null!=e&&(this.options=e),this.options.listOfAccounts=[],void 0===this.options.fromTo||""===this.options.fromTo)return void this.logger.error("lookup_from_to_missing_key");const t=this.commonService.session.getValueOf(u.a.USERINFO),o=this.prepareRequestData(t);this.returnAccountList(o)})}returnAccountList(e){return Object(s.b)(this,void 0,void 0,function*(){const t=this.commonProv.session.getValueOf(p.a.PERSONALIZATION_CO);this.complexLookupOptions.listOfOptions=void 0;const o=yield this.omniPull.returnAccounts(e).catch(e=>{this.complexLookupOptions.listOfOptions=[],this.logger.error("Error: While fetching accounts in PsComplexOwnAccountComponent :",e)});if(o&&o.gridModel.length>0){if(this.allType){e.accountType="F",e.permittedGls="F";const t=yield this.omniPull.returnAccounts(e).catch(e=>{this.logger.error("Error: While fetching accounts in PsComplexOwnAccountComponent :",e)});t&&t.gridModel.length>0&&(o.gridModel=[...o.gridModel,...t.gridModel])}if(this.options.listOfAccounts=o.gridModel,this.options.accountNumber&&""!==this.options.accountNumber&&(this.complexLookupOptions.listOfOptions=this.options.listOfAccounts.filter(e=>e.accountNumber!==this.options.accountNumber)),this.options.currency&&""!==this.options.currency&&(this.complexLookupOptions.listOfOptions=this.fetchAccountBasedOnCurrency(this.options.currency),this.options.accountNumber&&""!==this.options.accountNumber&&(this.complexLookupOptions.listOfOptions=this.options.listOfAccounts.filter(e=>e.accountNumber!==this.options.accountNumber))),null!=this.options.accountNumber&&""!==this.options.accountNumber||(this.complexLookupOptions.listOfOptions=this.options.listOfAccounts),this.complexLookupOptions.listOfOptions=this.populateCustomAccounts(this.complexLookupOptions.listOfOptions),this.complexLookupOptions.listOfOptions.map((e,t)=>e.rowIndex=t),this.allAccounts=Object.assign([],this.complexLookupOptions.listOfOptions),null==this.complexLookupOptions.selectedItems&&(this.complexLookupOptions.selectedItems=[]),this.complexLookupOptions.multiple&&this.handleMultipleSelection(),!this.options.requestObject[this.options.fcName]&&(this.options.defaultByPersonalizedAcc=null==this.options.defaultByPersonalizedAcc||this.options.defaultByPersonalizedAcc,"from"===this.options.fromTo&&this.options.defaultByPersonalizedAcc)){let e="QR"===this.options.purpose?null==t?void 0:t.defaultQrPaymentAccKey:null==t?void 0:t.defaultTransferAccKey;this.complexLookupOptions.listOfOptions.map(t=>{t.personalizeKey&&t.personalizeKey===e&&(this.common.setValInsideNestedObj(this.options.fcName,t.lookupKey,this.options.requestObject),this.common.setValInsideNestedObj(this.options.fcName+"_lookupKey",t.lookupKey,this.options.requestObject))})}}else this.listOfAccounts=[],this.complexLookupOptions.listOfOptions=[]})}populateCustomAccounts(e){const t=[];for(const o of e){const e={briefNameEnglish:o.briefNameEnglish,cifShortNameEnglish:o.cifShortNameEnglish,accountNumber:o.accountNumber,balance:this.psCurrency.transform(null==o.balance?"0.0":o.balance,o.currencyDecimalPoints)+" "+(o.currencyBriefName||o.currencyBriefNameEnglish),availableBalance:this.psCurrency.transform(null==o.availableBalance?"0.0":o.availableBalance,o.currencyDecimalPoints)+" "+(o.currencyBriefName||o.currencyBriefNameEnglish),currencyBriefName:o.currencyBriefName||o.currencyBriefNameEnglish,currencyBriefNameEnglish:o.currencyBriefNameEnglish,currency:o.currency,accountTypeDesc:o.accountTypeDesc,additionalRef:o.additionalRef,ibanAccNo:o.ibanAccNo,accGl:o.accGl,serialNo:o.serialNo,branch:o.branch,cif:o.cif,formattedAccount:this.accountsService.returnFormattedAccount(o).formattedAccount,personalizeKey:o.personalizeKey,nickName:o.nickName,briefName:o.briefName,lookupKey:o.additionalRef,branchDescription:o.branchDescription?o.branchDescription:"",generalLedgerBriefNameEng:o.generalLedgerBriefNameEng?o.generalLedgerBriefNameEng:"",previewProperty:"accountNumber",status:o.statusDescription,statusCode:o.status,accountFormat:this.accountsService.returnFormattedAccount(o).accountFormat};this.options.multiple&&(e.excludeType=o.excludeType),t.push(e)}return t}prepareRequestData(e){let t={};if(e&&e.omniUserVO&&(t={userCifNo:e.omniUserVO.CIF_NO,type:"A"}),null!=this.options.queryParams&&void 0!==this.options.queryParams&&""!==this.options.queryParams&&(t={commonParametersList:this.options.queryParams}),null!=this.options.accountType&&void 0!==this.options.accountType&&""!==this.options.accountType&&(t.accountType=this.options.accountType),null!=this.options.glTypes&&void 0!==this.options.glTypes&&""!==this.options.glTypes&&(t.permittedGls=this.options.glTypes),null!=this.options.fromTo&&""!==this.options.fromTo&&(t.fromTo=this.options.fromTo),null!=this.options.endUserId&&""!==this.options.endUserId&&(t.endUserId=this.options.endUserId),null!=this.options.fromCurrency?t.fromCurrency=this.options.fromCurrency:null!=this.options.toCurrency&&(t.toCurrency=this.options.toCurrency),null!=this.options.accountAllowedCurrencies&&void 0!==this.options.accountAllowedCurrencies)if("string"==typeof this.options.accountAllowedCurrencies)t.accountAllowedCurrencies=this.options.accountAllowedCurrencies;else{let e="";for(const t in this.options.accountAllowedCurrencies)e+=this.options.accountAllowedCurrencies[t]+",";e=e.slice(0,e.lastIndexOf(",")),t.accountAllowedCurrencies=e}if(null!=this.options.accountAllowedTypes&&void 0!==this.options.accountAllowedTypes)if("string"==typeof this.options.accountAllowedTypes)t.accountAllowedTypes=this.options.accountAllowedTypes;else{let e="";for(const t in this.options.accountAllowedTypes)e+=this.options.accountAllowedTypes[t]+",";e=e.slice(0,e.lastIndexOf(",")),t.accountAllowedTypes=e}return t}fetchAccountBasedOnCurrency(e){return this.options.listOfAccounts}onChange(e){this.logger.log(e)}populateOwnAccountMap(){let e={},t={},o={};e={key:"accountNumber",value:"--- --- --- ---",isEdit:!1},t={key:"currentBalance",value:"0.0",isEdit:!1},o={key:"availableBalance",value:"0.0",isEdit:!1},this.labelValuesMap.set("account_key",e),this.labelValuesMap.set("balance_key",t),this.labelValuesMap.set("available_balance_key",o)}onChangeItem(e){this.onAccountChange.emit(e)}onDeleteItem(e){e&&this.onAccountDeleted.emit(e)}handleMultipleSelection(){const e=this.options.setAllAccountsAsSelecetd?this.complexLookupOptions.listOfOptions:this.options.requestObject[this.options.fcName]?this.complexLookupOptions.listOfOptions.filter(e=>this.options.requestObject[this.options.fcName].some(t=>t.accountNumber==e.accountNumber)):[];this.complexLookupOptions.selectedItems=e.filter(e=>this.options.setAllAccountsAsSelecetd&&(!e.excludeType||!(e.excludeType.includes(p.a.GENERAL_ACCOUNT_EXCLUDE_TYPE)||e.excludeType.includes(p.a.TERM_ACCOUNT_EXCLUDE_TYPE)))||!this.options.setAllAccountsAsSelecetd).map(e=>Object.assign(Object.assign({item:e[e.previewProperty]},e),{itemLookup:e.lookupKey})),this.complexLookupOptions.selectedItems.length>0&&this.complexLookupComponentObj.setSelectedItems(this.complexLookupOptions.selectedItems)}removeAccount(e){e&&void 0!==this.allAccounts&&(this.complexLookupOptions.listOfOptions=this.allAccounts?this.allAccounts.filter(t=>e.accountNumber!=t.accountNumber):[])}reset(){this.complexLookupComponentObj.resetLookUp()}refreshAcounts(e){this.complexLookupOptions.listOfOptions=Object.assign([],this.allAccounts),this.removeAccount(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Rb(m.a),i.Rb(r.a),i.Rb(a.a),i.Rb(n.a))},e.\u0275cmp=i.Lb({type:e,selectors:[["ps-lookup-own-accounts"]],viewQuery:function(e,t){if(1&e&&i.Wc(b,1),2&e){let e;i.Bc(e=i.gc())&&(t.complexLookupComponentObj=e.first)}},inputs:{options:"options"},outputs:{onAccountChange:"onAccountChange",onAccountDeleted:"onAccountDeleted"},features:[i.Cb,i.Db],decls:3,vars:2,consts:[[1,"ps-complex-own-account"],[3,"id","options","changeItem","onDeleteItem"],["complexLookupComponentObj",""]],template:function(e,t){1&e&&(i.Xb(0,"ps-container-complex",0),i.Xb(1,"ps-complex-lookup",1,2),i.fc("changeItem",function(e){return t.onChangeItem(e)})("onDeleteItem",function(e){return t.onDeleteItem(e)}),i.Wb(),i.Wb()),2&e&&(i.Fb(1),i.pc("id",t.id)("options",t.complexLookupOptions))},directives:[h.a,d.a],styles:[""]}),e})()},ltde:function(e,t,o){"use strict";o.d(t,"a",function(){return u});var s=o("fXoL"),i=o("EZLY"),n=o("V0Fi"),p=o("fOh1"),a=o("ofXK"),l=o("BygU");function c(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"ps-container-lookup-option",2),s.fc("clickedCard",function(t){return s.Fc(e),s.ic(2).updateCard(t)}),s.Wb(),s.Ub()}if(2&e){const e=t.$implicit,o=s.ic(2);s.Fb(1),s.pc("id",o.id+"_opt")("options",o.getContainerLookUpOptions())("itemCard",e)}}function r(e,t){if(1&e&&(s.Vb(0),s.Pc(1,c,2,3,"ng-container",1),s.Ub()),2&e){const e=s.ic();s.Fb(1),s.pc("ngForOf",e.options.itemList)}}let u=(()=>{class e extends i.a{constructor(){super(),this.reloadFct=new s.o,this.options={},this.onClickCard=new s.o,this.labelValuesMap=new Map,this.headerMap=new Map,this.requestMap=new Map,this.editRequestMap=new Map,this.bRefresh=!1,this.postFct={func(){return new Promise((e,t)=>{e(this.executionClass.reloadList())})},executionClass:this,params:[]}}ngOnInit(){super.init(),this.pupulateFavPayeeMap(),null==this.options.showOnlyList&&(this.options.showOnlyList=!1),this.options&&this.options.listOfOptions&&(this.options.listOfOptions.map((e,t)=>e.rowIndex=t),this.options.itemList=this.options.listOfOptions)}getContainerLookUpOptions(){return this.prepareLookUp()}prepareLookUp(){let e={};return e.labelKey=this.options.labelKey,e.fcName=this.options.fcName,e.labelsValueMap=this.labelValuesMap,e.headerMap=this.headerMap,e.formGroup=this.options.group,e.isEditable=this.options.isEditable,e.itemList=this.options.itemList,e.actionDetailsOptions=[{id:"pay",label:"pay_key",actionHyperlink:{group:this.options.group,iconOptions:{iconName:"paper-plane",labelOptions:{labelKey:"pay_key"}},pageOptions:{operId:n.a.WIDGET_BILL_PAYMENTS_OPER_ID},navigationOptions:{queryParams:{navigationIndex:1}}}},{id:"delete",labelOptions:{labelKey:"delete_key"},buttonIcon:"delete",actionUrl:p.a.serviceUrl.deleteBeneficiaryEndPoint,cssClass:"fab-edit-button",label:"delete_key",iconName:"trash",actionType:"delete",alertStyle:"warning",alertType:"prompt",alertMessage:"confirm_delete_this_favorite_key",operId:n.a.DELETE_FAV_PAYEE_OPER_ID},{id:"edit",label:"edit_key",actionHyperlink:{group:this.options.group,iconOptions:{iconName:"paper",labelOptions:{labelKey:"edit_key"}},pageOptions:{operId:n.a.EDIT_FAV_PAYEE_OPER_ID}}}],e.statementOptions={},e.reloadFunction={func(){return new Promise((e,t)=>{e(this.executionClass.reloadList())})},executionClass:this,params:[]},e}reloadList(){this.reloadFct.emit()}pupulateFavPayeeMap(){let e={},t={},o={},s={};e={key:"billerDescriptionConcat",value:"",isEdit:!1},t={key:"categoryDescriptionConcat",value:"",isEdit:!1},o={key:"billerAccount",value:"",isEdit:!1},s={key:"title",value:"nickName",isEdit:!1},this.labelValuesMap.set("biller_key",e),this.labelValuesMap.set("category_key",t),this.labelValuesMap.set("reference_key",o),this.headerMap.set("title",s)}updateCard(e){e&&this.options.listOfOptions&&(this.options.itemList=this.options.listOfOptions.filter(t=>t===e),this.options.item=this.options.itemList[0],this.options.showItemPopUp=!this.options.showItemPopUp),this.onClickCard.emit(this.options)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["ps-fav-payee-list"]],inputs:{options:"options"},outputs:{reloadFct:"reloadFct",onClickCard:"onClickCard"},features:[s.Cb],decls:2,vars:1,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"id","options","itemCard","clickedCard"]],template:function(e,t){1&e&&(s.Xb(0,"ps-template-list"),s.Pc(1,r,2,1,"ng-container",0),s.Wb()),2&e&&(s.Fb(1),s.pc("ngIf",(null==t.options||null==t.options.itemList?null:t.options.itemList.length)>0))},directives:[i.a,a.o,a.n,l.a],styles:[""]}),e})()}}]);