!function(){function e(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,s=function(){};return{s:s,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw r}}}}function o(e,t){if(e){if("string"==typeof e)return n(e,t);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=Array(t);o<t;o++)n[o]=e[o];return n}function i(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,o="function"==typeof Symbol?Symbol:{},n=o.iterator||"@@iterator",r=o.toStringTag||"@@toStringTag";function a(o,n,i,r){var a=n&&n.prototype instanceof l?n:l,p=Object.create(a.prototype);return s(p,"_invoke",function(o,n,i){var s,r,a,l=0,p=i||[],u=!1,m={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,o){return s=t,r=0,a=e,m.n=o,c}};function h(o,n){for(r=o,a=n,t=0;!u&&l&&!i&&t<p.length;t++){var i,s=p[t],h=m.p,d=s[2];o>3?(i=d===n)&&(a=s[(r=s[4])?5:(r=3,3)],s[4]=s[5]=e):s[0]<=h&&((i=o<2&&h<s[1])?(r=0,m.v=n,m.n=s[1]):h<d&&(i=o<3||s[0]>n||n>d)&&(s[4]=o,s[5]=n,m.n=d,r=0))}if(i||o>1)return c;throw u=!0,n}return function(i,p,d){if(l>1)throw TypeError("Generator is already running");for(u&&1===p&&h(p,d),r=p,a=d;(t=r<2?e:a)||!u;){s||(r?r<3?(r>1&&(m.n=-1),h(r,a)):m.n=a:m.v=a);try{if(l=2,s){if(r||(i="next"),t=s[i]){if(!(t=t.call(s,a)))throw TypeError("iterator result is not an object");if(!t.done)return t;a=t.value,r<2&&(r=0)}else 1===r&&(t=s.return)&&t.call(s),r<2&&(a=TypeError("The iterator does not provide a '"+i+"' method"),r=1);s=e}else if((t=(u=m.n<0)?a:o.call(n,m))!==c)break}catch(t){s=e,r=1,a=t}finally{l=1}}return{value:t,done:u}}}(o,i,r),!0),p}var c={};function l(){}function p(){}function u(){}t=Object.getPrototypeOf;var m=[][n]?t(t([][n]())):(s(t={},n,function(){return this}),t),h=u.prototype=l.prototype=Object.create(m);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,s(e,r,"GeneratorFunction")),e.prototype=Object.create(h),e}return p.prototype=u,s(h,"constructor",u),s(u,"constructor",p),p.displayName="GeneratorFunction",s(u,r,"GeneratorFunction"),s(h),s(h,r,"Generator"),s(h,n,function(){return this}),s(h,"toString",function(){return"[object Generator]"}),(i=function(){return{w:a,m:d}})()}function s(e,t,o,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}(s=function(e,t,o,n){function r(t,o){s(e,t,function(e){return this._invoke(t,o,e)})}t?i?i(e,t,{value:o,enumerable:!n,configurable:!n,writable:!n}):e[t]=o:(r("next",0),r("throw",1),r("return",2))})(e,t,o,n)}function r(e,t,o,n){var i=a(b(1&n?e.prototype:e),t,o);return 2&n&&"function"==typeof i?function(e){return i.apply(o,e)}:i}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,o){var n=c(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:o):i.value}}).apply(null,arguments)}function c(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=b(e)););return e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}function u(e,t,o){return t&&p(e.prototype,t),o&&p(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function h(e,t,o){return t=b(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return d(e)}(e,f()?Reflect.construct(t,o||[],b(e).constructor):t.apply(e,o))}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(f=function(){return!!e})()}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}function O(e,t){return(O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{"+BRL":function(e,t,o){"use strict";o.d(t,"a",function(){return a});var n=o("DFXC"),i=o("Q0Ba"),s=o("BYmO"),r=o("fXoL"),a=function(){var e=function(e){function t(e,o){var n;return l(this,t),(n=h(this,t,[e,o])).options={},n.defaultOptions={},n}return y(t,e),u(t,[{key:"ngOnInit",value:function(){this.commonProv.copyObject(this.defaultOptions,this.options,!1)}},{key:"onInputChanged",value:function(e){this.onPsChange.emit(e)}}])}(s.a);return e.\u0275fac=function(t){return new(t||e)(r.Rb(i.a),r.Rb(n.a))},e.\u0275cmp=r.Lb({type:e,selectors:[["ps-input-free-text"]],inputs:{options:"options"},features:[r.Cb],decls:1,vars:2,consts:[[3,"id","options","onPsChange"]],template:function(e,t){1&e&&(r.Xb(0,"ps-keyin-input",0),r.fc("onPsChange",function(e){return t.onInputChanged(e)}),r.Wb()),2&e&&r.pc("id",t.id)("options",t.defaultOptions)},directives:[s.a],styles:[""]}),e}()},BcCD:function(e,t,o){"use strict";o.d(t,"a",function(){return d});var n=o("zngb"),i=o("JpVU"),s=o("DFXC"),r=o("qEF5"),a=o("Q0Ba"),c=o("ZyuK"),p=o("r40+"),m=o("fXoL"),d=function(){var e=function(e){function t(e,o,n){var i;return l(this,t),(i=h(this,t,[e,o,n])).commonProv=e,i.dateOptions={},i.omniPull=r.a.injectionHandler(c.a),i}return y(t,e),u(t,[{key:"ngOnInit",value:function(){this.commonProv.copyObject(this.dateOptions,this.options,!1);var e=this.omniPull.omniCommon.session.getValueOf(n.a.preLoginResponse).parameters;this.dateOptions.displayFormat=e.DefaultDateFormat?e.DefaultDateFormat.parameterVal:"DD/MM/YYYY",this.dateOptions.pickerFormat=this.dateOptions.displayFormat}},{key:"ngOnChanges",value:function(){this.options&&this.options.min&&(this.dateOptions.min=this.options.min),this.options&&this.options.max&&(this.dateOptions.max=this.options.max)}},{key:"dateChanged",value:function(e){this.onPsChange.emit(e)}}])}(i.a);return e.\u0275fac=function(t){return new(t||e)(m.Rb(a.a),m.Rb(s.a),m.Rb(p.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["ps-date-day-month-year"]],inputs:{options:"options"},features:[m.Cb,m.Db],decls:1,vars:2,consts:[[1,"ps-day-month-year",3,"options","id","onPsChange","onPsInit"]],template:function(e,t){1&e&&(m.Xb(0,"ps-keyin-date",0),m.fc("onPsChange",function(e){return t.dateChanged(e)})("onPsInit",function(e){return t.onInit(e)}),m.Wb()),2&e&&m.pc("options",t.dateOptions)("id",t.id)},directives:[i.a],styles:[""]}),e}()},RzDK:function(e,o,n){"use strict";n.r(o),n.d(o,"BillPaymentPage",function(){return ee});var s,a=n("mrSG"),c=n("3Pt+"),p=n("/M2N"),m=n("ltde"),f=n("WAnK"),b=n("woXy"),O=n("OVQh"),g=n("BcCD"),v=n("fOh1"),P=n("ZyuK"),w=n("BYmO"),k=n("zngb"),C=n("gKqT"),x=n("qEF5"),N=n("fXoL"),A=n("kRg/"),_=n("uKCV"),L=n("sAFK"),E=n("Sx1r"),V=n("KVmc"),I=n("+f2X"),F=n("VEWP"),D=n("+c6a"),S=n("CKXk"),T=n("ZF3V"),B=n("DFXC"),M=n("Q0Ba"),j=n("Isd1"),R=n("L0og"),K=["complexLookupComponentObj"],G=((s=function(e){function o(e,t,n,i){var s;return l(this,o),(s=h(this,o,[e,t])).commonService=e,s.omniPull=n,s.navService=i,s.formGroup=new c.f({}),s.options={requestObject:null},s.complexLookupOptions={requestObject:null,notFoundMessage:"no_fav_payee_found_key"},s.onFavPayeeChange=new N.o,s.labelValuesMap=new Map,s.headerMap=new Map,s.favPayeeOptions=[],s.showList=!1,s.pupulateFavPayeeMap(),s}return y(o,e),u(o,[{key:"ngOnInit",value:function(){r(o,"init",this,3)([]),this.loadFavPayee(),this.complexLookupOptions.title="title_key",this.complexLookupOptions.subTitle="sub_title_key",this.complexLookupOptions.labelsValueMap=this.labelValuesMap,this.commonProv.copyObject(this.complexLookupOptions,this.options,!1),this.complexLookupOptions.requestObject=this.options.requestObject,this.complexLookupOptions.component=this.options&&this.options.component?this.options.component:m.a}},{key:"loadFavPayee",value:function(){this.returnFavPayee()}},{key:"returnFavPayee",value:function(e,t){return Object(a.b)(this,void 0,void 0,i().m(function o(){var n,s,r,a=this;return i().w(function(o){for(;;)switch(o.n){case 0:return n={commonParametersList:this.options.queryParams},o.n=1,this.omniPull.returnFavPayee(n).catch(function(e){a.complexLookupOptions.listOfOptions=[],a.logger.error("Error: While Favourite Payee list in PsLookupFavPayeeComponent :",e)});case 1:(s=o.v)&&s.gridModel.length>0?(r=this.populateFavPayee(s),this.complexLookupOptions.listOfOptions=e&&t?r.filter(function(o){return o.biller===t.itemValue.toString()&&o.category===e.itemValue.toString()}):r,this.logger.log("mappedData",r),this.logger.log("listOfOptions",this.complexLookupOptions.listOfOptions)):this.complexLookupOptions.listOfOptions=[],this.showList=!0;case 2:return o.a(2)}},o,this)}))}},{key:"populateFavPayee",value:function(e){var o=[];if(e&&e.gridModel&&e.gridModel.length>0){var n,i=t(e.gridModel);try{for(i.s();!(n=i.n()).done;){var s=n.value;s&&s.submitFieldValueMap&&o.push({biller:s.submitFieldValueMap.biller?s.submitFieldValueMap.biller:"--",billerAccount:s.submitFieldValueMap.billerAccount?s.submitFieldValueMap.billerAccount:"--",category:s.submitFieldValueMap.category?s.submitFieldValueMap.category:"--",companyCif:s.submitFieldValueMap.companyCif?s.submitFieldValueMap.companyCif:"--",nickName:s.submitFieldValueMap.nickName?s.submitFieldValueMap.nickName:"--",lookupKey:s.submitFieldValueMap.billerAccount,purpose:s.submitFieldValueMap.purpose?s.submitFieldValueMap.purpose:"--",previewProperty:"nickName",dataSaveId:s.dataSaveId,billerDescriptionConcat:s.submitFieldValueMap.billerDescriptionConcat?s.submitFieldValueMap.billerDescriptionConcat:"--",categoryDescriptionConcat:s.submitFieldValueMap.categoryDescriptionConcat?s.submitFieldValueMap.categoryDescriptionConcat:"--"})}}catch(r){i.e(r)}finally{i.f()}return o}}},{key:"loadList",value:function(e,t){this.returnFavPayee(e,t)}},{key:"onChangeItem",value:function(e){this.logger.log("FAV PAYEE #####",e),this.onFavPayeeChange.emit(e)}},{key:"pupulateFavPayeeMap",value:function(){var e,t,o,n;e={key:"billerDescriptionConcat",value:"",isEdit:!1},t={key:"categoryDescriptionConcat",value:"",isEdit:!1},o={key:"billerAccount",value:"",isEdit:!1},n={key:"title",value:"nickName",isEdit:!1},this.labelValuesMap.set("biller_key",e),this.labelValuesMap.set("category_key",t),this.labelValuesMap.set("reference_key",o),this.headerMap.set("title",n)}},{key:"reset",value:function(){this.complexLookupComponentObj.resetLookUp()}}])}(T.a)).\u0275fac=function(e){return new(e||s)(N.Rb(M.a),N.Rb(B.a),N.Rb(P.a),N.Rb(b.a))},s.\u0275cmp=N.Lb({type:s,selectors:[["ps-lookup-fav-payee"]],viewQuery:function(e,t){var o;1&e&&N.Wc(K,1),2&e&&N.Bc(o=N.gc())&&(t.complexLookupComponentObj=o.first)},inputs:{options:"options"},outputs:{onFavPayeeChange:"onFavPayeeChange"},features:[N.Cb],decls:3,vars:2,consts:[[1,"ps-complex-fav-payee"],[3,"id","options","changeItem"],["complexLookupComponentObj",""]],template:function(e,t){1&e&&(N.Xb(0,"ps-container-complex",0),N.Xb(1,"ps-complex-lookup",1,2),N.fc("changeItem",function(e){return t.onChangeItem(e)}),N.Wb(),N.Wb()),2&e&&(N.Fb(1),N.pc("id",t.id)("options",t.complexLookupOptions))},directives:[j.a,R.a],encapsulation:2}),s),U=n("+BRL"),q=n("ofXK"),X=n("ibDU"),W=["favLookupComponentObj"];function Y(e,t){if(1&e){var o=N.Yb();N.Xb(0,"ps-form-step",4),N.Xb(1,"ps-complex-widget-dropdowns",5),N.fc("onSecondValueChange",function(e){return N.Fc(o),N.ic().widgetCompleted(e)}),N.Wb(),N.Wb()}if(2&e){var n=N.ic();N.pc("id",n.stepperOptions.namesofSteps[0]),N.Fb(1),N.pc("options",n.widgetDropdownsOptions)}}function H(e,t){if(1&e){var o=N.Yb();N.Xb(0,"ps-form-step",6),N.Xb(1,"div",7),N.Sb(2,"ps-label",8),N.Wb(),N.Xb(3,"ps-container-panel",9),N.Xb(4,"ps-lookup-own-accounts",10),N.fc("onAccountChange",function(e){return N.Fc(o),N.ic().onAccountChange(e)}),N.Wb(),N.Xb(5,"ps-complex-segment",11),N.fc("complexSegmentButtonClicked",function(e){return N.Fc(o),N.ic().onClickSegment(e)}),N.Xb(6,"ps-content-segment",12),N.Xb(7,"ps-lookup-fav-payee",13,14),N.fc("onFavPayeeChange",function(e){return N.Fc(o),N.ic().onFavPayeeChange(e)}),N.Wb(),N.Wb(),N.Xb(9,"ps-content-segment",15),N.Xb(10,"ps-input-free-text",16),N.fc("onPsChange",function(e){return N.Fc(o),N.ic().onBillerAccNumberChanged(e)}),N.Wb(),N.Wb(),N.Wb(),N.Sb(11,"ps-complex-exchange",8),N.Sb(12,"ps-input-free-text",17),N.Wb(),N.Wb()}if(2&e){var n=N.ic();N.pc("id",n.stepperOptions.namesofSteps[1]),N.Fb(2),N.pc("options",n.headerLabelOptions),N.Fb(1),N.pc("options",n.billpaymentDetailsPanelOptions),N.Fb(1),N.pc("options",n.paymentAccountListOptions),N.Fb(1),N.pc("options",n.complexSegmentOptions),N.Fb(1),N.pc("id",n.complexSegmentOptions.segmentContainerOptions.namesofSegments[0]),N.Fb(1),N.pc("options",n.favPayeeLookupOptions),N.Fb(2),N.pc("id",n.complexSegmentOptions.segmentContainerOptions.namesofSegments[1]),N.Fb(1),N.pc("options",n.billerAccNumberOptions),N.Fb(1),N.pc("options",n.complexExchangeOptions2),N.Fb(1),N.pc("options",n.purposeOptions)}}var z=function(e){return{labelKey:e}};function Q(e,t){if(1&e&&(N.Xb(0,"p",25),N.Sb(1,"ps-label",8),N.Wb()),2&e){var o=N.ic(3);N.Fb(1),N.pc("options",N.sc(1,z,o.validationMsg(!0)))}}function Z(e,t){if(1&e){var o=N.Yb();N.Vb(0),N.Xb(1,"ps-ag-grid",23),N.fc("onRowSelectionChange",function(e){return N.Fc(o),N.ic(2).onRowSelectionChange(e)}),N.Wb(),N.Pc(2,Q,2,3,"p",24),N.Ub()}if(2&e){var n=N.ic(2);N.Fb(1),N.pc("options",n.gridOptions),N.Fb(1),N.pc("ngIf",n.showErrorMsg)}}function J(e,t){if(1&e&&(N.Xb(0,"ps-form-step",18),N.Xb(1,"ps-container-panel",19),N.Pc(2,Z,3,2,"ng-container",20),N.Sb(3,"ps-input-free-text",8),N.Sb(4,"ps-input-free-text",8),N.Sb(5,"ps-label",21),N.Sb(6,"ps-complex-exchange",22),N.Wb(),N.Wb()),2&e){var o=N.ic();N.pc("id",o.stepperOptions.namesofSteps[2]),N.Fb(1),N.pc("options",o.billpaymentGridPanelOptions),N.Fb(1),N.pc("ngIf",o.showGrid),N.Fb(1),N.pc("options",o.labelChargesOptions),N.Fb(1),N.pc("options",o.labelTAmountOptions),N.Fb(1),N.pc("options",o.amountInfoHintOptions),N.Fb(1),N.pc("options",o.complexExchangeOptions)}}var $,ee=(($=function(e){function t(e,o){var n;return l(this,t),(n=h(this,t)).navService=e,n.omniPull=o,n.formGroup=new c.f({}),n.billPaymentVO={},n.selectedBillsRows=[],n.showErrorMsg=!1,n.invalidBills=[],n.isStep2ComplexComponentEnabled=!1,n.isNewRequest=!1,n.isFromFavManagement=!1,n.stepperOptions={stepperName:"bill_payment_stepper",isHorizontalStepper:!0,numberOfSteps:3,namesofSteps:["bill_payment_step1","bill_payment_step2","bill_payment_step3"],group:n.formGroup,submitOptions:{extraParams:{},submitServiceUrl:v.a.serviceUrl.integratedBillPaymentEndPoint,group:n.formGroup,preCallFunction:{func:function(e){var t=this;return new Promise(function(o,n){o(t.executionClass.handleSubmitRequest(e))})},params:[d(n)],executionClass:d(n)}},requestObject:n.billPaymentVO},n.billpaymentDetailsPanelOptions={isExpandable:!0,labelKey:"bill_payment_details_key",iconName:"document",expanded:!0},n.widgetDropdownsOptions={group:n.formGroup,requestObject:n.billPaymentVO,dropdowns:[{group:n.formGroup,fcName:"category",labelKey:"category_key",asyncURL:v.a.serviceUrl.billTypeListEndPoint,mapResponseProperties:{itemValue:"ctsBillTypeId",description:"refFieldType",iconName:"refFieldType"},enablePagination:!1,listOfOptions:[],requestObject:n.billPaymentVO},{group:n.formGroup,fcName:"biller",labelKey:"biller_key",asyncURL:v.a.serviceUrl.billersListEndPoint,mapResponseProperties:{itemValue:"billerCode",description:"cifBillerName",iconName:"providerImage"},enablePagination:!1,listOfOptions:[],requestObject:n.billPaymentVO}]},n.headerLabelOptions={translate:!1},n.billerAccNumberOptions={placeHolder:"enter_reference_number_key",labelKey:"reference_number_key",group:n.formGroup,fcName:"billerAccount"},n.toOtherKey="to_other_key",n.toFavoriteKey="to_fav_payee_key",n.complexSegmentOptions={group:n.formGroup,segmentOptions:{group:n.formGroup,fcName:"segmentBillPay",segmentList:[{selected:!0,itemValue:n.toFavoriteKey,description:n.commonProv.translate(n.toFavoriteKey)},{selected:!0,itemValue:n.toOtherKey,description:n.commonProv.translate(n.toOtherKey)}]},segmentContainerOptions:{numberOfSegments:2,namesofSegments:["fav_payee_segment","other_segment"]}},n.paymentAccountListOptions={labelKey:"from_account_key",placeHolder:"select_from_account_key",component:O.a,currency:"USD",group:n.formGroup,accountAllowedCurrencies:[],accountAllowedTypes:[],glTypes:"G",fcName:"fromAccount",accountType:"G",fromTo:"from",requestObject:n.billPaymentVO},n.complexExchangeOptions2={editableMode:!1,showToCurrencyOptions:!1,fromAmountOptions:{currency:"",currenciesOptions:{placeHolder:"currency_key",labelKey:"currency_key",fcName:"fromAccountCurrency2",group:n.formGroup},amountOptions:{labelKey:"bill_amount_key",placeHolder:"bill_amount_key",fcName:"transactionAmount2",group:n.formGroup,decimalPoints:2}},toAmountOptions:{currency:"",currenciesOptions:{placeHolder:"currency_key",labelKey:"currency_key",fcName:"currency2",group:n.formGroup},amountOptions:{labelKey:"exchanged_amount_key",placeHolder:"enter_exchanged_amount_key",fcName:"toAmount2",group:n.formGroup,decimalPoints:2}},requestObject:n.billPaymentVO,group:n.formGroup},n.complexExchangeOptions={editableMode:!1,showToCurrencyOptions:!0,fromAmountOptions:{currency:"",currenciesOptions:{placeHolder:"currency_key",labelKey:"currency_key",fcName:"fromAccountCurrency",group:n.formGroup},amountOptions:{labelKey:"bill_amount_key",placeHolder:"bill_amount_key",fcName:"transactionAmount",group:n.formGroup,decimalPoints:2}},toAmountOptions:{currency:"",currenciesOptions:{placeHolder:"currency_key",labelKey:"currency_key",fcName:"currency",group:n.formGroup},amountOptions:{labelKey:"exchanged_amount_key",placeHolder:"enter_exchanged_amount_key",fcName:"toAmount",group:n.formGroup,decimalPoints:2}},requestObject:n.billPaymentVO,group:n.formGroup},n.purposeOptions={labelKey:"purpose_key",placeHolder:"enter_purpose_key",fcName:"purpose",group:n.formGroup},n.favPayeeLookupOptions={fcName:"favPayee",group:n.formGroup,labelKey:"favorite_key",placeHolder:"select_favorite_key",requestObject:n.billPaymentVO,component:m.a},n.gridOptions={group:n.formGroup,labelKey:"due_bills_key",fcName:"multiSelectGrid",gridOptions:{url:"rest/omniCorePull/returnBillsList",urlParams:{},defaultColDef:{flex:1,minWidth:180,sortable:!1,resizable:!0},rowSelection:"multiple",applyPagination:!1,paginationPageSize:-1,cacheBlockSize:1,cacheOverflowSize:10,maxConcurrentDatasourceRequests:2,infiniteInitialRowCount:500,maxBlocksInCache:200},enableEdit:!0,disableAddNew:!0,enableDelete:!1,enableSort:!1,enableFilter:!1,checkboxSelection:!0,columnComponents:[{columnNameKey:"bill_date_key",propertyName:"BILL_DATE",component:g.a,componentOptions:{},componentType:"date",editable:!1},{columnNameKey:"bill_number_key",propertyName:"BILL_NUMBER",component:w.a,componentOptions:{},componentType:"input",editable:!1},{columnNameKey:"product_key",propertyName:"PRODUCT",component:w.a,componentOptions:{},componentType:"input",editable:!1},{columnNameKey:"charges_key",propertyName:"CHARGES",component:f.a,componentOptions:{},componentType:"number",editable:!1},{columnNameKey:"bill_amount_key",propertyName:"BILL_AMOUNT",component:f.a,componentOptions:{},componentType:"number",editable:!0,onPsChange:function(e){console.log("GTest: amount value",e),n.onRowSelectionChange(e)}}]},n.labelChargesOptions={placeHolder:"charges_key",labelKey:"charges_key",group:n.formGroup,fcName:"charges"},n.labelTAmountOptions={labelKey:"total_bill_amount_key",placeHolder:"total_bill_amount_key",group:n.formGroup,fcName:"totalAmount"},n.billpaymentGridPanelOptions={isExpandable:!0,labelKey:"due_bills_key",iconName:"document",expanded:!0},n.showFav=!0,n.showGrid=!1,n.nextButtonClick=0,n.amountInfoHintOptions={labelKey:"amount_info_key",position:"fixed"},n}return y(t,e),u(t,[{key:"ngOnInit",value:function(){var e,o,n;r(t,"init",this,3)([]),this.baseFormGroup=this.formGroup;var i=this.navService.getParamKey("navigationIndex");void 0!==i&&(this.stepperOptions.navigationStep=i),1!==(null===(e=this.commonProv.getElementValidations("bill_payment_step3"))||void 0===e?void 0:e.IS_VISIBLE)&&(this.stepperOptions.submitOptions.submitServiceUrl=v.a.serviceUrl.billPaymentEndPoint),1===(null===(o=this.commonProv.getElementValidations(this.complexExchangeOptions2.fromAmountOptions.amountOptions.fcName))||void 0===o?void 0:o.IS_VISIBLE)&&1===(null===(n=this.commonProv.getElementValidations(this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName))||void 0===n?void 0:n.IS_VISIBLE)&&(this.isStep2ComplexComponentEnabled=!0)}},{key:"ionViewDidEnter",value:function(){r(t,"ionViewDidEnter",this,3)([]),this.commonProv.applyDynScreenDisplay(k.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName,this.complexExchangeOptions.toAmountOptions.currenciesOptions.fcName,this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName,this.complexExchangeOptions.toAmountOptions.amountOptions.fcName,this.labelChargesOptions.fcName,this.labelTAmountOptions.fcName],1),this.isStep2ComplexComponentEnabled&&(this.commonProv.applyDynScreenDisplay(k.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName],1),this.commonProv.applyDynScreenDisplay(k.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions2.toAmountOptions.currenciesOptions.fcName],1),this.commonProv.applyDynScreenDisplay(k.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions2.toAmountOptions.amountOptions.fcName],1),Object.keys(this.billPaymentVO).length>0&&(v.a.isMaker||v.a.isChecker)&&this.updateStep2AmountAndCurrency())}},{key:"onAccountChange",value:function(e){e&&(this.selectedFromAccount=e,this.isStep2ComplexComponentEnabled?(this.commonProv.setValInsideNestedObj(this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName,e.currency.toString(),this.billPaymentVO),this.complexExchangeOptions2.fromAmountOptions.currencyCode=Number(e.currency),this.complexExchangeOptions2.toAmountOptions.currencyCode=Number(e.currency),this.commonProv.applyDynScreenDisplay(k.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName],1)):(this.prepareGridQueryParamsAndValidations(),this.billPaymentVO[this.complexExchangeOptions.toAmountOptions.amountOptions.fcName]="",this.billPaymentVO[this.complexExchangeOptions.toAmountOptions.currenciesOptions.fcName]=e.currency.toString(),this.complexExchangeOptions.toAmountOptions.currencyCode=Number(e.currency)))}},{key:"showExchangeRate",value:function(){var e;null===(e=this.exchangeChild)||void 0===e||e.showToCurrency()}},{key:"widgetCompleted",value:function(e){this.headerLabelOptions.labelKey=e[k.a.HEADER_LABEL],this.favPayeeLookupOptions.queryParams={biller:e[this.widgetDropdownsOptions.dropdowns[1].fcName]},this.stepperOptions.stepperInstance.next.onNextClicked(e)}},{key:"ngAfterViewInit",value:function(){var e=this.commonProv.session.getValueOf(k.a.preLoginResponse);this.isFromFavManagement=!(!this.billPaymentVO.dataSaveId||!this.billPaymentVO[this.favPayeeLookupOptions.fcName]),this.isNewRequest=!(null==this.billPaymentVO||!x.a.isEmptyObject(this.billPaymentVO)),e.companySettingsCO&&(this.baseCurrency=e.companySettingsCO.briefDesc,this.currencyCode=e.companySettingsCO.baseCurrency,this.commonProv.setValInsideNestedObj(this.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName,this.currencyCode.toString(),this.billPaymentVO),this.complexExchangeOptions.fromAmountOptions.currencyCode=Number(this.currencyCode),this.commonProv.applyDynScreenDisplay(k.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName],1),this.commonProv.applyDynScreenDisplay(k.a.ACTION_TYPE_READONLY,[this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName],1))}},{key:"onClickSegment",value:function(e){var t;this.showFav=!this.showFav,e===this.toFavoriteKey&&this.billPaymentVO[this.billerAccNumberOptions.fcName]?this.commonProv.setValInsideNestedObj(this.billerAccNumberOptions.fcName,null,this.billPaymentVO):this.billPaymentVO[this.favPayeeLookupOptions.fcName]&&(null===(t=this.favLookupComponentObj)||void 0===t||t.reset()),this.commonProv.applyDynScreenDisplay(k.a.ACTION_TYPE_MANDATORY,[this.favPayeeLookupOptions.fcName,this.favPayeeLookupOptions.fcName+"_lookupKey"],e===this.toFavoriteKey?1:0)}},{key:"onRowSelectionChange",value:function(e){var t;return Object(a.b)(this,void 0,void 0,i().m(function o(){var n,s,r,a,c=this;return i().w(function(o){for(;;)switch(o.n){case 0:if(this.billCharges=0,this.billTotalAmount=0,0===(n=this.selectedBillsRows.filter(function(t){var o;if(t.rowIndex===((null===(o=e.rowNode)||void 0===o?void 0:o.data.rowIndex)||e.rowIndex))return t.BILL_AMOUNT=e.newValue||t.BILL_AMOUNT,t.selected=e.selected,c.validateBillAmount(t),t})).length&&(e.selected||(null===(t=e.rowNode)||void 0===t?void 0:t.selected))?(this.selectedBillsRows.push(e),this.validateBillAmount(e)):-1!=(s=this.selectedBillsRows.findIndex(function(t){return t.rowIndex==e.rowIndex}))&&this.selectedBillsRows.splice(s,1),!e.newValue||0==e.newValue){o.n=2;break}return r={commonParametersList:{fromAccount:this.selectedFromAccount,trxAmount:e.newValue}},this.commonProv.presentLoading(),o.n=1,this.omniPull.returnChargesDetails(r).catch(function(e){c.commonProv.logger.error("something went wrong",e),c.commonProv.dismissLoading()});case 1:(a=o.v)&&(this.commonProv.applyDynScreenDisplay(k.a.ACTION_TYPE_VALUE,["CHARGES-"+e.rowIndex],a.totalCharge),this.selectedBillsRows.filter(function(e){var t;return e.BILL_NUMBER==(null===(t=n[0])||void 0===t?void 0:t.BILL_NUMBER)})[0]&&(this.selectedBillsRows.filter(function(e){var t;return e.BILL_NUMBER==(null===(t=n[0])||void 0===t?void 0:t.BILL_NUMBER)})[0].CHARGES=a.totalCharge||0)),this.commonProv.dismissLoading();case 2:this.selectedBillsRows.forEach(function(e){e.selected&&e.BILL_AMOUNT>0&&(c.billCharges+=Number(c.commonProv.valFromNestedObj("CHARGES",e)),c.billTotalAmount+=Number(c.commonProv.valFromNestedObj("BILL_AMOUNT",e)))}),v.a.isChecker||this.setChargesAmount(this.billCharges,this.billTotalAmount);case 3:return o.a(2)}},o,this)}))}},{key:"setChargesAmount",value:function(e,t){var o=void 0!==t?t+e:0;this.commonProv.setValInsideNestedObj(this.labelChargesOptions.fcName,e,this.billPaymentVO),this.commonProv.setValInsideNestedObj(this.labelTAmountOptions.fcName,t,this.billPaymentVO),this.commonProv.setValInsideNestedObj(this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName,o,this.billPaymentVO)}},{key:"showGridValidation",value:function(e){var t=this;this.nextButtonClick=this.nextButtonClick+1,this.checkGridControlsValidity(this.formGroup.controls[this.gridOptions.fcName])?this.validationMsg(!1):this.validationMsg(this.nextButtonClick>2&&e._selectedIndex>=2),2===e._selectedIndex&&(this.isStep2ComplexComponentEnabled||setTimeout(function(){t.showExchangeRate()},500))}},{key:"custGridValidator",value:function(){var e=this;return function(t){return e.checkGridControlsValidity(t)?(e.validationMsg(!1),null):(e.validationMsg(null!=t.value&&!t.value.some(function(e){return""===e.BILL_NUMBER})),{"equal or less than 0":!0})}}},{key:"checkGridControlsValidity",value:function(e){return!(0==this.selectedBillsRows.length||this.selectedBillsRows.some(function(e){return 0==e.BILL_AMOUNT})||1==this.selectedBillsRows.length&&this.selectedBillsRows.some(function(e){return 0==e.selected}))}},{key:"validationMsg",value:function(e){return this.showErrorMsg=e,this.invalidBills.length>0?this.commonProv.translate("kindly_to_enter_a_valid_amount_for_bills_key")+": "+this.invalidBills.filter(function(e){return void 0!==e}).join(","):0==this.selectedBillsRows.length||1==this.selectedBillsRows.length&&this.selectedBillsRows.some(function(e){return 0==e.selected})?this.commonProv.translate("value_is_missing_key"):""}},{key:"handleSubmitRequest",value:function(){this.billPaymentVO&&!x.a.isEmptyObject(this.billPaymentVO)&&v.a.isMaker&&this.isFromFavManagement&&this.billPaymentVO.dataSaveId===this.billPaymentVO[this.favPayeeLookupOptions.fcName].dataSaveId&&delete this.billPaymentVO.dataSaveId,this.isStep2ComplexComponentEnabled?(this.billPaymentVO.submitType=1,this.billPaymentVO[this.complexExchangeOptions2.fromAmountOptions.amountOptions.fcName]&&(this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName]=this.billPaymentVO[this.complexExchangeOptions2.fromAmountOptions.amountOptions.fcName],delete this.billPaymentVO[this.complexExchangeOptions2.fromAmountOptions.amountOptions.fcName]),null!=this.billPaymentVO[this.complexExchangeOptions2.toAmountOptions.amountOptions.fcName]&&this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName]&&(this.billPaymentVO[this.complexExchangeOptions.toAmountOptions.amountOptions.fcName]=this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName],delete this.billPaymentVO[this.complexExchangeOptions2.toAmountOptions.amountOptions.fcName]),this.billPaymentVO[this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName]&&(this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName]=this.billPaymentVO[this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName],this.billPaymentVO[this.complexExchangeOptions.toAmountOptions.currenciesOptions.fcName]=this.billPaymentVO[this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName],delete this.billPaymentVO[this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName]),this.billPaymentVO[this.complexExchangeOptions2.toAmountOptions.currenciesOptions.fcName]&&delete this.billPaymentVO[this.complexExchangeOptions2.toAmountOptions.currenciesOptions.fcName]):(delete this.billPaymentVO.gridValue,this.billPaymentVO.submitType=3)}},{key:"validateBillAmount",value:function(e){var t=this;e.selected&&(e.BILL_AMOUNT>0?this.invalidBills.forEach(function(o,n){o===e.BILL_NUMBER&&t.invalidBills.splice(n,1)}):!this.invalidBills.some(function(t){return t===e.BILL_NUMBER})&&this.invalidBills.push(e.BILL_NUMBER))}},{key:"onFavPayeeChange",value:function(e){e&&this.assignSelectedToAccount(e)}},{key:"onBillerAccNumberChanged",value:function(e){e&&this.assignSelectedToAccount({billerAccount:e.newValue})}},{key:"assignSelectedToAccount",value:function(e){this.selectedToAccount=e,this.prepareGridQueryParamsAndValidations()}},{key:"prepareGridQueryParamsAndValidations",value:function(){var e=this;this.showGrid=!1,this.selectedFromAccount&&this.selectedToAccount&&(this.gridOptions.gridOptions.urlParams={submitType:2,commonParametersList:{fromAccount:this.selectedFromAccount,toAccount:this.selectedToAccount,billerId:this.formGroup.controls[this.widgetDropdownsOptions.dropdowns[1].fcName].value,toFav:this.showFav}},this.commonProv.presentLoading(),setTimeout(function(){e.showGrid=!0,e.commonProv.addDefaultValidator(e.formGroup,e.gridOptions.fcName,e.commonProv.prepareValidation(!1,null,null,null,null,null,null,null,[e.custGridValidator()])),e.commonProv.dismissLoading()},1e3))}},{key:"updateStep2AmountAndCurrency",value:function(){if(!this.isFromFavManagement&&!this.isNewRequest&&(null!=this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName]&&null!=this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName]&&this.commonProv.setValInsideNestedObj(this.complexExchangeOptions2.fromAmountOptions.amountOptions.fcName,this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.amountOptions.fcName],this.billPaymentVO),null!=this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName]&&null!=this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName])){var e=this.billPaymentVO[this.complexExchangeOptions.fromAmountOptions.currenciesOptions.fcName];this.commonProv.setValInsideNestedObj(this.complexExchangeOptions2.fromAmountOptions.currenciesOptions.fcName,e,this.billPaymentVO),this.commonProv.setValInsideNestedObj(this.complexExchangeOptions2.toAmountOptions.currenciesOptions.fcName,e,this.billPaymentVO)}}}])}(C.OmniBasePage)).\u0275fac=function(e){return new(e||$)(N.Rb(b.a),N.Rb(P.a))},$.\u0275cmp=N.Lb({type:$,selectors:[["bill-payment"]],viewQuery:function(e,t){var o;1&e&&(N.Wc(p.a,1),N.Wc(W,1)),2&e&&(N.Bc(o=N.gc())&&(t.exchangeChild=o.first),N.Bc(o=N.gc())&&(t.favLookupComponentObj=o.first))},features:[N.Cb],decls:4,vars:5,consts:[[3,"options","id","onNextPreviousStepper"],["step1","",3,"id",4,"psStep"],["step2","",3,"id",4,"psStep"],["step3","",3,"id",4,"psStep"],["step1","",3,"id"],["id","category_biller_widgets",3,"options","onSecondValueChange"],["step2","",3,"id"],[1,"category_biller_header"],[3,"options"],["id","bill_payment_details_panel",3,"options"],["id","payment_account_list",3,"options","onAccountChange"],["id","billPaymentSegment",1,"biller-type-select-segment",3,"options","complexSegmentButtonClicked"],["segment1","",3,"id"],[3,"options","onFavPayeeChange"],["favLookupComponentObj",""],["segment2","",3,"id"],["id","biller_account_number",3,"options","onPsChange"],["id","payment_purpose",3,"options"],["step3","",3,"id"],["id","bill_payment_grid_panel",3,"options"],[4,"ngIf"],[1,"amount-info",3,"options"],["id","exchange",3,"options"],[1,"onboarding_toggles",3,"options","onRowSelectionChange"],["class","validation-message requested-product",4,"ngIf"],[1,"validation-message","requested-product"]],template:function(e,t){1&e&&(N.Xb(0,"ps-template-stepper",0),N.fc("onNextPreviousStepper",function(e){return t.showGridValidation(e)}),N.Pc(1,Y,2,2,"ps-form-step",1),N.Pc(2,H,13,11,"ps-form-step",2),N.Pc(3,J,7,7,"ps-form-step",3),N.Wb()),2&e&&(N.pc("options",t.stepperOptions)("id",t.stepperOptions.stepperName),N.Fb(1),N.pc("psStep","step1"),N.Fb(1),N.pc("psStep","step2"),N.Fb(1),N.pc("psStep","step3"))},directives:[A.a,_.a,L.a,E.a,V.a,I.a,F.a,D.a,S.a,G,U.a,p.a,q.o,X.a],encapsulation:2}),$)},Sx1r:function(e,t,o){"use strict";o.d(t,"a",function(){return N});var n=o("mrSG"),s=o("fXoL"),r=o("ZF3V"),a=o("DFXC"),c=o("zngb"),p=o("Q0Ba"),m=o("TEn/"),d=o("Isd1"),f=o("ofXK"),b=o("KVmc"),O=o("ilDp"),g=o("qNfM"),v=o("BqtM");function P(e,t){if(1&e){var o=s.Yb();s.Xb(0,"div",8),s.Xb(1,"ps-action-icon",9),s.fc("onClick",function(){return s.Fc(o),s.ic(2).onBackIconClicked()}),s.Wb(),s.Wb()}if(2&e){var n=s.ic(2);s.Fb(1),s.pc("options",n.backIconOptions)}}var w=function(e,t){return[e,t]};function k(e,t){if(1&e){var o=s.Yb();s.Vb(0),s.Xb(1,"ps-select-dropdown-widget",10),s.fc("onPsChange",function(e){return s.Fc(o),s.ic(2).onItemSelected(e)}),s.Wb(),s.Ub()}if(2&e){var n=t.$implicit,i=t.index;s.Fb(1),s.pc("options",n)("ngClass",s.tc(2,w,n&&n.psClass?n.psClass:"","level-"+i))}}function C(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"div",3),s.Pc(2,P,2,1,"div",4),s.Xb(3,"div",5),s.Sb(4,"ps-label",6),s.Wb(),s.Wb(),s.Pc(5,k,2,5,"ng-container",7),s.Ub()),2&e){var o=s.ic();s.Fb(2),s.pc("ngIf",o.showIcon),s.Fb(2),s.pc("options",o.headerLabelOptions),s.Fb(1),s.pc("ngForOf",o.options.dropdowns)}}function x(e,t){if(1&e&&(s.Xb(0,"p",11),s.Rc(1),s.jc(2,"translate"),s.Wb()),2&e){var o=s.ic();s.Fb(1),s.Sc(s.kc(2,1,o.selectionErrorMessage))}}var N=function(){var e=function(e){function t(e,o,n){var i;return l(this,t),(i=h(this,t,[e,o])).commonProv=e,i.loggerP=o,i.modalController=n,i.onSecondValueChange=new s.o,i.numberOfDropdowns=0,i.currentDropdownPosition=0,i.selectedItemsList=[],i.selectReportsError=!1,i.selectionErrorMessage="no_selected_reports_key",i.headerLabelOptions={},i.backIconOptions={iconName:"arrow-back"},i.backClicked=!1,i.showIcon=!1,i.isPreviouslySelected=!1,i}return y(t,e),u(t,[{key:"ngOnInit",value:function(){this.options.dropdowns&&this.options.dropdowns.length>0&&(this.numberOfDropdowns=this.options.dropdowns.length,this.options.dropdowns[0].renderDropdown=!0,this.currentDropdownPosition=1,this.headerLabelOptions.labelKey=this.options.dropdowns[0].labelKey)}},{key:"onItemSelected",value:function(e){var t=this;if(this.options.requestObject&&this.options.requestObject[this.options.dropdowns[this.currentDropdownPosition-1].fcName]&&e.itemValue===this.options.requestObject[this.options.dropdowns[this.currentDropdownPosition-1].fcName].itemValue&&this.options.dropdowns[this.currentDropdownPosition]&&this.options.dropdowns[this.currentDropdownPosition].listOfOptions&&this.options.dropdowns[this.currentDropdownPosition].listOfOptions.length>0)this.options.dropdowns.length>this.currentDropdownPosition&&(this.options.dropdowns[this.currentDropdownPosition-1].psClass="hide-dropdown",this.options.dropdowns[this.currentDropdownPosition].psClass="show-dropdown",this.currentDropdownPosition++,this.showIcon=!0);else if(this.options.dropdowns.length>1||1==this.options.dropdowns.length&&this.options.dropdowns[0].asyncURL)this.isPreviouslySelected=!(!this.options.requestObject[this.options.dropdowns[this.currentDropdownPosition-1].fcName]||!this.options.requestObject[c.a.HEADER_LABEL]),this.commonProv.setValInsideNestedObj(this.options.dropdowns[this.currentDropdownPosition-1].fcName,e,this.options.requestObject),this.options.dropdowns.length>this.currentDropdownPosition?(this.backClicked&&(this.commonProv.setValInsideNestedObj(this.options.dropdowns[this.currentDropdownPosition].fcName,null,this.options.requestObject),this.options.dropdowns[this.currentDropdownPosition].renderDropdown=!1,this.options.dropdowns[this.currentDropdownPosition]={group:this.options.dropdowns[this.currentDropdownPosition].group,fcName:this.options.dropdowns[this.currentDropdownPosition].fcName,labelKey:this.options.dropdowns[this.currentDropdownPosition].labelKey,asyncURL:this.options.dropdowns[this.currentDropdownPosition].asyncURL,mapResponseProperties:this.options.dropdowns[this.currentDropdownPosition].mapResponseProperties,enablePagination:this.options.dropdowns[this.currentDropdownPosition].enablePagination,listOfOptions:[],componentInstance:this.options.dropdowns[this.currentDropdownPosition].componentInstance},this.headerLabelOptions.labelKey=this.options.dropdowns[this.currentDropdownPosition-1].labelKey),this.options.dropdowns[this.currentDropdownPosition].serviceRequestObj?this.options.dropdowns[this.currentDropdownPosition].serviceRequestObj.commonParametersList=e.selectedObj:this.options.dropdowns[this.currentDropdownPosition].serviceRequestObj={commonParametersList:e.selectedObj},this.options.dropdowns[this.currentDropdownPosition].renderDropdown=!0,this.options.dropdowns[this.currentDropdownPosition-1].psClass="hide-dropdown",-1!==this.headerLabelOptions.labelKey.indexOf("-")?(this.headerLabelOptions.labelKey=this.headerLabelOptions.labelKey.slice(0,this.headerLabelOptions.labelKey.lastIndexOf("-")+1),this.headerLabelOptions.labelKey.replace(this.commonProv.translate(this.options.dropdowns[this.currentDropdownPosition-1].fcName),e.description),this.headerLabelOptions.labelKey.endsWith("-")&&(this.headerLabelOptions.labelKey=this.headerLabelOptions.labelKey.slice(0,-1)),this.headerLabelOptions.labelKey+=" - "+this.options.dropdowns[this.currentDropdownPosition].fcName):(this.headerLabelOptions.labelKey=e.description,this.headerLabelOptions.labelKey+=" - "+this.options.dropdowns[this.currentDropdownPosition].fcName),this.showIcon=!0,this.currentDropdownPosition++,this.options.group.controls[this.options.dropdowns[this.currentDropdownPosition-1].fcName].reset(),this.options.dropdowns[this.currentDropdownPosition-1].componentInstance.callService()):this.options.dropdowns.length===this.currentDropdownPosition&&(this.headerLabelOptions.labelKey=this.headerLabelOptions.labelKey.slice(0,this.isPreviouslySelected?this.headerLabelOptions.labelKey.indexOf("-")+1:this.headerLabelOptions.labelKey.lastIndexOf("-")+1),this.headerLabelOptions.labelKey+=e.description,this.options.requestObject[c.a.HEADER_LABEL]=this.headerLabelOptions.labelKey,this.common.presentLoading(),setTimeout(function(){t.onSecondValueChange.emit(t.options.requestObject),t.common.dismissLoading()},500),this.showDescriptionModal(e));else if(1==this.options.dropdowns.length&&!this.options.dropdowns[0].asyncURL){var o=!1;this.selectReportsError=!1;var n=this.options.dropdowns[0].fcName;this.selectedItemsList.forEach(function(n,i){n.itemValue==e.itemValue&&(o=!0,n.selected=!1,t.selectedItemsList.splice(i,1))}),o||this.selectedItemsList.push(e),0==this.selectedItemsList.length&&(this.selectReportsError=!0,this.options.group.controls[n].setValue([]),this.options.group.get(n).setValue([])),this.selectedItemsList.forEach(function(e){e.selected=!0}),this.options.group.controls[n].setValue(this.selectedItemsList),this.options.group.get(n).setValue(this.selectedItemsList),this.commonProv.setValInsideNestedObj(this.options.dropdowns[0].fcName,this.selectedItemsList,this.options.requestObject)}}},{key:"showDescriptionModal",value:function(e){return Object(n.b)(this,void 0,void 0,i().m(function t(){var o,n;return i().w(function(t){for(;;)switch(t.n){case 0:if(!this.options.detailsObject){t.n=2;break}return o=this.options.detailsObject.detailsModalId,t.n=1,this.modalController.create({component:this.options.detailsObject.detailsModal,componentProps:{data:Object.assign({},e.selectedObj),actions:this.options.detailsObject.detailsActionsList},cssClass:this.options.detailsObject.detailsModalClass,animated:!1,id:o});case 1:return n=t.v,t.n=2,n.present();case 2:return t.a(2)}},t,this)}))}},{key:"onBackIconClicked",value:function(){this.backClicked=!0,this.options.group.controls[this.options.dropdowns[this.currentDropdownPosition-1].fcName].invalid&&this.options.group.controls[this.options.dropdowns[this.currentDropdownPosition-1].fcName].reset(),this.options.dropdowns[this.currentDropdownPosition-1].psClass="hide-dropdown",this.options.dropdowns[this.currentDropdownPosition-2].psClass="show-dropdown",this.currentDropdownPosition--,1===this.currentDropdownPosition&&(this.showIcon=!1)}},{key:"resetSelections",value:function(){var e=this.options.dropdowns[0].fcName;this.selectedItemsList.forEach(function(e){e.selected=!1}),this.selectedItemsList=[],this.options.group.controls[e].setValue([]),this.options.group.get(e).setValue(this.selectedItemsList),this.commonProv.setValInsideNestedObj(this.options.dropdowns[0].fcName,this.selectedItemsList,this.options.requestObject),this.selectReportsError=!0}}])}(r.a);return e.\u0275fac=function(t){return new(t||e)(s.Rb(p.a),s.Rb(a.a),s.Rb(m.N))},e.\u0275cmp=s.Lb({type:e,selectors:[["ps-complex-widget-dropdowns"]],inputs:{options:"options"},outputs:{onSecondValueChange:"onSecondValueChange"},features:[s.Cb],decls:3,vars:2,consts:[[1,"ps-complex-widget-dropdowns"],[4,"ngIf"],["class","select-documents-validation-message",4,"ngIf"],[1,"ps-complex-widget-dropdowns_header"],["class","ps-complex-widget-dropdowns_header-back",4,"ngIf"],[1,"ps-complex-widget-dropdowns_header-label"],[3,"options"],[4,"ngFor","ngForOf"],[1,"ps-complex-widget-dropdowns_header-back"],[3,"options","onClick"],[3,"options","ngClass","onPsChange"],[1,"select-documents-validation-message"]],template:function(e,t){1&e&&(s.Xb(0,"ps-container-complex",0),s.Pc(1,C,6,3,"ng-container",1),s.Pc(2,x,3,3,"p",2),s.Wb()),2&e&&(s.Fb(1),s.pc("ngIf",(null==t.options?null:t.options.dropdowns.length)>0),s.Fb(1),s.pc("ngIf",t.selectReportsError))},directives:[d.a,f.o,b.a,f.n,O.a,g.a,f.m],pipes:[v.a],encapsulation:2}),e}()},VEWP:function(o,n,s){"use strict";s.d(n,"a",function(){return k});var r=s("mrSG"),a=s("fXoL"),c=s("4lGw"),p=s("V0Fi"),m=s("ZyuK"),d=s("ZF3V"),f=s("EIUR"),b=s("DFXC"),O=s("zngb"),g=s("Q0Ba"),v=s("Isd1"),P=s("L0og"),w=["complexLookupComponentObj"],k=function(){var o=function(o){function n(e,t,o,i){var s;return l(this,n),(s=h(this,n,[e,t])).commonService=e,s.omniPull=o,s.accountsService=i,s.options={fromTo:"",requestObject:null},s.complexLookupOptions={requestObject:null,notFoundMessage:"no_valid_account_found_key",multiple:!!s.options.multiple&&s.options.multiple},s.onAccountChange=new a.o,s.onAccountDeleted=new a.o,s.labelValuesMap=new Map,s.psCurrency=new f.a,s.labelOptions={},s.allType=!1,s}return y(n,o),u(n,[{key:"ngOnInit",value:function(){this.loadAccounts(null),this.complexLookupOptions.labelKey=this.options.labelKey,this.complexLookupOptions.title="title_key",this.complexLookupOptions.subTitle="sub_title_key",this.complexLookupOptions.labelsValueMap=this.labelValuesMap,this.allType=!!this.options.allType&&this.options.allType,this.commonProv.copyObject(this.complexLookupOptions,this.options,!1),this.complexLookupOptions.requestObject=this.options.requestObject}},{key:"ngOnChanges",value:function(e){this.complexLookupOptions.labelKey=this.options.labelKey,this.complexLookupOptions.placeHolder=this.options.placeHolder}},{key:"loadAccounts",value:function(e){return Object(r.b)(this,void 0,void 0,i().m(function t(){var o,n;return i().w(function(t){for(;;)switch(t.n){case 0:if(null!=e&&(this.options=e),this.options.listOfAccounts=[],void 0!==this.options.fromTo&&""!==this.options.fromTo){t.n=1;break}return t.a(2,void this.logger.error("lookup_from_to_missing_key"));case 1:o=this.commonService.session.getValueOf(O.a.USERINFO),n=this.prepareRequestData(o),this.returnAccountList(n);case 2:return t.a(2)}},t,this)}))}},{key:"returnAccountList",value:function(t){return Object(r.b)(this,void 0,void 0,i().m(function o(){var n,s,r,a,c=this;return i().w(function(o){for(;;)switch(o.n){case 0:return n=this.commonProv.session.getValueOf(p.a.PERSONALIZATION_CO),this.complexLookupOptions.listOfOptions=void 0,o.n=1,this.omniPull.returnAccounts(t).catch(function(e){c.complexLookupOptions.listOfOptions=[],c.logger.error("Error: While fetching accounts in PsComplexOwnAccountComponent :",e)});case 1:if(!((s=o.v)&&s.gridModel.length>0)){o.n=4;break}if(!this.allType){o.n=3;break}return t.accountType="F",t.permittedGls="F",o.n=2,this.omniPull.returnAccounts(t).catch(function(e){c.logger.error("Error: While fetching accounts in PsComplexOwnAccountComponent :",e)});case 2:(r=o.v)&&r.gridModel.length>0&&(s.gridModel=[].concat(e(s.gridModel),e(r.gridModel)));case 3:this.options.listOfAccounts=s.gridModel,this.options.accountNumber&&""!==this.options.accountNumber&&(this.complexLookupOptions.listOfOptions=this.options.listOfAccounts.filter(function(e){return e.accountNumber!==c.options.accountNumber})),this.options.currency&&""!==this.options.currency&&(this.complexLookupOptions.listOfOptions=this.fetchAccountBasedOnCurrency(this.options.currency),this.options.accountNumber&&""!==this.options.accountNumber&&(this.complexLookupOptions.listOfOptions=this.options.listOfAccounts.filter(function(e){return e.accountNumber!==c.options.accountNumber}))),null!=this.options.accountNumber&&""!==this.options.accountNumber||(this.complexLookupOptions.listOfOptions=this.options.listOfAccounts),this.complexLookupOptions.listOfOptions=this.populateCustomAccounts(this.complexLookupOptions.listOfOptions),this.complexLookupOptions.listOfOptions.map(function(e,t){return e.rowIndex=t}),this.allAccounts=Object.assign([],this.complexLookupOptions.listOfOptions),null==this.complexLookupOptions.selectedItems&&(this.complexLookupOptions.selectedItems=[]),this.complexLookupOptions.multiple&&this.handleMultipleSelection(),!this.options.requestObject[this.options.fcName]&&(this.options.defaultByPersonalizedAcc=null==this.options.defaultByPersonalizedAcc||this.options.defaultByPersonalizedAcc,"from"===this.options.fromTo&&this.options.defaultByPersonalizedAcc)&&(a="QR"===this.options.purpose?null==n?void 0:n.defaultQrPaymentAccKey:null==n?void 0:n.defaultTransferAccKey,this.complexLookupOptions.listOfOptions.map(function(e){e.personalizeKey&&e.personalizeKey===a&&(c.common.setValInsideNestedObj(c.options.fcName,e.lookupKey,c.options.requestObject),c.common.setValInsideNestedObj(c.options.fcName+"_lookupKey",e.lookupKey,c.options.requestObject))})),o.n=5;break;case 4:this.listOfAccounts=[],this.complexLookupOptions.listOfOptions=[];case 5:return o.a(2)}},o,this)}))}},{key:"populateCustomAccounts",value:function(e){var o,n=[],i=t(e);try{for(i.s();!(o=i.n()).done;){var s=o.value,r={briefNameEnglish:s.briefNameEnglish,cifShortNameEnglish:s.cifShortNameEnglish,accountNumber:s.accountNumber,balance:this.psCurrency.transform(null==s.balance?"0.0":s.balance,s.currencyDecimalPoints)+" "+(s.currencyBriefName||s.currencyBriefNameEnglish),availableBalance:this.psCurrency.transform(null==s.availableBalance?"0.0":s.availableBalance,s.currencyDecimalPoints)+" "+(s.currencyBriefName||s.currencyBriefNameEnglish),currencyBriefName:s.currencyBriefName||s.currencyBriefNameEnglish,currencyBriefNameEnglish:s.currencyBriefNameEnglish,currency:s.currency,accountTypeDesc:s.accountTypeDesc,additionalRef:s.additionalRef,ibanAccNo:s.ibanAccNo,accGl:s.accGl,serialNo:s.serialNo,branch:s.branch,cif:s.cif,formattedAccount:this.accountsService.returnFormattedAccount(s).formattedAccount,personalizeKey:s.personalizeKey,nickName:s.nickName,briefName:s.briefName,lookupKey:s.additionalRef,branchDescription:s.branchDescription?s.branchDescription:"",generalLedgerBriefNameEng:s.generalLedgerBriefNameEng?s.generalLedgerBriefNameEng:"",previewProperty:"accountNumber",status:s.statusDescription,statusCode:s.status,accountFormat:this.accountsService.returnFormattedAccount(s).accountFormat};this.options.multiple&&(r.excludeType=s.excludeType),n.push(r)}}catch(a){i.e(a)}finally{i.f()}return n}},{key:"prepareRequestData",value:function(e){var t={};if(e&&e.omniUserVO&&(t={userCifNo:e.omniUserVO.CIF_NO,type:"A"}),null!=this.options.queryParams&&void 0!==this.options.queryParams&&""!==this.options.queryParams&&(t={commonParametersList:this.options.queryParams}),null!=this.options.accountType&&void 0!==this.options.accountType&&""!==this.options.accountType&&(t.accountType=this.options.accountType),null!=this.options.glTypes&&void 0!==this.options.glTypes&&""!==this.options.glTypes&&(t.permittedGls=this.options.glTypes),null!=this.options.fromTo&&""!==this.options.fromTo&&(t.fromTo=this.options.fromTo),null!=this.options.endUserId&&""!==this.options.endUserId&&(t.endUserId=this.options.endUserId),null!=this.options.fromCurrency?t.fromCurrency=this.options.fromCurrency:null!=this.options.toCurrency&&(t.toCurrency=this.options.toCurrency),null!=this.options.accountAllowedCurrencies&&void 0!==this.options.accountAllowedCurrencies)if("string"==typeof this.options.accountAllowedCurrencies)t.accountAllowedCurrencies=this.options.accountAllowedCurrencies;else{var o="";for(var n in this.options.accountAllowedCurrencies)o+=this.options.accountAllowedCurrencies[n]+",";o=o.slice(0,o.lastIndexOf(",")),t.accountAllowedCurrencies=o}if(null!=this.options.accountAllowedTypes&&void 0!==this.options.accountAllowedTypes)if("string"==typeof this.options.accountAllowedTypes)t.accountAllowedTypes=this.options.accountAllowedTypes;else{var i="";for(var s in this.options.accountAllowedTypes)i+=this.options.accountAllowedTypes[s]+",";i=i.slice(0,i.lastIndexOf(",")),t.accountAllowedTypes=i}return t}},{key:"fetchAccountBasedOnCurrency",value:function(e){return this.options.listOfAccounts}},{key:"onChange",value:function(e){this.logger.log(e)}},{key:"populateOwnAccountMap",value:function(){var e,t,o;e={key:"accountNumber",value:"--- --- --- ---",isEdit:!1},t={key:"currentBalance",value:"0.0",isEdit:!1},o={key:"availableBalance",value:"0.0",isEdit:!1},this.labelValuesMap.set("account_key",e),this.labelValuesMap.set("balance_key",t),this.labelValuesMap.set("available_balance_key",o)}},{key:"onChangeItem",value:function(e){this.onAccountChange.emit(e)}},{key:"onDeleteItem",value:function(e){e&&this.onAccountDeleted.emit(e)}},{key:"handleMultipleSelection",value:function(){var e=this,t=this.options.setAllAccountsAsSelecetd?this.complexLookupOptions.listOfOptions:this.options.requestObject[this.options.fcName]?this.complexLookupOptions.listOfOptions.filter(function(t){return e.options.requestObject[e.options.fcName].some(function(e){return e.accountNumber==t.accountNumber})}):[];this.complexLookupOptions.selectedItems=t.filter(function(t){return e.options.setAllAccountsAsSelecetd&&(!t.excludeType||!(t.excludeType.includes(p.a.GENERAL_ACCOUNT_EXCLUDE_TYPE)||t.excludeType.includes(p.a.TERM_ACCOUNT_EXCLUDE_TYPE)))||!e.options.setAllAccountsAsSelecetd}).map(function(e){return Object.assign(Object.assign({item:e[e.previewProperty]},e),{itemLookup:e.lookupKey})}),this.complexLookupOptions.selectedItems.length>0&&this.complexLookupComponentObj.setSelectedItems(this.complexLookupOptions.selectedItems)}},{key:"removeAccount",value:function(e){e&&void 0!==this.allAccounts&&(this.complexLookupOptions.listOfOptions=this.allAccounts?this.allAccounts.filter(function(t){return e.accountNumber!=t.accountNumber}):[])}},{key:"reset",value:function(){this.complexLookupComponentObj.resetLookUp()}},{key:"refreshAcounts",value:function(e){this.complexLookupOptions.listOfOptions=Object.assign([],this.allAccounts),this.removeAccount(e)}}])}(d.a);return o.\u0275fac=function(e){return new(e||o)(a.Rb(g.a),a.Rb(b.a),a.Rb(m.a),a.Rb(c.a))},o.\u0275cmp=a.Lb({type:o,selectors:[["ps-lookup-own-accounts"]],viewQuery:function(e,t){var o;(1&e&&a.Wc(w,1),2&e)&&(a.Bc(o=a.gc())&&(t.complexLookupComponentObj=o.first))},inputs:{options:"options"},outputs:{onAccountChange:"onAccountChange",onAccountDeleted:"onAccountDeleted"},features:[a.Cb,a.Db],decls:3,vars:2,consts:[[1,"ps-complex-own-account"],[3,"id","options","changeItem","onDeleteItem"],["complexLookupComponentObj",""]],template:function(e,t){1&e&&(a.Xb(0,"ps-container-complex",0),a.Xb(1,"ps-complex-lookup",1,2),a.fc("changeItem",function(e){return t.onChangeItem(e)})("onDeleteItem",function(e){return t.onDeleteItem(e)}),a.Wb(),a.Wb()),2&e&&(a.Fb(1),a.pc("id",t.id)("options",t.complexLookupOptions))},directives:[v.a,P.a],styles:[""]}),o}()},ltde:function(e,t,o){"use strict";o.d(t,"a",function(){return b});var n=o("fXoL"),i=o("EZLY"),s=o("V0Fi"),a=o("fOh1"),c=o("ofXK"),p=o("BygU");function m(e,t){if(1&e){var o=n.Yb();n.Vb(0),n.Xb(1,"ps-container-lookup-option",2),n.fc("clickedCard",function(e){return n.Fc(o),n.ic(2).updateCard(e)}),n.Wb(),n.Ub()}if(2&e){var i=t.$implicit,s=n.ic(2);n.Fb(1),n.pc("id",s.id+"_opt")("options",s.getContainerLookUpOptions())("itemCard",i)}}function f(e,t){if(1&e&&(n.Vb(0),n.Pc(1,m,2,3,"ng-container",1),n.Ub()),2&e){var o=n.ic();n.Fb(1),n.pc("ngForOf",o.options.itemList)}}var b=function(){var e=function(e){function t(){var e;return l(this,t),(e=h(this,t)).reloadFct=new n.o,e.options={},e.onClickCard=new n.o,e.labelValuesMap=new Map,e.headerMap=new Map,e.requestMap=new Map,e.editRequestMap=new Map,e.bRefresh=!1,e.postFct={func:function(){var e=this;return new Promise(function(t,o){t(e.executionClass.reloadList())})},executionClass:d(e),params:[]},e}return y(t,e),u(t,[{key:"ngOnInit",value:function(){r(t,"init",this,3)([]),this.pupulateFavPayeeMap(),null==this.options.showOnlyList&&(this.options.showOnlyList=!1),this.options&&this.options.listOfOptions&&(this.options.listOfOptions.map(function(e,t){return e.rowIndex=t}),this.options.itemList=this.options.listOfOptions)}},{key:"getContainerLookUpOptions",value:function(){return this.prepareLookUp()}},{key:"prepareLookUp",value:function(){var e={};return e.labelKey=this.options.labelKey,e.fcName=this.options.fcName,e.labelsValueMap=this.labelValuesMap,e.headerMap=this.headerMap,e.formGroup=this.options.group,e.isEditable=this.options.isEditable,e.itemList=this.options.itemList,e.actionDetailsOptions=[{id:"pay",label:"pay_key",actionHyperlink:{group:this.options.group,iconOptions:{iconName:"paper-plane",labelOptions:{labelKey:"pay_key"}},pageOptions:{operId:s.a.WIDGET_BILL_PAYMENTS_OPER_ID},navigationOptions:{queryParams:{navigationIndex:1}}}},{id:"delete",labelOptions:{labelKey:"delete_key"},buttonIcon:"delete",actionUrl:a.a.serviceUrl.deleteBeneficiaryEndPoint,cssClass:"fab-edit-button",label:"delete_key",iconName:"trash",actionType:"delete",alertStyle:"warning",alertType:"prompt",alertMessage:"confirm_delete_this_favorite_key",operId:s.a.DELETE_FAV_PAYEE_OPER_ID},{id:"edit",label:"edit_key",actionHyperlink:{group:this.options.group,iconOptions:{iconName:"paper",labelOptions:{labelKey:"edit_key"}},pageOptions:{operId:s.a.EDIT_FAV_PAYEE_OPER_ID}}}],e.statementOptions={},e.reloadFunction={func:function(){var e=this;return new Promise(function(t,o){t(e.executionClass.reloadList())})},executionClass:this,params:[]},e}},{key:"reloadList",value:function(){this.reloadFct.emit()}},{key:"pupulateFavPayeeMap",value:function(){var e,t,o,n;e={key:"billerDescriptionConcat",value:"",isEdit:!1},t={key:"categoryDescriptionConcat",value:"",isEdit:!1},o={key:"billerAccount",value:"",isEdit:!1},n={key:"title",value:"nickName",isEdit:!1},this.labelValuesMap.set("biller_key",e),this.labelValuesMap.set("category_key",t),this.labelValuesMap.set("reference_key",o),this.headerMap.set("title",n)}},{key:"updateCard",value:function(e){e&&this.options.listOfOptions&&(this.options.itemList=this.options.listOfOptions.filter(function(t){return t===e}),this.options.item=this.options.itemList[0],this.options.showItemPopUp=!this.options.showItemPopUp),this.onClickCard.emit(this.options)}}])}(i.a);return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Lb({type:e,selectors:[["ps-fav-payee-list"]],inputs:{options:"options"},outputs:{reloadFct:"reloadFct",onClickCard:"onClickCard"},features:[n.Cb],decls:2,vars:1,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"id","options","itemCard","clickedCard"]],template:function(e,t){1&e&&(n.Xb(0,"ps-template-list"),n.Pc(1,f,2,1,"ng-container",0),n.Wb()),2&e&&(n.Fb(1),n.pc("ngIf",(null==t.options||null==t.options.itemList?null:t.options.itemList.length)>0))},directives:[i.a,c.o,c.n,p.a],styles:[""]}),e}()}}])}();